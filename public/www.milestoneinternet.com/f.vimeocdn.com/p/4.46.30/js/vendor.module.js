/* VimeoPlayer - v4.46.30 - 2026-02-17 - https://player.vimeo.com/NOTICE.txt */
var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var r,n,i=function(e){return e&&e.Math===Math&&e},s=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof e&&e)||i("object"==typeof e&&e)||function(){return this}()||Function("return this")(),a=s,o=function(e){try{return!!e()}catch(e){return!0}},c=!o(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),u=Function.prototype,l=u.call,h=c&&u.bind.bind(l,l),d=c?h:function(e){return function(){return l.apply(e,arguments)}},f=function(e){return null==e},p=TypeError,_=function(e){if(f(e))throw new p("Can't call method on "+e);return e},v=Object,m=function(e){return v(_(e))},g=d({}.hasOwnProperty),y=Object.hasOwn||function(e,t){return g(m(e),t)},E=!1,T=Object.defineProperty,b=function(e,t){try{T(s,e,{value:t,configurable:!0,writable:!0})}catch(r){s[e]=t}return t},S=t(function(e){var t="__core-js_shared__",r=e.exports=s[t]||b(t,{});(r.versions||(r.versions=[])).push({version:"3.47.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),A=function(e,t){return S[e]||(S[e]=t||{})},w=0,I=Math.random(),R=d(1.1.toString),P=function(e){return"Symbol("+(void 0===e?"":e)+")_"+R(++w+I,36)},k=s.navigator,D=k&&k.userAgent,O=D?String(D):"",L=s.process,C=s.Deno,M=L&&L.versions||C&&C.version,N=M&&M.v8;N&&(n=(r=N.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!n&&O&&(!(r=O.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=O.match(/Chrome\/(\d+)/))&&(n=+r[1]);var x=n,U=s.String,F=!!Object.getOwnPropertySymbols&&!o(function(){var e=Symbol("symbol detection");return!U(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&x&&x<41}),V=F&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,j=s.Symbol,B=A("wks"),H=V?j.for||j:j&&j.withoutSetter||P,X=function(e){return y(B,e)||(B[e]=F&&y(j,e)?j[e]:H("Symbol."+e)),B[e]},W=X,q=!o(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),G="object"==typeof document&&document.all,K=void 0===G&&void 0!==G?function(e){return"function"==typeof e||e===G}:function(e){return"function"==typeof e},Y=function(e){return"object"==typeof e?null!==e:K(e)},z=s.document,$=Y(z)&&Y(z.createElement),J=function(e){return $?z.createElement(e):{}},Q=!q&&!o(function(){return 7!==Object.defineProperty(J("div"),"a",{get:function(){return 7}}).a}),Z=q&&o(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),ee=String,te=TypeError,re=function(e){if(Y(e))return e;throw new te(ee(e)+" is not an object")},ne=Function.prototype.call,ie=c?ne.bind(ne):function(){return ne.apply(ne,arguments)},se=function(e,t){return arguments.length<2?function(e){return K(e)?e:void 0}(s[e]):s[e]&&s[e][t]},ae=d({}.isPrototypeOf),oe=Object,ce=V?function(e){return"symbol"==typeof e}:function(e){var t=se("Symbol");return K(t)&&ae(t.prototype,oe(e))},ue=String,le=function(e){try{return ue(e)}catch(e){return"Object"}},he=TypeError,de=function(e){if(K(e))return e;throw new he(le(e)+" is not a function")},fe=function(e,t){var r=e[t];return f(r)?void 0:de(r)},pe=TypeError,_e=TypeError,ve=X("toPrimitive"),me=function(e,t){if(!Y(e)||ce(e))return e;var r,n=fe(e,ve);if(n){if(void 0===t&&(t="default"),r=ie(n,e,t),!Y(r)||ce(r))return r;throw new _e("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var r,n;if("string"===t&&K(r=e.toString)&&!Y(n=ie(r,e)))return n;if(K(r=e.valueOf)&&!Y(n=ie(r,e)))return n;if("string"!==t&&K(r=e.toString)&&!Y(n=ie(r,e)))return n;throw new pe("Can't convert object to primitive value")}(e,t)},ge=function(e){var t=me(e,"string");return ce(t)?t:t+""},ye=TypeError,Ee=Object.defineProperty,Te=Object.getOwnPropertyDescriptor,be="enumerable",Se="configurable",Ae="writable",we=q?Z?function(e,t,r){if(re(e),t=ge(t),re(r),"function"==typeof e&&"prototype"===t&&"value"in r&&Ae in r&&!r[Ae]){var n=Te(e,t);n&&n[Ae]&&(e[t]=r.value,r={configurable:Se in r?r[Se]:n[Se],enumerable:be in r?r[be]:n[be],writable:!1})}return Ee(e,t,r)}:Ee:function(e,t,r){if(re(e),t=ge(t),re(r),Q)try{return Ee(e,t,r)}catch(e){}if("get"in r||"set"in r)throw new ye("Accessors not supported");return"value"in r&&(e[t]=r.value),e},Ie={f:we},Re=Ie.f,Pe=function(e){var t=a.Symbol||(a.Symbol={});y(t,e)||Re(t,e,{value:W(e)})},ke={}.propertyIsEnumerable,De=Object.getOwnPropertyDescriptor,Oe=De&&!ke.call({1:2},1)?function(e){var t=De(this,e);return!!t&&t.enumerable}:ke,Le={f:Oe},Ce=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Me=d({}.toString),Ne=d("".slice),xe=function(e){return Ne(Me(e),8,-1)},Ue=Object,Fe=d("".split),Ve=o(function(){return!Ue("z").propertyIsEnumerable(0)})?function(e){return"String"===xe(e)?Fe(e,""):Ue(e)}:Ue,je=function(e){return Ve(_(e))},Be=Object.getOwnPropertyDescriptor,He=q?Be:function(e,t){if(e=je(e),t=ge(t),Q)try{return Be(e,t)}catch(e){}if(y(e,t))return Ce(!ie(Le.f,e,t),e[t])},Xe={f:He},We=Ie.f,qe=Xe.f,Ge=s.Symbol;if(Pe("asyncDispose"),Ge){var Ke=qe(Ge,"asyncDispose");Ke.enumerable&&Ke.configurable&&Ke.writable&&We(Ge,"asyncDispose",{value:Ke.value,enumerable:!1,configurable:!1,writable:!1})}var Ye=Ie.f,ze=Xe.f,$e=s.Symbol;if(Pe("dispose"),$e){var Je=ze($e,"dispose");Je.enumerable&&Je.configurable&&Je.writable&&Ye($e,"dispose",{value:Je.value,enumerable:!1,configurable:!1,writable:!1})}var Qe=q?function(e,t,r){return Ie.f(e,t,Ce(1,r))}:function(e,t,r){return e[t]=r,e},Ze=Function.prototype,et=q&&Object.getOwnPropertyDescriptor,tt=y(Ze,"name"),rt={EXISTS:tt,PROPER:tt&&"something"===function(){}.name,CONFIGURABLE:tt&&(!q||q&&et(Ze,"name").configurable)},nt=d(Function.toString);K(S.inspectSource)||(S.inspectSource=function(e){return nt(e)});var it,st,at,ot=S.inspectSource,ct=s.WeakMap,ut=K(ct)&&/native code/.test(String(ct)),lt=A("keys"),ht=function(e){return lt[e]||(lt[e]=P(e))},dt={},ft="Object already initialized",pt=s.TypeError,_t=s.WeakMap;if(ut||S.state){var vt=S.state||(S.state=new _t);vt.get=vt.get,vt.has=vt.has,vt.set=vt.set,it=function(e,t){if(vt.has(e))throw new pt(ft);return t.facade=e,vt.set(e,t),t},st=function(e){return vt.get(e)||{}},at=function(e){return vt.has(e)}}else{var mt=ht("state");dt[mt]=!0,it=function(e,t){if(y(e,mt))throw new pt(ft);return t.facade=e,Qe(e,mt,t),t},st=function(e){return y(e,mt)?e[mt]:{}},at=function(e){return y(e,mt)}}var gt={set:it,get:st,has:at,enforce:function(e){return at(e)?st(e):it(e,{})},getterFor:function(e){return function(t){var r;if(!Y(t)||(r=st(t)).type!==e)throw new pt("Incompatible receiver, "+e+" required");return r}}},yt=t(function(e){var t=rt.CONFIGURABLE,r=gt.enforce,n=gt.get,i=String,s=Object.defineProperty,a=d("".slice),c=d("".replace),u=d([].join),l=q&&!o(function(){return 8!==s(function(){},"length",{value:8}).length}),h=String(String).split("String"),f=e.exports=function(e,n,o){"Symbol("===a(i(n),0,7)&&(n="["+c(i(n),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),o&&o.getter&&(n="get "+n),o&&o.setter&&(n="set "+n),(!y(e,"name")||t&&e.name!==n)&&(q?s(e,"name",{value:n,configurable:!0}):e.name=n),l&&o&&y(o,"arity")&&e.length!==o.arity&&s(e,"length",{value:o.arity});try{o&&y(o,"constructor")&&o.constructor?q&&s(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var d=r(e);return y(d,"source")||(d.source=u(h,"string"==typeof n?n:"")),e};Function.prototype.toString=f(function(){return K(this)&&n(this).source||ot(this)},"toString")}),Et=function(e,t,r,n){n||(n={});var i=n.enumerable,s=void 0!==n.name?n.name:t;if(K(r)&&yt(r,s,n),n.global)i?e[t]=r:b(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=r:Ie.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Tt=Math.ceil,bt=Math.floor,St=Math.trunc||function(e){var t=+e;return(t>0?bt:Tt)(t)},At=function(e){var t=+e;return t!=t||0===t?0:St(t)},wt=Math.max,It=Math.min,Rt=function(e,t){var r=At(e);return r<0?wt(r+t,0):It(r,t)},Pt=Math.min,kt=function(e){var t=At(e);return t>0?Pt(t,9007199254740991):0},Dt=function(e){return kt(e.length)},Ot=function(e){return function(t,r,n){var i=je(t),s=Dt(i);if(0===s)return!e&&-1;var a,o=Rt(n,s);if(e&&r!=r){for(;s>o;)if((a=i[o++])!=a)return!0}else for(;s>o;o++)if((e||o in i)&&i[o]===r)return e||o||0;return!e&&-1}},Lt={includes:Ot(!0),indexOf:Ot(!1)},Ct=Lt.indexOf,Mt=d([].push),Nt=function(e,t){var r,n=je(e),i=0,s=[];for(r in n)!y(dt,r)&&y(n,r)&&Mt(s,r);for(;t.length>i;)y(n,r=t[i++])&&(~Ct(s,r)||Mt(s,r));return s},xt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ut=xt.concat("length","prototype"),Ft=Object.getOwnPropertyNames||function(e){return Nt(e,Ut)},Vt={f:Ft},jt={f:Object.getOwnPropertySymbols},Bt=d([].concat),Ht=se("Reflect","ownKeys")||function(e){var t=Vt.f(re(e)),r=jt.f;return r?Bt(t,r(e)):t},Xt=function(e,t,r){for(var n=Ht(t),i=Ie.f,s=Xe.f,a=0;a<n.length;a++){var o=n[a];y(e,o)||r&&y(r,o)||i(e,o,s(t,o))}},Wt=/#|\.prototype\./,qt=function(e,t){var r=Kt[Gt(e)];return r===zt||r!==Yt&&(K(t)?o(t):!!t)},Gt=qt.normalize=function(e){return String(e).replace(Wt,".").toLowerCase()},Kt=qt.data={},Yt=qt.NATIVE="N",zt=qt.POLYFILL="P",$t=qt,Jt=Xe.f,Qt=function(e,t){var r,n,i,a,o,c=e.target,u=e.global,l=e.stat;if(r=u?s:l?s[c]||b(c,{}):s[c]&&s[c].prototype)for(n in t){if(a=t[n],i=e.dontCallGetSet?(o=Jt(r,n))&&o.value:r[n],!$t(u?n:c+(l?".":"#")+n,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;Xt(a,i)}(e.sham||i&&i.sham)&&Qe(a,"sham",!0),Et(r,n,a,e)}},Zt={};Zt[X("toStringTag")]="z";var er="[object z]"===String(Zt),tr=X("toStringTag"),rr=Object,nr="Arguments"===xe(function(){return arguments}()),ir=er?xe:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=rr(e),tr))?r:nr?xe(t):"Object"===(n=xe(t))&&K(t.callee)?"Arguments":n},sr="Error",ar="DOMException",or=Object.setPrototypeOf||{}.__proto__,cr=se(ar),ur=Error,lr=ur.isError,hr=!lr||!or||o(function(){return cr&&!lr(new cr(ar))||!lr(new ur(sr,{cause:function(){}}))||lr(se("Object","create")(ur.prototype))});Qt({target:"Error",stat:!0,sham:!0,forced:hr},{isError:function(e){if(!Y(e))return!1;var t=ir(e);return t===sr||t===ar}});var dr,fr=!o(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),pr=ht("IE_PROTO"),_r=Object,vr=_r.prototype,mr=fr?_r.getPrototypeOf:function(e){var t=m(e);if(y(t,pr))return t[pr];var r=t.constructor;return K(r)&&t instanceof r?r.prototype:t instanceof _r?vr:null},gr=function(e,t,r){try{return d(de(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(e){}},yr=String,Er=TypeError,Tr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=gr(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return _(r),function(e){if(function(e){return Y(e)||null===e}(e))return e;throw new Er("Can't set "+yr(e)+" as a prototype")}(n),Y(r)?(t?e(r,n):r.__proto__=n,r):r}}():void 0),br=Object.keys||function(e){return Nt(e,xt)},Sr=q&&!Z?Object.defineProperties:function(e,t){re(e);for(var r,n=je(t),i=br(t),s=i.length,a=0;s>a;)Ie.f(e,r=i[a++],n[r]);return e},Ar={f:Sr},wr=se("document","documentElement"),Ir="prototype",Rr="script",Pr=ht("IE_PROTO"),kr=function(){},Dr=function(e){return"<"+Rr+">"+e+"</"+Rr+">"},Or=function(e){e.write(Dr("")),e.close();var t=e.parentWindow.Object;return e=null,t},Lr=function(){try{dr=new ActiveXObject("htmlfile")}catch(e){}Lr="undefined"!=typeof document?document.domain&&dr?Or(dr):function(){var e,t=J("iframe"),r="java"+Rr+":";return t.style.display="none",wr.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(Dr("document.F=Object")),e.close(),e.F}():Or(dr);for(var e=xt.length;e--;)delete Lr[Ir][xt[e]];return Lr()};dt[Pr]=!0;var Cr=Object.create||function(e,t){var r;return null!==e?(kr[Ir]=re(e),r=new kr,kr[Ir]=null,r[Pr]=e):r=Lr(),void 0===t?r:Ar.f(r,t)},Mr=Error,Nr=d("".replace),xr=String(new Mr("zxcasd").stack),Ur=/\n\s*at [^:]*:[^\n]*/,Fr=Ur.test(xr),Vr=function(e,t){if(Fr&&"string"==typeof e&&!Mr.prepareStackTrace)for(;t--;)e=Nr(e,Ur,"");return e},jr=!o(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Ce(1,7)),7!==e.stack)}),Br=Error.captureStackTrace,Hr=String,Xr=function(e){if("Symbol"===ir(e))throw new TypeError("Cannot convert a Symbol value to a string");return Hr(e)},Wr=function(e,t){return void 0===e?arguments.length<2?"":t:Xr(e)},qr=s.SuppressedError,Gr=X("toStringTag"),Kr=Error,Yr=!!qr&&3!==qr.length,zr=!!qr&&o(function(){return 4===new qr(1,2,3,{cause:4}).cause}),$r=Yr||zr,Jr=function(e,t,r){var n,i=ae(Qr,this);return Tr?n=!$r||i&&mr(this)!==Qr?Tr(new Kr,i?mr(this):Qr):new qr:(n=i?this:Cr(Qr),Qe(n,Gr,"Error")),void 0!==r&&Qe(n,"message",Wr(r)),function(e,t,r){jr&&(Br?Br(e,t):Qe(e,"stack",Vr(r,1)))}(n,Jr,n.stack),Qe(n,"error",e),Qe(n,"suppressed",t),n};Tr?Tr(Jr,Kr):Xt(Jr,Kr,{name:!0});var Qr=Jr.prototype=$r?qr.prototype:Cr(Kr.prototype,{constructor:Ce(1,Jr),message:Ce(1,""),name:Ce(1,"SuppressedError")});$r&&(Qr.constructor=Jr),Qt({global:!0,constructor:!0,arity:3,forced:$r},{SuppressedError:Jr});var Zr=function(e){if("Function"===xe(e))return d(e)},en=Zr(Zr.bind),tn=function(e,t){return de(e),void 0===t?e:c?en(e,t):function(){return e.apply(t,arguments)}},rn=function(e){var t=1===e;return function(r,n,i){for(var s,a=m(r),o=Ve(a),c=Dt(o),u=tn(n,i);c-- >0;)if(u(s=o[c],c,a))switch(e){case 0:return s;case 1:return c}return t?-1:void 0}},nn={findLast:rn(0),findLastIndex:rn(1)},sn=Ie.f,an=X("unscopables"),on=Array.prototype;void 0===on[an]&&sn(on,an,{configurable:!0,value:Cr(null)});var cn=function(e){on[an][e]=!0},un=nn.findLast;Qt({target:"Array",proto:!0},{findLast:function(e){return un(this,e,arguments.length>1?arguments[1]:void 0)}}),cn("findLast");var ln=nn.findLastIndex;Qt({target:"Array",proto:!0},{findLastIndex:function(e){return ln(this,e,arguments.length>1?arguments[1]:void 0)}}),cn("findLastIndex");var hn=Lt.includes,dn=o(function(){return!Array(1).includes()});Qt({target:"Array",proto:!0,forced:dn},{includes:function(e){return hn(this,e,arguments.length>1?arguments[1]:void 0)}}),cn("includes");var fn=Array.isArray||function(e){return"Array"===xe(e)},pn=TypeError,_n=Object.getOwnPropertyDescriptor,vn=q&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}()?function(e,t){if(fn(e)&&!_n(e,"length").writable)throw new pn("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},mn=TypeError,gn=function(e){if(e>9007199254740991)throw mn("Maximum allowed index exceeded");return e},yn=o(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}();Qt({target:"Array",proto:!0,arity:1,forced:yn},{push:function(e){var t=m(this),r=Dt(t),n=arguments.length;gn(r+n);for(var i=0;i<n;i++)t[r]=arguments[i],r++;return vn(t,r),r}});var En=function(e,t){for(var r=Dt(e),n=new t(r),i=0;i<r;i++)n[i]=e[r-i-1];return n},Tn=Array;Qt({target:"Array",proto:!0},{toReversed:function(){return En(je(this),Tn)}}),cn("toReversed");var bn=function(e,t,r){for(var n=0,i=arguments.length>2?r:Dt(t),s=new e(i);i>n;)s[n]=t[n++];return s},Sn=function(e,t){var r=s[e],n=r&&r.prototype;return n&&n[t]},An=Array,wn=d(Sn("Array","sort"));Qt({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&de(e);var t=je(this),r=bn(An,t);return wn(r,e)}}),cn("toSorted");var In=Array,Rn=Math.max,Pn=Math.min;Qt({target:"Array",proto:!0},{toSpliced:function(e,t){var r,n,i,s,a=je(this),o=Dt(a),c=Rt(e,o),u=arguments.length,l=0;for(0===u?r=n=0:1===u?(r=0,n=o-c):(r=u-2,n=Pn(Rn(At(t),0),o-c)),i=gn(o+r-n),s=In(i);l<c;l++)s[l]=a[l];for(;l<c+r;l++)s[l]=arguments[l-c+2];for(;l<i;l++)s[l]=a[l+n-r];return s}}),cn("toSpliced");var kn=TypeError,Dn=function(e,t){if(!delete e[t])throw new kn("Cannot delete property "+le(t)+" of "+le(e))},On=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}();Qt({target:"Array",proto:!0,arity:1,forced:On},{unshift:function(e){var t=m(this),r=Dt(t),n=arguments.length;if(n){gn(r+n);for(var i=r;i--;){var s=i+n;i in t?t[s]=t[i]:Dn(t,s)}for(var a=0;a<n;a++)t[a]=arguments[a]}return vn(t,r+n)}});var Ln=RangeError,Cn=function(e,t,r,n){var i=Dt(e),s=At(r),a=s<0?i+s:s;if(a>=i||a<0)throw new Ln("Incorrect index");for(var o=new t(i),c=0;c<i;c++)o[c]=c===a?n:e[c];return o},Mn=Array,Nn=function(){try{[].with({valueOf:function(){throw 4}},null)}catch(e){return 4!==e}}();Qt({target:"Array",proto:!0,forced:Nn},{with:function(e,t){return Cn(je(this),Mn,e,t)}});var xn=Math.pow,Un=xn(2,-24),Fn=.0009765625,Vn=d(DataView.prototype.getUint16);Qt({target:"DataView",proto:!0},{getFloat16:function(e){return function(e){var t=e>>>15,r=e>>>10&31,n=1023&e;return 31===r?0===n?0===t?1/0:-1/0:NaN:0===r?n*(0===t?Un:-Un):xn(2,r-15)*(0===t?1+n*Fn:-1-n*Fn)}(Vn(this,e,arguments.length>1&&arguments[1]))}});var jn=TypeError,Bn=function(e){if("DataView"===ir(e))return e;throw new jn("Argument is not a DataView")},Hn=RangeError,Xn=function(e){if(void 0===e)return 0;var t=At(e),r=kt(t);if(t!==r)throw new Hn("Wrong length or index");return r},Wn=Math.log,qn=Math.LN2,Gn=Math.log2||function(e){return Wn(e)/qn},Kn=4503599627370496,Yn=function(e){return e+Kn-Kn},zn=Math.pow,$n=1024,Jn=d(DataView.prototype.setUint16);Qt({target:"DataView",proto:!0},{setFloat16:function(e,t){Jn(Bn(this),Xn(e),function(e){if(e!=e)return 32256;if(0===e)return(1/e==-1/0)<<15;var t=e<0;if(t&&(e=-e),e>=65520)return t<<15|31744;if(e<61005353927612305e-21)return t<<15|Yn(16777216*e);var r=0|Gn(e);if(-15===r)return t<<15|$n;var n=Yn((e*zn(2,-r)-1)*$n);return n===$n?t<<15|r+16<<10:t<<15|r+15<<10|n}(+t),arguments.length>2&&arguments[2])}});var Qn=function(e,t,r){return r.get&&yt(r.get,t,{getter:!0}),r.set&&yt(r.set,t,{setter:!0}),Ie.f(e,t,r)},Zn="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,ei=s.ArrayBuffer,ti=s.TypeError,ri=ei&&gr(ei.prototype,"byteLength","get")||function(e){if("ArrayBuffer"!==xe(e))throw new ti("ArrayBuffer expected");return e.byteLength},ni=s.DataView,ii=function(e){if(!Zn||0!==ri(e))return!1;try{return new ni(e),!1}catch(e){return!0}},si=ArrayBuffer.prototype;q&&!("detached"in si)&&Qn(si,"detached",{configurable:!0,get:function(){return ii(this)}});var ai,oi,ci,ui,li=TypeError,hi=function(e){if(ii(e))throw new li("ArrayBuffer is detached");return e},di=function(e){return O.slice(0,e.length)===e},fi=di("Bun/")?"BUN":di("Cloudflare-Workers")?"CLOUDFLARE":di("Deno/")?"DENO":di("Node.js/")?"NODE":s.Bun&&"string"==typeof Bun.version?"BUN":s.Deno&&"object"==typeof Deno.version?"DENO":"process"===xe(s.process)?"NODE":s.window&&s.document?"BROWSER":"REST",pi="NODE"===fi,_i=s.structuredClone,vi=!!_i&&!o(function(){if("DENO"===fi&&x>92||"NODE"===fi&&x>94||"BROWSER"===fi&&x>97)return!1;var e=new ArrayBuffer(8),t=_i(e,{transfer:[e]});return 0!==e.byteLength||8!==t.byteLength}),mi=s.structuredClone,gi=s.ArrayBuffer,yi=s.MessageChannel,Ei=!1;if(vi)Ei=function(e){mi(e,{transfer:[e]})};else if(gi)try{yi||(ai=function(e){if(pi){try{return s.process.getBuiltinModule(e)}catch(e){}try{return Function('return require("'+e+'")')()}catch(e){}}}("worker_threads"))&&(yi=ai.MessageChannel),yi&&(oi=new yi,ci=new gi(2),ui=function(e){oi.port1.postMessage(null,[e])},2===ci.byteLength&&(ui(ci),0===ci.byteLength&&(Ei=ui)))}catch(e){}var Ti=Ei,bi=s.structuredClone,Si=s.ArrayBuffer,Ai=s.DataView,wi=Math.min,Ii=Si.prototype,Ri=Ai.prototype,Pi=d(Ii.slice),ki=gr(Ii,"resizable","get"),Di=gr(Ii,"maxByteLength","get"),Oi=d(Ri.getInt8),Li=d(Ri.setInt8),Ci=(vi||Ti)&&function(e,t,r){var n,i=ri(e),s=void 0===t?i:Xn(t),a=!ki||!ki(e);if(hi(e),vi&&(e=bi(e,{transfer:[e]}),i===s&&(r||a)))return e;if(i>=s&&(!r||a))n=Pi(e,0,s);else{var o=r&&!a&&Di?{maxByteLength:Di(e)}:void 0;n=new Si(s,o);for(var c=new Ai(e),u=new Ai(n),l=wi(s,i),h=0;h<l;h++)Li(u,h,Oi(c,h))}return vi||Ti(e),n};Ci&&Qt({target:"ArrayBuffer",proto:!0},{transfer:function(){return Ci(this,arguments.length?arguments[0]:void 0,!0)}}),Ci&&Qt({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return Ci(this,arguments.length?arguments[0]:void 0,!1)}});var Mi=TypeError,Ni=function(e,t){if(ae(t,e))return e;throw new Mi("Incorrect invocation")},xi=function(e,t,r){for(var n in t)Et(e,n,t[n],r);return e},Ui=X("asyncDispose"),Fi=X("dispose"),Vi=d([].push),ji=function(e,t,r){return arguments.length<3&&!f(e)&&(r=de(function(e,t){if("async-dispose"===t){var r=fe(e,Ui);return void 0!==r||void 0===(r=fe(e,Fi))?r:function(){var e=this;return new(se("Promise"))(function(t){ie(r,e),t(void 0)})}}return fe(e,Fi)}(re(e),t))),void 0===r?function(){}:tn(r,e)},Bi=function(e,t,r,n){var i;if(arguments.length<4){if(f(t)&&"sync-dispose"===r)return;i=ji(t,r)}else i=ji(void 0,r,n);Vi(e.stack,i)},Hi=se("SuppressedError"),Xi=ReferenceError,Wi=X("dispose"),qi=X("toStringTag"),Gi="DisposableStack",Ki=gt.set,Yi=gt.getterFor(Gi),zi="sync-dispose",$i="disposed",Ji=function(e){var t=Yi(e);if(t.state===$i)throw new Xi(Gi+" already disposed");return t},Qi=function(){Ki(Ni(this,Zi),{type:Gi,state:"pending",stack:[]}),q||(this.disposed=!1)},Zi=Qi.prototype;xi(Zi,{dispose:function(){var e=Yi(this);if(e.state!==$i){e.state=$i,q||(this.disposed=!0);for(var t,r=e.stack,n=r.length,i=!1;n;){var s=r[--n];r[n]=null;try{s()}catch(e){i?t=new Hi(e,t):(i=!0,t=e)}}if(e.stack=null,i)throw t}},use:function(e){return Bi(Ji(this),e,zi),e},adopt:function(e,t){var r=Ji(this);return de(t),Bi(r,void 0,zi,function(){t(e)}),e},defer:function(e){var t=Ji(this);de(e),Bi(t,void 0,zi,e)},move:function(){var e=Ji(this),t=new Qi;return Yi(t).stack=e.stack,e.stack=[],e.state=$i,q||(this.disposed=!0),t}}),q&&Qn(Zi,"disposed",{configurable:!0,get:function(){return Yi(this).state===$i}}),Et(Zi,Wi,Zi.dispose,{name:"dispose"}),Et(Zi,qi,Gi,{nonWritable:!0}),Qt({global:!0,constructor:!0},{DisposableStack:Qi});var es,ts,rs,ns=function(e,t,r){q?Ie.f(e,t,Ce(0,r)):e[t]=r},is=X("iterator"),ss=!1;[].keys&&("next"in(rs=[].keys())?(ts=mr(mr(rs)))!==Object.prototype&&(es=ts):ss=!0);var as=!Y(es)||o(function(){var e={};return es[is].call(e)!==e});as&&(es={}),K(es[is])||Et(es,is,function(){return this});var os={IteratorPrototype:es,BUGGY_SAFARI_ITERATORS:ss},cs=os.IteratorPrototype,us="constructor",ls="Iterator",hs=X("toStringTag"),ds=TypeError,fs=s[ls],ps=!K(fs)||fs.prototype!==cs||!o(function(){fs({})}),_s=function(){if(Ni(this,cs),mr(this)===cs)throw new ds("Abstract class Iterator not directly constructable")},vs=function(e,t){q?Qn(cs,e,{configurable:!0,get:function(){return t},set:function(t){if(re(this),this===cs)throw new ds("You can't redefine this property");y(this,e)?this[e]=t:ns(this,e,t)}}):cs[e]=t};y(cs,hs)||vs(hs,ls),!ps&&y(cs,us)&&cs[us]!==Object||vs(us,_s),_s.prototype=cs,Qt({global:!0,constructor:!0,forced:ps},{Iterator:_s});var ms={},gs=X("iterator"),ys=function(e){if(!f(e))return fe(e,gs)||fe(e,"@@iterator")||ms[ir(e)]},Es=function(e,t){return{value:e,done:t}},Ts=function(e,t,r){var n,i;re(e);try{if(!(n=fe(e,"return"))){if("throw"===t)throw r;return r}n=ie(n,e)}catch(e){i=!0,n=e}if("throw"===t)throw r;if(i)throw n;return re(n),r},bs=function(e,t,r){for(var n=e.length-1;n>=0;n--)if(void 0!==e[n])try{r=Ts(e[n].iterator,t,r)}catch(e){t="throw",r=e}if("throw"===t)throw r;return r},Ss=os.IteratorPrototype,As=X("toStringTag"),ws="IteratorHelper",Is="WrapForValidIterator",Rs="normal",Ps="throw",ks=gt.set,Ds=function(e){var t=gt.getterFor(e?Is:ws);return xi(Cr(Ss),{next:function(){var r=t(this);if(e)return r.nextHandler();if(r.done)return Es(void 0,!0);try{var n=r.nextHandler();return r.returnHandlerResult?n:Es(n,r.done)}catch(e){throw r.done=!0,e}},return:function(){var r=t(this),n=r.iterator;if(r.done=!0,e){var i=fe(n,"return");return i?ie(i,n):Es(void 0,!0)}if(r.inner)try{Ts(r.inner.iterator,Rs)}catch(e){return Ts(n,Ps,e)}if(r.openIters)try{bs(r.openIters,Rs)}catch(e){return Ts(n,Ps,e)}return n&&Ts(n,Rs),Es(void 0,!0)}})},Os=Ds(!0),Ls=Ds(!1);Qe(Ls,As,"Iterator Helper");var Cs=function(e,t,r){var n=function(n,i){i?(i.iterator=n.iterator,i.next=n.next):i=n,i.type=t?Is:ws,i.returnHandlerResult=!!r,i.nextHandler=e,i.counter=0,i.done=!1,ks(this,i)};return n.prototype=t?Os:Ls,n},Ms=Array,Ns=Cs(function(){for(;;){var e=this.iterator;if(!e){var t=this.nextIterableIndex++,r=this.iterables;if(t>=r.length)return void(this.done=!0);var n=r[t];this.iterables[t]=null,e=this.iterator=ie(n.method,n.iterable),this.next=e.next}var i=re(ie(this.next,e));if(!i.done)return i.value;this.iterator=null,this.next=null}});Qt({target:"Iterator",stat:!0},{concat:function(){for(var e=arguments.length,t=Ms(e),r=0;r<e;r++){var n=re(arguments[r]);t[r]={iterable:n,method:de(ys(n))}}return new Ns({iterables:t,nextIterableIndex:0,iterator:null,next:null})}});var xs=os.IteratorPrototype,Us=X("dispose");y(xs,Us)||Et(xs,Us,function(){var e=fe(this,"return");e&&ie(e,this)});var Fs=function(e){return{iterator:e,next:e.next,done:!1}},Vs=RangeError,js=function(e){if(e==e)return e;throw new Vs("NaN is not allowed")},Bs=RangeError,Hs=function(e){var t=At(e);if(t<0)throw new Bs("The argument can't be less than 0");return t},Xs=function(e,t){var r="function"==typeof Iterator&&Iterator.prototype[e];if(r)try{r.call({next:null},t).next()}catch(e){return!0}},Ws=function(e,t){var r=s.Iterator,n=r&&r.prototype,i=n&&n[e],a=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){a=!0}},-1)}catch(e){e instanceof t||(a=!1)}if(!a)return i},qs=!Xs("drop",0),Gs=!qs&&Ws("drop",RangeError),Ks=qs||Gs,Ys=Cs(function(){for(var e,t=this.iterator,r=this.next;this.remaining;)if(this.remaining--,e=re(ie(r,t)),this.done=!!e.done)return;if(e=re(ie(r,t)),!(this.done=!!e.done))return e.value});Qt({target:"Iterator",proto:!0,real:!0,forced:Ks},{drop:function(e){var t;re(this);try{t=Hs(js(+e))}catch(e){Ts(this,"throw",e)}return Gs?ie(Gs,this,t):new Ys(Fs(this),{remaining:t})}});var zs=X("iterator"),$s=Array.prototype,Js=TypeError,Qs=function(e,t){var r=arguments.length<2?ys(e):t;if(de(r))return re(ie(r,e));throw new Js(le(e)+" is not iterable")},Zs=TypeError,ea=function(e,t){this.stopped=e,this.result=t},ta=ea.prototype,ra=function(e,t,r){var n,i,s,a,o,c,u,l=r&&r.that,h=!(!r||!r.AS_ENTRIES),d=!(!r||!r.IS_RECORD),f=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),_=tn(t,l),v=function(e){return n&&Ts(n,"normal"),new ea(!0,e)},m=function(e){return h?(re(e),p?_(e[0],e[1],v):_(e[0],e[1])):p?_(e,v):_(e)};if(d)n=e.iterator;else if(f)n=e;else{if(!(i=ys(e)))throw new Zs(le(e)+" is not iterable");if(function(e){return void 0!==e&&(ms.Array===e||$s[zs]===e)}(i)){for(s=0,a=Dt(e);a>s;s++)if((o=m(e[s]))&&ae(ta,o))return o;return new ea(!1)}n=Qs(e,i)}for(c=d?e.next:n.next;!(u=ie(c,n)).done;){try{o=m(u.value)}catch(e){Ts(n,"throw",e)}if("object"==typeof o&&o&&ae(ta,o))return o}return new ea(!1)},na=Ws("every",TypeError);Qt({target:"Iterator",proto:!0,real:!0,forced:na},{every:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}if(na)return ie(na,this,e);var t=Fs(this),r=0;return!ra(t,function(t,n){if(!e(t,r++))return n()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});var ia=function(e,t,r,n){try{return n?t(re(r)[0],r[1]):t(r)}catch(t){Ts(e,"throw",t)}},sa=!Xs("filter",function(){}),aa=!sa&&Ws("filter",TypeError),oa=sa||aa,ca=Cs(function(){for(var e,t,r=this.iterator,n=this.predicate,i=this.next;;){if(e=re(ie(i,r)),this.done=!!e.done)return;if(t=e.value,ia(r,n,[t,this.counter++],!0))return t}});Qt({target:"Iterator",proto:!0,real:!0,forced:oa},{filter:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}return aa?ie(aa,this,e):new ca(Fs(this),{predicate:e})}});var ua=Ws("find",TypeError);Qt({target:"Iterator",proto:!0,real:!0,forced:ua},{find:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}if(ua)return ie(ua,this,e);var t=Fs(this),r=0;return ra(t,function(t,n){if(e(t,r++))return n(t)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});var la=function(e,t){t&&"string"==typeof e||re(e);var r=ys(e);return Fs(re(void 0!==r?ie(r,e):e))},ha=!Xs("flatMap",function(){}),da=!ha&&Ws("flatMap",TypeError),fa=ha||da,pa=Cs(function(){for(var e,t,r=this.iterator,n=this.mapper;;){if(t=this.inner)try{if(!(e=re(ie(t.next,t.iterator))).done)return e.value;this.inner=null}catch(e){Ts(r,"throw",e)}if(e=re(ie(this.next,r)),this.done=!!e.done)return;try{this.inner=la(n(e.value,this.counter++),!1)}catch(e){Ts(r,"throw",e)}}});Qt({target:"Iterator",proto:!0,real:!0,forced:fa},{flatMap:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}return da?ie(da,this,e):new pa(Fs(this),{mapper:e,inner:null})}});var _a=Ws("forEach",TypeError);Qt({target:"Iterator",proto:!0,real:!0,forced:_a},{forEach:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}if(_a)return ie(_a,this,e);var t=Fs(this),r=0;ra(t,function(t){e(t,r++)},{IS_RECORD:!0})}});var va=os.IteratorPrototype,ma=function(){try{Iterator.from({return:null}).return()}catch(e){return!0}}(),ga=Cs(function(){return ie(this.next,this.iterator)},!0);Qt({target:"Iterator",stat:!0,forced:ma},{from:function(e){var t=la("string"==typeof e?m(e):e,!0);return ae(va,t.iterator)?t.iterator:new ga(t)}});var ya=!Xs("map",function(){}),Ea=!ya&&Ws("map",TypeError),Ta=ya||Ea,ba=Cs(function(){var e=this.iterator,t=re(ie(this.next,e));if(!(this.done=!!t.done))return ia(e,this.mapper,[t.value,this.counter++],!0)});Qt({target:"Iterator",proto:!0,real:!0,forced:Ta},{map:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}return Ea?ie(Ea,this,e):new ba(Fs(this),{mapper:e})}});var Sa=Function.prototype,Aa=Sa.apply,wa=Sa.call,Ia="object"==typeof Reflect&&Reflect.apply||(c?wa.bind(Aa):function(){return wa.apply(Aa,arguments)}),Ra=TypeError,Pa=o(function(){[].keys().reduce(function(){},void 0)}),ka=!Pa&&Ws("reduce",Ra);Qt({target:"Iterator",proto:!0,real:!0,forced:Pa||ka},{reduce:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}var t=arguments.length<2,r=t?void 0:arguments[1];if(ka)return Ia(ka,this,t?[e]:[e,r]);var n=Fs(this),i=0;if(ra(n,function(n){t?(t=!1,r=n):r=e(r,n,i),i++},{IS_RECORD:!0}),t)throw new Ra("Reduce of empty iterator with no initial value");return r}});var Da=Ws("some",TypeError);Qt({target:"Iterator",proto:!0,real:!0,forced:Da},{some:function(e){re(this);try{de(e)}catch(e){Ts(this,"throw",e)}if(Da)return ie(Da,this,e);var t=Fs(this),r=0;return ra(t,function(t,n){if(e(t,r++))return n()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});var Oa=Ws("take",RangeError),La=Cs(function(){var e=this.iterator;if(!this.remaining--)return this.done=!0,Ts(e,"normal",void 0);var t=re(ie(this.next,e));return(this.done=!!t.done)?void 0:t.value});Qt({target:"Iterator",proto:!0,real:!0,forced:Oa},{take:function(e){var t;re(this);try{t=Hs(js(+e))}catch(e){Ts(this,"throw",e)}return Oa?ie(Oa,this,t):new La(Fs(this),{remaining:t})}});var Ca=[].push;Qt({target:"Iterator",proto:!0,real:!0},{toArray:function(){var e=[];return ra(Fs(re(this)),Ca,{that:e,IS_RECORD:!0}),e}});var Ma=!o(function(){var e="9007199254740993",t=JSON.rawJSON(e);return!JSON.isRawJSON(t)||JSON.stringify(t)!==e}),Na=gt.get,xa=function(e){if(!Y(e))return!1;var t=Na(e);return!!t&&"RawJSON"===t.type};Qt({target:"JSON",stat:!0,forced:!Ma},{isRawJSON:xa});var Ua=SyntaxError,Fa=parseInt,Va=String.fromCharCode,ja=d("".charAt),Ba=d("".slice),Ha=d(/./.exec),Xa={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t"},Wa=/^[\da-f]{4}$/i,qa=/^[\u0000-\u001F]$/,Ga=function(e,t){for(var r=!0,n="";t<e.length;){var i=ja(e,t);if("\\"===i){var s=Ba(e,t,t+2);if(y(Xa,s))n+=Xa[s],t+=2;else{if("\\u"!==s)throw new Ua('Unknown escape sequence: "'+s+'"');var a=Ba(e,t+=2,t+4);if(!Ha(Wa,a))throw new Ua("Bad Unicode escape at: "+t);n+=Va(Fa(a,16)),t+=4}}else{if('"'===i){r=!1,t++;break}if(Ha(qa,i))throw new Ua("Bad control character in string literal at: "+t);n+=i,t++}}if(r)throw new Ua("Unterminated string at: "+t);return{value:n,end:t}},Ka=s.JSON,Ya=s.Number,za=s.SyntaxError,$a=Ka&&Ka.parse,Ja=se("Object","keys"),Qa=Object.getOwnPropertyDescriptor,Za=d("".charAt),eo=d("".slice),to=d(/./.exec),ro=d([].push),no=/^\d$/,io=/^[1-9]$/,so=/^[\d-]$/,ao=/^[\t\n\r ]$/,oo=function(e,t,r,n){var i,s,a,o,c,u=e[t],l=n&&u===n.value,h=l&&"string"==typeof n.source?{source:n.source}:{};if(Y(u)){var d=fn(u),f=l?n.nodes:d?[]:{};if(d)for(i=f.length,a=Dt(u),o=0;o<a;o++)co(u,o,oo(u,""+o,r,o<i?f[o]:void 0));else for(s=Ja(u),a=Dt(s),o=0;o<a;o++)c=s[o],co(u,c,oo(u,c,r,y(f,c)?f[c]:void 0))}return ie(r,e,t,u,h)},co=function(e,t,r){if(q){var n=Qa(e,t);if(n&&!n.configurable)return}void 0===r?delete e[t]:ns(e,t,r)},uo=function(e,t,r,n){this.value=e,this.end=t,this.source=r,this.nodes=n},lo=function(e,t){this.source=e,this.index=t};lo.prototype={fork:function(e){return new lo(this.source,e)},parse:function(){var e=this.source,t=this.skip(ao,this.index),r=this.fork(t),n=Za(e,t);if(to(so,n))return r.number();switch(n){case"{":return r.object();case"[":return r.array();case'"':return r.string();case"t":return r.keyword(!0);case"f":return r.keyword(!1);case"n":return r.keyword(null)}throw new za('Unexpected character: "'+n+'" at: '+t)},node:function(e,t,r,n,i){return new uo(t,n,e?null:eo(this.source,r,n),i)},object:function(){for(var e=this.source,t=this.index+1,r=!1,n={},i={};t<e.length;){if(t=this.until(['"',"}"],t),"}"===Za(e,t)&&!r){t++;break}var s=this.fork(t).string(),a=s.value;t=s.end,t=this.until([":"],t)+1,t=this.skip(ao,t),s=this.fork(t).parse(),ns(i,a,s),ns(n,a,s.value),t=this.until([",","}"],s.end);var o=Za(e,t);if(","===o)r=!0,t++;else if("}"===o){t++;break}}return this.node(1,n,this.index,t,i)},array:function(){for(var e=this.source,t=this.index+1,r=!1,n=[],i=[];t<e.length;){if(t=this.skip(ao,t),"]"===Za(e,t)&&!r){t++;break}var s=this.fork(t).parse();if(ro(i,s),ro(n,s.value),t=this.until([",","]"],s.end),","===Za(e,t))r=!0,t++;else if("]"===Za(e,t)){t++;break}}return this.node(1,n,this.index,t,i)},string:function(){var e=this.index,t=Ga(this.source,this.index+1);return this.node(0,t.value,e,t.end)},number:function(){var e=this.source,t=this.index,r=t;if("-"===Za(e,r)&&r++,"0"===Za(e,r))r++;else{if(!to(io,Za(e,r)))throw new za("Failed to parse number at: "+r);r=this.skip(no,r+1)}if(!("."===Za(e,r)&&(r=this.skip(no,r+1)),"e"!==Za(e,r)&&"E"!==Za(e,r)||(r++,"+"!==Za(e,r)&&"-"!==Za(e,r)||r++,r!==(r=this.skip(no,r)))))throw new za("Failed to parse number's exponent value at: "+r);return this.node(0,Ya(eo(e,t,r)),t,r)},keyword:function(e){var t=""+e,r=this.index,n=r+t.length;if(eo(this.source,r,n)!==t)throw new za("Failed to parse value at: "+r);return this.node(0,e,r,n)},skip:function(e,t){for(var r=this.source;t<r.length&&to(e,Za(r,t));t++);return t},until:function(e,t){t=this.skip(ao,t);for(var r=Za(this.source,t),n=0;n<e.length;n++)if(e[n]===r)return t;throw new za('Unexpected character: "'+r+'" at: '+t)}};var ho=o(function(){var e,t="9007199254740993";return $a(t,function(t,r,n){e=n.source}),e!==t}),fo=F&&!o(function(){return 1/$a("-0 \t")!=-1/0});Qt({target:"JSON",stat:!0,forced:ho},{parse:function(e,t){return fo&&!K(t)?$a(e):function(e,t){e=Xr(e);var r=new lo(e,0,""),n=r.parse(),i=n.value,s=r.skip(ao,n.end);if(s<e.length)throw new za('Unexpected extra character: "'+Za(e,s)+'" after the parsed data at: '+s);return K(t)?oo({"":i},"",t,n):i}(e,t)}});var po=!o(function(){return Object.isExtensible(Object.preventExtensions({}))}),_o=gt.set,vo=SyntaxError,mo=se("JSON","parse"),go=se("Object","create"),yo=se("Object","freeze"),Eo=d("".charAt),To="Unacceptable as raw JSON",bo=function(e){return" "===e||"\t"===e||"\n"===e||"\r"===e};Qt({target:"JSON",stat:!0,forced:!Ma},{rawJSON:function(e){var t=Xr(e);if(""===t||bo(Eo(t,0))||bo(Eo(t,t.length-1)))throw new vo(To);var r=mo(t);if("object"==typeof r&&null!==r)throw new vo(To);var n=go(null);return _o(n,{type:"RawJSON"}),ns(n,"rawJSON",t),po?yo(n):n}});var So=d([].slice),Ao=String,wo=se("JSON","stringify"),Io=d(/./.exec),Ro=d("".charAt),Po=d("".charCodeAt),ko=d("".replace),Do=d("".slice),Oo=d([].push),Lo=d(1.1.toString),Co=/[\uD800-\uDFFF]/g,Mo=/^[\uD800-\uDBFF]$/,No=/^[\uDC00-\uDFFF]$/,xo=P(),Uo=xo.length,Fo=!F||o(function(){var e=se("Symbol")("stringify detection");return"[null]"!==wo([e])||"{}"!==wo({a:e})||"{}"!==wo(Object(e))}),Vo=o(function(){return'"\\udf06\\ud834"'!==wo("\udf06\ud834")||'"\\udead"'!==wo("\udead")}),jo=Fo?function(e,t){var r=So(arguments),n=Ho(t);if(K(n)||void 0!==e&&!ce(e))return r[1]=function(e,t){if(K(n)&&(t=ie(n,this,Ao(e),t)),!ce(t))return t},Ia(wo,null,r)}:wo,Bo=function(e,t,r){var n=Ro(r,t-1),i=Ro(r,t+1);return Io(Mo,e)&&!Io(No,i)||Io(No,e)&&!Io(Mo,n)?"\\u"+Lo(Po(e,0),16):e},Ho=function(e){if(K(e))return e;if(fn(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];"string"==typeof i?Oo(r,i):"number"!=typeof i&&"Number"!==xe(i)&&"String"!==xe(i)||Oo(r,Xr(i))}var s=r.length,a=!0;return function(e,t){if(a)return a=!1,t;if(fn(this))return t;for(var n=0;n<s;n++)if(r[n]===e)return t}}};wo&&Qt({target:"JSON",stat:!0,arity:3,forced:Fo||Vo||!Ma},{stringify:function(e,t,r){var n=Ho(t),i=[],s=jo(e,function(e,t){var r=K(n)?ie(n,this,Ao(e),t):t;return!Ma&&xa(r)?xo+(Oo(i,r.rawJSON)-1):r},r);if("string"!=typeof s)return s;if(Vo&&(s=ko(s,Co,Bo)),Ma)return s;for(var a="",o=s.length,c=0;c<o;c++){var u=Ro(s,c);if('"'===u){var l=Ga(s,++c).end-1,h=Do(s,c,l);a+=Do(h,0,Uo)===xo?i[Do(h,Uo)]:'"'+h+'"',c=l}else a+=u}return a}});var Xo=Map.prototype,Wo={Map:Map,set:d(Xo.set),get:d(Xo.get),has:d(Xo.has),remove:d(Xo.delete),proto:Xo},qo=Wo.Map,Go=Wo.has,Ko=Wo.get,Yo=Wo.set,zo=d([].push),$o=o(function(){return 1!==qo.groupBy("ab",function(e){return e}).get("a").length});Qt({target:"Map",stat:!0,forced:$o},{groupBy:function(e,t){_(e),de(t);var r=new qo,n=0;return ra(e,function(e){var i=t(e,n++);Go(r,i)?zo(Ko(r,i),e):Yo(r,i,[e])}),r}});var Jo=Math.sign||function(e){var t=+e;return 0===t||t!=t?t:t<0?-1:1},Qo=Math.abs,Zo=function(e,t,r,n){var i=+e,s=Qo(i),a=Jo(i);if(s<n)return a*Yn(s/n/t)*n*t;var o=(1+t/2220446049250313e-31)*s,c=o-(o-s);return c>r||c!=c?a*(1/0):a*c};Qt({target:"Math",stat:!0},{f16round:function(e){return Zo(e,.0009765625,65504,6103515625e-14)}});var ec=RangeError,tc=TypeError,rc=1/0,nc=Math.abs,ic=Math.pow,sc=d([].push),ac=ic(2,1023),oc=ic(2,53)-1,cc=Number.MAX_VALUE,uc=ic(2,971),lc={},hc={},dc={},fc={},pc={},_c=function(e,t){var r=e+t;return{hi:r,lo:t-(r-e)}};Qt({target:"Math",stat:!0},{sumPrecise:function(e){var t=[],r=0,n=fc;switch(ra(e,function(e){if(++r>=oc)throw new ec("Maximum allowed index exceeded");if("number"!=typeof e)throw new tc("Value is not a number");n!==lc&&(e!=e?n=lc:e===rc?n=n===hc?lc:dc:e===-1/0?n=n===dc?lc:hc:0===e&&1/e!==rc||n!==fc&&n!==pc||(n=pc,sc(t,e)))}),n){case lc:return NaN;case hc:return-1/0;case dc:return rc;case fc:return-0}for(var i,s,a,o,c,u,l=[],h=0,d=0;d<t.length;d++){i=t[d];for(var f=0,p=0;p<l.length;p++){if(s=l[p],nc(i)<nc(s)&&(u=i,i=s,s=u),o=(a=_c(i,s)).hi,c=a.lo,nc(o)===rc){var _=o===rc?1:-1;h+=_,nc(i=i-_*ac-_*ac)<nc(s)&&(u=i,i=s,s=u),o=(a=_c(i,s)).hi,c=a.lo}0!==c&&(l[f++]=c),i=o}l.length=f,0!==i&&sc(l,i)}var v=l.length-1;if(o=0,c=0,0!==h){var m=v>=0?l[v]:0;if(v--,nc(h)>1||h>0&&m>0||h<0&&m<0)return h>0?rc:-1/0;if(o=(a=_c(h*ac,m/2)).hi,c=a.lo,c*=2,nc(2*o)===rc)return o>0?o===ac&&c===-uc/2&&v>=0&&l[v]<0?cc:rc:o===-ac&&c===uc/2&&v>=0&&l[v]>0?-cc:-1/0;0!==c&&(l[++v]=c,c=0),o*=2}for(;v>=0&&(o=(a=_c(o,l[v--])).hi,0===(c=a.lo)););return v>=0&&(c<0&&l[v]<0||c>0&&l[v]>0)&&(s=2*c)===(i=o+s)-o&&(o=i),o}});var vc=Object.groupBy,mc=se("Object","create"),gc=d([].push),yc=!vc||o(function(){return 1!==vc("ab",function(e){return e}).a.length});Qt({target:"Object",stat:!0,forced:yc},{groupBy:function(e,t){_(e),de(t);var r=mc(null),n=0;return ra(e,function(e){var i=ge(t(e,n++));i in r?gc(r[i],e):ns(r,i,[e])}),r}});var Ec=TypeError,Tc=function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw new Ec("Bad Promise constructor");t=e,r=n}),this.resolve=de(t),this.reject=de(r)},bc=function(e){return new Tc(e)},Sc=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Ac=s.Promise,wc=!1,Ic=!Ac||!Ac.try||Sc(function(){Ac.try(function(e){wc=8===e},8)}).error||!wc;Qt({target:"Promise",stat:!0,forced:Ic},{try:function(e){var t=arguments.length>1?So(arguments,1):[],r=bc(this),n=Sc(function(){return Ia(de(e),void 0,t)});return(n.error?r.reject:r.resolve)(n.value),r.promise}}),Qt({target:"Promise",stat:!0},{withResolvers:function(){var e=bc(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var Rc=function(){},Pc=se("Reflect","construct"),kc=/^\s*(?:class|function)\b/,Dc=d(kc.exec),Oc=!kc.test(Rc),Lc=function(e){if(!K(e))return!1;try{return Pc(Rc,[],e),!0}catch(e){return!1}},Cc=function(e){if(!K(e))return!1;switch(ir(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Oc||!!Dc(kc,ot(e))}catch(e){return!0}};Cc.sham=!0;var Mc,Nc,xc=!Pc||o(function(){var e;return Lc(Lc.call)||!Lc(Object)||!Lc(function(){e=!0})||e})?Cc:Lc,Uc="USE_FUNCTION_CONSTRUCTOR",Fc=X("asyncIterator"),Vc=s.AsyncIterator,jc=S.AsyncIteratorPrototype;if(jc)Mc=jc;else if(K(Vc))Mc=Vc.prototype;else if(S[Uc]||s[Uc])try{Nc=mr(mr(mr(Function("return async function*(){}()")()))),mr(Nc)===Object.prototype&&(Mc=Nc)}catch(e){}Mc||(Mc={}),K(Mc[Fc])||Et(Mc,Fc,function(){return this});var Bc=Mc,Hc=se("Promise"),Xc="AsyncFromSyncIterator",Wc=gt.set,qc=gt.getterFor(Xc),Gc=function(e,t,r,n,i){var s=e.done;Hc.resolve(e.value).then(function(e){t(Es(e,s))},function(e){if(!s&&i)try{Ts(n,"throw",e)}catch(t){e=t}r(e)})},Kc=function(e){e.type=Xc,Wc(this,e)};Kc.prototype=xi(Cr(Bc),{next:function(){var e=qc(this);return new Hc(function(t,r){var n=re(ie(e.next,e.iterator));Gc(n,t,r,e.iterator,!0)})},return:function(){var e=qc(this).iterator;return new Hc(function(t,r){var n=fe(e,"return");if(void 0===n)return t(Es(void 0,!0));var i=re(ie(n,e));Gc(i,t,r,e)})}});var Yc=Kc,zc=X("asyncIterator"),$c=function(e,t,r,n){try{var i=fe(e,"return");if(i)return se("Promise").resolve(ie(i,e)).then(function(){t(r)},function(e){n(e)})}catch(e){return n(e)}t(r)},Jc=function(e){var t=0===e,r=1===e,n=2===e,i=3===e;return function(e,s,a){re(e);var o=void 0!==s;!o&&t||de(s);var c=Fs(e),u=se("Promise"),l=c.iterator,h=c.next,d=0;return new u(function(e,c){var f=function(e){$c(l,c,e,c)},p=function(){try{if(o)try{gn(d)}catch(e){f(e)}u.resolve(re(ie(h,l))).then(function(h){try{if(re(h).done)t?(a.length=d,e(a)):e(!i&&(n||void 0));else{var _=h.value;try{if(o){var v=s(_,d),m=function(s){if(r)p();else if(n)s?p():$c(l,e,!1,c);else if(t)try{a[d++]=s,p()}catch(e){f(e)}else s?$c(l,e,i||_,c):p()};Y(v)?u.resolve(v).then(m,f):m(v)}else a[d++]=_,p()}catch(e){f(e)}}}catch(e){c(e)}},c)}catch(e){c(e)}};p()})}},Qc={toArray:Jc(0),forEach:Jc(1),every:Jc(2),some:Jc(3),find:Jc(4)},Zc=Qc.toArray,eu=X("asyncIterator"),tu=d(Sn("Array","values")),ru=d(tu([]).next),nu=function(){return new iu(this)},iu=function(e){this.iterator=tu(e)};iu.prototype.next=function(){return ru(this.iterator)};var su=function(e){var t=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(se("Promise"))(function(r){var s=m(e);void 0!==n&&(n=tn(n,i));var a=fe(s,eu),o=a?void 0:ys(s)||nu,c=xc(t)?new t:[],u=a?function(e,t){var r=arguments.length<2?fe(e,zc):t;return r?re(ie(r,e)):new Yc(Fs(Qs(e)))}(s,a):new Yc(Fs(Qs(s,o)));r(Zc(u,n,c))})},au=Array.fromAsync,ou=!au||o(function(){var e=0;return au.call(function(){return e++,[]},{length:0}),1!==e});Qt({target:"Array",stat:!0,forced:ou},{fromAsync:su});var cu=se("Promise"),uu=se("SuppressedError"),lu=ReferenceError,hu=X("asyncDispose"),du=X("toStringTag"),fu="AsyncDisposableStack",pu=gt.set,_u=gt.getterFor(fu),vu="async-dispose",mu="disposed",gu=function(e){var t=_u(e);if(t.state===mu)throw new lu(fu+" already disposed");return t},yu=function(){pu(Ni(this,Eu),{type:fu,state:"pending",stack:[]}),q||(this.disposed=!1)},Eu=yu.prototype;xi(Eu,{disposeAsync:function(){var e=this;return new cu(function(t,r){var n=_u(e);if(n.state===mu)return t(void 0);n.state=mu,q||(e.disposed=!0);var i,s=n.stack,a=s.length,o=!1,c=function(e){o?i=new uu(e,i):(o=!0,i=e),u()},u=function(){if(a){var e=s[--a];s[a]=null;try{cu.resolve(e()).then(u,c)}catch(e){c(e)}}else n.stack=null,o?r(i):t(void 0)};u()})},use:function(e){return Bi(gu(this),e,vu),e},adopt:function(e,t){var r=gu(this);return de(t),Bi(r,void 0,vu,function(){return t(e)}),e},defer:function(e){var t=gu(this);de(e),Bi(t,void 0,vu,e)},move:function(){var e=gu(this),t=new yu;return _u(t).stack=e.stack,e.stack=[],e.state=mu,q||(this.disposed=!0),t}}),q&&Qn(Eu,"disposed",{configurable:!0,get:function(){return _u(this).state===mu}}),Et(Eu,hu,Eu.disposeAsync,{name:"disposeAsync"}),Et(Eu,du,fu,{nonWritable:!0}),Qt({global:!0,constructor:!0,forced:x&&x<136},{AsyncDisposableStack:yu});var Tu=X("asyncDispose"),bu=se("Promise");y(Bc,Tu)||Et(Bc,Tu,function(){var e=this;return new bu(function(t,r){var n=fe(e,"return");n?bu.resolve(ie(n,e)).then(function(){t(void 0)},r):t(void 0)})});var Su=TypeError,Au=function(e){if("string"==typeof e)return e;throw new Su("Argument is not a string")},wu=RangeError,Iu=d(function(e){var t=Xr(_(this)),r="",n=At(e);if(n<0||n===1/0)throw new wu("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r}),Ru=d("".slice),Pu=Math.ceil,ku=function(e){return function(t,r,n){var i,s,a=Xr(_(t)),o=kt(r),c=a.length,u=void 0===n?" ":Xr(n);return o<=c||""===u?a:((s=Iu(u,Pu((i=o-c)/u.length))).length>i&&(s=Ru(s,0,i)),e?a+s:s+a)}},Du="\t\n\v\f\r                　\u2028\u2029\ufeff",Ou=[ku(!1),ku(!0)][0],Lu=Array,Cu=RegExp.escape,Mu=d("".charAt),Nu=d("".charCodeAt),xu=d(1.1.toString),Uu=d([].join),Fu=/^[0-9a-z]/i,Vu=/^[$()*+./?[\\\]^{|}]/,ju=RegExp("^[!\"#%&',\\-:;<=>@`~"+Du+"]"),Bu=d(Fu.exec),Hu={"\t":"t","\n":"n","\v":"v","\f":"f","\r":"r"},Xu=function(e){var t=xu(Nu(e,0),16);return t.length<3?"\\x"+Ou(t,2,"0"):"\\u"+Ou(t,4,"0")},Wu=!Cu||"\\x61b"!==Cu("ab");Qt({target:"RegExp",stat:!0,forced:Wu},{escape:function(e){Au(e);for(var t=e.length,r=Lu(t),n=0;n<t;n++){var i=Mu(e,n);if(0===n&&Bu(Fu,i))r[n]=Xu(i);else if(y(Hu,i))r[n]="\\"+Hu[i];else if(Bu(Vu,i))r[n]="\\"+i;else if(Bu(ju,i))r[n]=Xu(i);else{var s=Nu(i,0);55296!=(63488&s)?r[n]=i:s>=56320||n+1>=t||56320!=(64512&Nu(e,n+1))?r[n]=Xu(i):(r[n]=i,r[++n]=Mu(e,n))}}return Uu(r,"")}});var qu=s.RegExp,Gu=!o(function(){var e=!0;try{qu(".","d")}catch(t){e=!1}var t={},r="",n=e?"dgimsy":"gimsy",i=function(e,n){Object.defineProperty(t,e,{get:function(){return r+=n,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(s.hasIndices="d"),s)i(a,s[a]);return Object.getOwnPropertyDescriptor(qu.prototype,"flags").get.call(t)!==n||r!==n}),Ku={correct:Gu},Yu=function(){var e=re(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t};q&&!Ku.correct&&(Qn(RegExp.prototype,"flags",{configurable:!0,get:Yu}),Ku.correct=!0);var zu=Set.prototype,$u={Set:Set,add:d(zu.add),has:d(zu.has),remove:d(zu.delete),proto:zu},Ju=$u.has,Qu=function(e){return Ju(e),e},Zu=function(e,t,r){for(var n,i,s=r?e:e.iterator,a=e.next;!(n=ie(a,s)).done;)if(void 0!==(i=t(n.value)))return i},el=$u.Set,tl=$u.proto,rl=d(tl.forEach),nl=d(tl.keys),il=nl(new el).next,sl=function(e,t,r){return r?Zu({iterator:nl(e),next:il},t):rl(e,t)},al=$u.Set,ol=$u.add,cl=function(e){var t=new al;return sl(e,function(e){ol(t,e)}),t},ul=gr($u.proto,"size","get")||function(e){return e.size},ll="Invalid size",hl=RangeError,dl=TypeError,fl=Math.max,pl=function(e,t){this.set=e,this.size=fl(t,0),this.has=de(e.has),this.keys=de(e.keys)};pl.prototype={getIterator:function(){return Fs(re(ie(this.keys,this.set)))},includes:function(e){return ie(this.has,this.set,e)}};var _l=function(e){re(e);var t=+e.size;if(t!=t)throw new dl(ll);var r=At(t);if(r<0)throw new hl(ll);return new pl(e,r)},vl=$u.has,ml=$u.remove,gl=function(e){var t=Qu(this),r=_l(e),n=cl(t);return ul(t)<=r.size?sl(t,function(e){r.includes(e)&&ml(n,e)}):Zu(r.getIterator(),function(e){vl(n,e)&&ml(n,e)}),n},yl=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},El=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}},Tl=function(e,t){var r=se("Set");try{(new r)[e](yl(0));try{return(new r)[e](yl(-1)),!1}catch(n){if(!t)return!0;try{return(new r)[e](El(-1/0)),!1}catch(n){return t(new r([1,2])[e](El(1/0)))}}}catch(e){return!1}},bl=!Tl("difference",function(e){return 0===e.size}),Sl=bl||o(function(){var e={size:1,has:function(){return!0},keys:function(){var e=0;return{next:function(){var r=e++>1;return t.has(1)&&t.clear(),{done:r,value:2}}}}},t=new Set([1,2,3,4]);return 3!==t.difference(e).size});Qt({target:"Set",proto:!0,real:!0,forced:Sl},{difference:gl});var Al=$u.Set,wl=$u.add,Il=$u.has,Rl=function(e){var t=Qu(this),r=_l(e),n=new Al;return ul(t)>r.size?Zu(r.getIterator(),function(e){Il(t,e)&&wl(n,e)}):sl(t,function(e){r.includes(e)&&wl(n,e)}),n},Pl=!Tl("intersection",function(e){return 2===e.size&&e.has(1)&&e.has(2)})||o(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))});Qt({target:"Set",proto:!0,real:!0,forced:Pl},{intersection:Rl});var kl=$u.has,Dl=function(e){var t=Qu(this),r=_l(e);if(ul(t)<=r.size)return!1!==sl(t,function(e){if(r.includes(e))return!1},!0);var n=r.getIterator();return!1!==Zu(n,function(e){if(kl(t,e))return Ts(n,"normal",!1)})},Ol=!Tl("isDisjointFrom",function(e){return!e});Qt({target:"Set",proto:!0,real:!0,forced:Ol},{isDisjointFrom:Dl});var Ll=function(e){var t=Qu(this),r=_l(e);return!(ul(t)>r.size)&&!1!==sl(t,function(e){if(!r.includes(e))return!1},!0)},Cl=!Tl("isSubsetOf",function(e){return e});Qt({target:"Set",proto:!0,real:!0,forced:Cl},{isSubsetOf:Ll});var Ml=$u.has,Nl=function(e){var t=Qu(this),r=_l(e);if(ul(t)<r.size)return!1;var n=r.getIterator();return!1!==Zu(n,function(e){if(!Ml(t,e))return Ts(n,"normal",!1)})},xl=!Tl("isSupersetOf",function(e){return!e});Qt({target:"Set",proto:!0,real:!0,forced:xl},{isSupersetOf:Nl});var Ul=$u.add,Fl=$u.has,Vl=$u.remove,jl=function(e){var t=Qu(this),r=_l(e).getIterator(),n=cl(t);return Zu(r,function(e){Fl(t,e)?Vl(n,e):Ul(n,e)}),n},Bl=function(e){try{var t=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},n=t[e](r);return 1===n.size&&4===n.values().next().value}catch(e){return!1}},Hl=!Tl("symmetricDifference")||!Bl("symmetricDifference");Qt({target:"Set",proto:!0,real:!0,forced:Hl},{symmetricDifference:jl});var Xl=$u.add,Wl=function(e){var t=Qu(this),r=_l(e).getIterator(),n=cl(t);return Zu(r,function(e){Xl(n,e)}),n},ql=!Tl("union")||!Bl("union");Qt({target:"Set",proto:!0,real:!0,forced:ql},{union:Wl});var Gl=d("".charCodeAt);Qt({target:"String",proto:!0},{isWellFormed:function(){for(var e=Xr(_(this)),t=e.length,r=0;r<t;r++){var n=Gl(e,r);if(55296==(63488&n)&&(n>=56320||++r>=t||56320!=(64512&Gl(e,r))))return!1}return!0}});var Kl=Array,Yl=d("".charAt),zl=d("".charCodeAt),$l=d([].join),Jl="".toWellFormed,Ql=Jl&&o(function(){return"1"!==ie(Jl,1)});Qt({target:"String",proto:!0,forced:Ql},{toWellFormed:function(){var e=Xr(_(this));if(Ql)return ie(Jl,e);for(var t=e.length,r=Kl(t),n=0;n<t;n++){var i=zl(e,n);55296!=(63488&i)?r[n]=Yl(e,n):i>=56320||n+1>=t||56320!=(64512&zl(e,n+1))?r[n]="�":(r[n]=Yl(e,n),r[++n]=Yl(e,n))}return $l(r,"")}});var Zl,eh,th,rh=gt.enforce,nh=gt.get,ih=s.Int8Array,sh=ih&&ih.prototype,ah=s.Uint8ClampedArray,oh=ah&&ah.prototype,ch=ih&&mr(ih),uh=sh&&mr(sh),lh=Object.prototype,hh=s.TypeError,dh=X("toStringTag"),fh=P("TYPED_ARRAY_TAG"),ph="TypedArrayConstructor",_h=Zn&&!!Tr&&"Opera"!==ir(s.opera),vh=!1,mh={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},gh={BigInt64Array:8,BigUint64Array:8},yh=function(e){var t=mr(e);if(Y(t)){var r=nh(t);return r&&y(r,ph)?r[ph]:yh(t)}},Eh=function(e){if(!Y(e))return!1;var t=ir(e);return y(mh,t)||y(gh,t)};for(Zl in mh)(th=(eh=s[Zl])&&eh.prototype)?rh(th)[ph]=eh:_h=!1;for(Zl in gh)(th=(eh=s[Zl])&&eh.prototype)&&(rh(th)[ph]=eh);if((!_h||!K(ch)||ch===Function.prototype)&&(ch=function(){throw new hh("Incorrect invocation")},_h))for(Zl in mh)s[Zl]&&Tr(s[Zl],ch);if((!_h||!uh||uh===lh)&&(uh=ch.prototype,_h))for(Zl in mh)s[Zl]&&Tr(s[Zl].prototype,uh);if(_h&&mr(oh)!==uh&&Tr(oh,uh),q&&!y(uh,dh))for(Zl in vh=!0,Qn(uh,dh,{configurable:!0,get:function(){return Y(this)?this[fh]:void 0}}),mh)s[Zl]&&Qe(s[Zl],fh,Zl);var Th={NATIVE_ARRAY_BUFFER_VIEWS:_h,TYPED_ARRAY_TAG:vh&&fh,aTypedArray:function(e){if(Eh(e))return e;throw new hh("Target is not a typed array")},aTypedArrayConstructor:function(e){if(K(e)&&(!Tr||ae(ch,e)))return e;throw new hh(le(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(q){if(r)for(var i in mh){var a=s[i];if(a&&y(a.prototype,e))try{delete a.prototype[e]}catch(r){try{a.prototype[e]=t}catch(e){}}}uh[e]&&!r||Et(uh,e,r?t:_h&&sh[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,i;if(q){if(Tr){if(r)for(n in mh)if((i=s[n])&&y(i,e))try{delete i[e]}catch(e){}if(ch[e]&&!r)return;try{return Et(ch,e,r?t:_h&&ch[e]||t)}catch(e){}}for(n in mh)!(i=s[n])||i[e]&&!r||Et(i,e,t)}},getTypedArrayConstructor:yh,isView:function(e){if(!Y(e))return!1;var t=ir(e);return"DataView"===t||y(mh,t)||y(gh,t)},isTypedArray:Eh,TypedArray:ch,TypedArrayPrototype:uh},bh=nn.findLast,Sh=Th.aTypedArray;(0,Th.exportTypedArrayMethod)("findLast",function(e){return bh(Sh(this),e,arguments.length>1?arguments[1]:void 0)});var Ah=nn.findLastIndex,wh=Th.aTypedArray;(0,Th.exportTypedArrayMethod)("findLastIndex",function(e){return Ah(wh(this),e,arguments.length>1?arguments[1]:void 0)});var Ih=Th.aTypedArray,Rh=Th.getTypedArrayConstructor;(0,Th.exportTypedArrayMethod)("toReversed",function(){return En(Ih(this),Rh(this))});var Ph=Th.aTypedArray,kh=Th.getTypedArrayConstructor,Dh=Th.exportTypedArrayMethod,Oh=d(Th.TypedArrayPrototype.sort);Dh("toSorted",function(e){void 0!==e&&de(e);var t=Ph(this),r=bn(kh(t),t);return Oh(r,e)});var Lh=function(e){var t=ir(e);return"BigInt64Array"===t||"BigUint64Array"===t},Ch=TypeError,Mh=function(e){var t=me(e,"number");if("number"==typeof t)throw new Ch("Can't convert number to bigint");return BigInt(t)},Nh=Th.aTypedArray,xh=Th.getTypedArrayConstructor,Uh=Th.exportTypedArrayMethod,Fh=function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(e){return 8===e}}(),Vh=Fh&&function(){try{new Int8Array(1).with(-.5,1)}catch(e){return!0}}();Uh("with",{with:function(e,t){var r=Nh(this),n=At(e),i=Lh(r)?Mh(t):+t;return Cn(r,xh(r),n,i)}}.with,!Fh||Vh);var jh=String,Bh=TypeError,Hh=function(e){if(void 0===e||Y(e))return e;throw new Bh(jh(e)+" is not an object or undefined")},Xh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Wh=Xh+"+/",qh=Xh+"-_",Gh=function(e){for(var t={},r=0;r<64;r++)t[e.charAt(r)]=r;return t},Kh={i2c:Wh,c2i:Gh(Wh),i2cUrl:qh,c2iUrl:Gh(qh)},Yh=TypeError,zh=function(e){var t=e&&e.alphabet;if(void 0===t||"base64"===t||"base64url"===t)return t||"base64";throw new Yh("Incorrect `alphabet` option")},$h=Kh.c2i,Jh=Kh.c2iUrl,Qh=s.SyntaxError,Zh=s.TypeError,ed=d("".charAt),td=function(e,t){for(var r=e.length;t<r;t++){var n=ed(e,t);if(" "!==n&&"\t"!==n&&"\n"!==n&&"\f"!==n&&"\r"!==n)break}return t},rd=function(e,t,r){var n=e.length;n<4&&(e+=2===n?"AA":"A");var i=(t[ed(e,0)]<<18)+(t[ed(e,1)]<<12)+(t[ed(e,2)]<<6)+t[ed(e,3)],s=[i>>16&255,i>>8&255,255&i];if(2===n){if(r&&0!==s[1])throw new Qh("Extra bits");return[s[0]]}if(3===n){if(r&&0!==s[2])throw new Qh("Extra bits");return[s[0],s[1]]}return s},nd=function(e,t,r){for(var n=t.length,i=0;i<n;i++)e[r+i]=t[i];return r+n},id=function(e,t,r,n){Au(e),Hh(t);var i="base64"===zh(t)?$h:Jh,s=t?t.lastChunkHandling:void 0;if(void 0===s&&(s="loose"),"loose"!==s&&"strict"!==s&&"stop-before-partial"!==s)throw new Zh("Incorrect `lastChunkHandling` option");r&&hi(r.buffer);var a=e.length,o=r||[],c=0,u=0,l="",h=0;if(n)for(;;){if((h=td(e,h))===a){if(l.length>0){if("stop-before-partial"===s)break;if("loose"!==s)throw new Qh("Missing padding");if(1===l.length)throw new Qh("Malformed padding: exactly one additional character");c=nd(o,rd(l,i,!1),c)}u=a;break}var d=ed(e,h);if(++h,"="===d){if(l.length<2)throw new Qh("Padding is too early");if(h=td(e,h),2===l.length){if(h===a){if("stop-before-partial"===s)break;throw new Qh("Malformed padding: only one =")}"="===ed(e,h)&&(++h,h=td(e,h))}if(h<a)throw new Qh("Unexpected character after padding");c=nd(o,rd(l,i,"strict"===s),c),u=a;break}if(!y(i,d))throw new Qh("Unexpected character");var f=n-c;if(1===f&&2===l.length||2===f&&3===l.length)break;if(4===(l+=d).length&&(c=nd(o,rd(l,i,!1),c),l="",u=h,c===n))break}return{bytes:o,read:u,written:c}},sd=s.Uint8Array,ad=!sd||!sd.fromBase64||!function(){try{return void sd.fromBase64("a")}catch(e){}try{sd.fromBase64("",null)}catch(e){return!0}}();sd&&Qt({target:"Uint8Array",stat:!0,forced:ad},{fromBase64:function(e){var t=id(e,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return bn(sd,t.bytes)}});var od=s.Uint8Array,cd=s.SyntaxError,ud=s.parseInt,ld=Math.min,hd=/[^\da-f]/i,dd=d(hd.exec),fd=d("".slice),pd=function(e,t){var r=e.length;if(r%2!=0)throw new cd("String should be an even number of characters");for(var n=t?ld(t.length,r/2):r/2,i=t||new od(n),s=0,a=0;a<n;){var o=fd(e,s,s+=2);if(dd(hd,o))throw new cd("String should only contain hex characters");i[a++]=ud(o,16)}return{bytes:i,read:s}};s.Uint8Array&&Qt({target:"Uint8Array",stat:!0},{fromHex:function(e){return pd(Au(e)).bytes}});var _d=TypeError,vd=function(e){if("Uint8Array"===ir(e))return e;throw new _d("Argument is not an Uint8Array")},md=s.Uint8Array,gd=!md||!md.prototype.setFromBase64||!function(){var e=new md([255,255,255,255,255]);try{return void e.setFromBase64("",null)}catch(e){}try{return void e.setFromBase64("a")}catch(e){}try{e.setFromBase64("MjYyZg===")}catch(t){return 50===e[0]&&54===e[1]&&50===e[2]&&255===e[3]&&255===e[4]}}();md&&Qt({target:"Uint8Array",proto:!0,forced:gd},{setFromBase64:function(e){vd(this);var t=id(e,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:t.read,written:t.written}}}),s.Uint8Array&&Qt({target:"Uint8Array",proto:!0},{setFromHex:function(e){vd(this),Au(e),hi(this.buffer);var t=pd(e,this).read;return{read:t,written:t/2}}});var yd=Kh.i2c,Ed=Kh.i2cUrl,Td=d("".charAt),bd=s.Uint8Array,Sd=!bd||!bd.prototype.toBase64||!function(){try{(new bd).toBase64(null)}catch(e){return!0}}();bd&&Qt({target:"Uint8Array",proto:!0,forced:Sd},{toBase64:function(){var e=vd(this),t=arguments.length?Hh(arguments[0]):void 0,r="base64"===zh(t)?yd:Ed,n=!!t&&!!t.omitPadding;hi(this.buffer);for(var i,s="",a=0,o=e.length,c=function(e){return Td(r,i>>6*e&63)};a+2<o;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],s+=c(3)+c(2)+c(1)+c(0);return a+2===o?(i=(e[a]<<16)+(e[a+1]<<8),s+=c(3)+c(2)+c(1)+(n?"":"=")):a+1===o&&(i=e[a]<<16,s+=c(3)+c(2)+(n?"":"==")),s}});var Ad=d(1.1.toString),wd=s.Uint8Array,Id=!wd||!wd.prototype.toHex||!function(){try{return"ffffffffffffffff"===new wd([255,255,255,255,255,255,255,255]).toHex()}catch(e){return!1}}();wd&&Qt({target:"Uint8Array",proto:!0,forced:Id},{toHex:function(){vd(this),hi(this.buffer);for(var e="",t=0,r=this.length;t<r;t++){var n=Ad(this[t],16);e+=1===n.length?"0"+n:n}return e}});var Rd=X("species"),Pd=Array,kd=function(e,t){return new(function(e){var t;return fn(e)&&(t=e.constructor,(xc(t)&&(t===Pd||fn(t.prototype))||Y(t)&&null===(t=t[Rd]))&&(t=void 0)),void 0===t?Pd:t}(e))(0===t?0:t)},Dd=d([].push),Od=function(e){var t=1===e,r=2===e,n=3===e,i=4===e,s=6===e,a=7===e,o=5===e||s;return function(c,u,l,h){for(var d,f,p=m(c),_=Ve(p),v=Dt(_),g=tn(u,l),y=0,E=h||kd,T=t?E(c,v):r||a?E(c,0):void 0;v>y;y++)if((o||y in _)&&(f=g(d=_[y],y,p),e))if(t)T[y]=f;else if(f)switch(e){case 3:return!0;case 5:return d;case 6:return y;case 2:Dd(T,d)}else switch(e){case 4:return!1;case 7:Dd(T,d)}return s?-1:n||i?i:T}},Ld={forEach:Od(0),map:Od(1),filter:Od(2),some:Od(3),every:Od(4),find:Od(5),findIndex:Od(6),filterReject:Od(7)},Cd=Ld.filterReject;Qt({target:"Array",proto:!0,forced:!0},{filterOut:function(e){return Cd(this,e,arguments.length>1?arguments[1]:void 0)}}),cn("filterOut");var Md=Ld.filterReject;Qt({target:"Array",proto:!0,forced:!0},{filterReject:function(e){return Md(this,e,arguments.length>1?arguments[1]:void 0)}}),cn("filterReject");var Nd=Array,xd=d([].push),Ud=function(e,t,r,n){for(var i,s,a,o=m(e),c=Ve(o),u=tn(t,r),l=Cr(null),h=Dt(c),d=0;h>d;d++)a=c[d],(s=ge(u(a,d,o)))in l?xd(l[s],a):l[s]=[a];if(n&&(i=n(o))!==Nd)for(s in l)l[s]=bn(i,l[s]);return l};Qt({target:"Array",proto:!0},{group:function(e){return Ud(this,e,arguments.length>1?arguments[1]:void 0)}}),cn("group");var Fd=function(e,t){var r=[][e];return!!r&&o(function(){r.call(null,t||function(){return 1},1)})};Qt({target:"Array",proto:!0,forced:!Fd("groupBy")},{groupBy:function(e){return Ud(this,e,arguments.length>1?arguments[1]:void 0)}}),cn("groupBy");var Vd=Wo.Map,jd=Wo.get,Bd=Wo.has,Hd=Wo.set,Xd=d([].push),Wd=function(e){for(var t,r,n=m(this),i=Ve(n),s=tn(e,arguments.length>1?arguments[1]:void 0),a=new Vd,o=Dt(i),c=0;o>c;c++)t=s(r=i[c],c,n),Bd(a,t)?Xd(jd(a,t),r):Hd(a,t,[r]);return a};Qt({target:"Array",proto:!0,name:"groupToMap",forced:!Fd("groupByToMap")},{groupByToMap:Wd}),cn("groupByToMap"),Qt({target:"Array",proto:!0,forced:E},{groupToMap:Wd}),cn("groupToMap");var qd=Object.isFrozen,Gd=function(e,t){if(!qd||!fn(e)||!qd(e))return!1;for(var r,n=0,i=e.length;n<i;)if(!("string"==typeof(r=e[n++])||t&&void 0===r))return!1;return 0!==i};Qt({target:"Array",stat:!0,sham:!0,forced:!0},{isTemplateObject:function(e){if(!Gd(e,!0))return!1;var t=e.raw;return t.length===e.length&&Gd(t,!1)}}),q&&(Qn(Array.prototype,"lastIndex",{configurable:!0,get:function(){var e=m(this),t=Dt(e);return 0===t?0:t-1}}),cn("lastIndex")),q&&(Qn(Array.prototype,"lastItem",{configurable:!0,get:function(){var e=m(this),t=Dt(e);return 0===t?void 0:e[t-1]},set:function(e){var t=m(this),r=Dt(t);return t[0===r?0:r-1]=e}}),cn("lastItem"));var Kd=Wo.Map,Yd=Wo.proto,zd=d(Yd.forEach),$d=d(Yd.entries),Jd=$d(new Kd).next,Qd=function(e,t,r){return r?Zu({iterator:$d(e),next:Jd},function(e){return t(e[1],e[0])}):zd(e,t)},Zd=Wo.Map,ef=Wo.has,tf=Wo.set,rf=d([].push),nf=function(e){var t,r,n,i=m(this),s=Dt(i),a=[],o=new Zd,c=f(e)?function(e){return e}:de(e);for(t=0;t<s;t++)n=c(r=i[t]),ef(o,n)||tf(o,n,r);return Qd(o,function(e){rf(a,e)}),a};Qt({target:"Array",proto:!0,forced:!0},{uniqueBy:nf}),cn("uniqueBy");var sf=X("toStringTag"),af=TypeError,of=function(){if(Ni(this,Bc),mr(this)===Bc)throw new af("Abstract class AsyncIterator not directly constructable")};of.prototype=Bc,y(Bc,sf)||Qe(Bc,sf,"AsyncIterator"),y(Bc,"constructor")&&Bc.constructor!==Object||Qe(Bc,"constructor",of),Qt({global:!0,constructor:!0,forced:E},{AsyncIterator:of});var cf=se("Promise"),uf=X("toStringTag"),lf="AsyncIteratorHelper",hf="WrapForValidAsyncIterator",df=gt.set,ff=function(e){var t=!e,r=gt.getterFor(e?hf:lf),n=function(e){var n=Sc(function(){return r(e)}),i=n.error,s=n.value;return i||t&&s.done?{exit:!0,value:i?cf.reject(s):cf.resolve(Es(void 0,!0))}:{exit:!1,value:s}};return xi(Cr(Bc),{next:function(){var e=n(this),t=e.value;if(e.exit)return t;var r=Sc(function(){return re(t.nextHandler(cf))}),i=r.error,s=r.value;return i&&(t.done=!0),i?cf.reject(s):cf.resolve(s)},return:function(){var t=n(this),r=t.value;if(t.exit)return r;r.done=!0;var i,s,a=r.iterator,o=Sc(function(){if(r.inner)try{Ts(r.inner.iterator,"normal")}catch(e){return Ts(a,"throw",e)}return fe(a,"return")});return i=s=o.value,o.error?cf.reject(s):void 0===i?cf.resolve(Es(void 0,!0)):(s=(o=Sc(function(){return ie(i,a)})).value,o.error?cf.reject(s):e?cf.resolve(s):cf.resolve(s).then(function(e){return re(e),Es(void 0,!0)}))}})},pf=ff(!0),_f=ff(!1);Qe(_f,uf,"Async Iterator Helper");var vf=function(e,t){var r=function(r,n){n?(n.iterator=r.iterator,n.next=r.next):n=r,n.type=t?hf:lf,n.nextHandler=e,n.counter=0,n.done=!1,df(this,n)};return r.prototype=t?pf:_f,r},mf=vf(function(e){var t=this,r=t.iterator,n=t.mapper;return new e(function(i,s){var a=function(e){t.done=!0,s(e)},o=function(e){$c(r,a,e,a)};e.resolve(re(ie(t.next,r))).then(function(r){try{if(re(r).done)t.done=!0,i(Es(void 0,!0));else{var s=r.value;try{var c=n(s,t.counter++),u=function(e){i(Es(e,!1))};Y(c)?e.resolve(c).then(u,o):u(c)}catch(e){o(e)}}}catch(e){a(e)}},a)})}),gf=function(e){return re(this),de(e),new mf(Fs(this),{mapper:e})},yf=function(e,t){return[t,e]},Ef=function(){return ie(gf,this,yf)};Qt({target:"AsyncIterator",name:"indexed",proto:!0,real:!0,forced:!0},{asIndexedPairs:Ef});var Tf=vf(function(e){var t=this;return new e(function(r,n){var i=function(e){t.done=!0,n(e)},s=function(){try{e.resolve(re(ie(t.next,t.iterator))).then(function(e){try{re(e).done?(t.done=!0,r(Es(void 0,!0))):t.remaining?(t.remaining--,s()):r(Es(e.value,!1))}catch(e){i(e)}},i)}catch(e){i(e)}};s()})});Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{drop:function(e){re(this);var t=Hs(js(+e));return new Tf(Fs(this),{remaining:t})}});var bf=Qc.every;Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{every:function(e){return bf(this,e)}});var Sf=vf(function(e){var t=this,r=t.iterator,n=t.predicate;return new e(function(i,s){var a=function(e){t.done=!0,s(e)},o=function(e){$c(r,a,e,a)},c=function(){try{e.resolve(re(ie(t.next,r))).then(function(r){try{if(re(r).done)t.done=!0,i(Es(void 0,!0));else{var s=r.value;try{var u=n(s,t.counter++),l=function(e){e?i(Es(s,!1)):c()};Y(u)?e.resolve(u).then(l,o):l(u)}catch(e){o(e)}}}catch(e){a(e)}},a)}catch(e){a(e)}};c()})});Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{filter:function(e){return re(this),de(e),new Sf(Fs(this),{predicate:e})}});var Af=Qc.find;Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{find:function(e){return Af(this,e)}});var wf=X("asyncIterator"),If=function(e){var t,r=re(e),n=!0,i=fe(r,wf);return K(i)||(i=ys(r),n=!1),void 0!==i?t=ie(i,r):(t=r,n=!0),re(t),Fs(n?t:new Yc(Fs(t)))},Rf=vf(function(e){var t=this,r=t.iterator,n=t.mapper;return new e(function(i,s){var a=function(e){t.done=!0,s(e)},o=function(e){$c(r,a,e,a)},c=function(){try{e.resolve(re(ie(t.next,r))).then(function(r){try{if(re(r).done)t.done=!0,i(Es(void 0,!0));else{var s=r.value;try{var c=n(s,t.counter++),l=function(e){try{t.inner=If(e),u()}catch(e){o(e)}};Y(c)?e.resolve(c).then(l,o):l(c)}catch(e){o(e)}}}catch(e){a(e)}},a)}catch(e){a(e)}},u=function(){var r=t.inner;if(r)try{e.resolve(re(ie(r.next,r.iterator))).then(function(e){try{re(e).done?(t.inner=null,c()):i(Es(e.value,!1))}catch(e){o(e)}},o)}catch(e){o(e)}else c()};u()})});Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{flatMap:function(e){return re(this),de(e),new Rf(Fs(this),{mapper:e,inner:null})}});var Pf=Qc.forEach;Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{forEach:function(e){return Pf(this,e)}});var kf=vf(function(){return ie(this.next,this.iterator)},!0);Qt({target:"AsyncIterator",stat:!0,forced:!0},{from:function(e){var t=If("string"==typeof e?m(e):e);return ae(Bc,t.iterator)?t.iterator:new kf(t)}}),Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{indexed:Ef}),Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{map:gf});var Df=se("Promise"),Of=TypeError;Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{reduce:function(e){re(this),de(e);var t=Fs(this),r=t.iterator,n=t.next,i=arguments.length<2,s=i?void 0:arguments[1],a=0;return new Df(function(t,o){var c=function(e){$c(r,o,e,o)},u=function(){try{Df.resolve(re(ie(n,r))).then(function(r){try{if(re(r).done)i?o(new Of("Reduce of empty iterator with no initial value")):t(s);else{var n=r.value;if(i)i=!1,s=n,u();else try{var l=e(s,n,a),h=function(e){s=e,u()};Y(l)?Df.resolve(l).then(h,c):h(l)}catch(e){c(e)}}a++}catch(e){o(e)}},o)}catch(e){o(e)}};u()})}});var Lf=Qc.some;Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{some:function(e){return Lf(this,e)}});var Cf=vf(function(e){var t,r=this,n=r.iterator;if(!r.remaining--){var i=Es(void 0,!0);return r.done=!0,void 0!==(t=n.return)?e.resolve(ie(t,n,void 0)).then(function(){return i}):i}return e.resolve(ie(r.next,n)).then(function(e){return re(e).done?(r.done=!0,Es(void 0,!0)):Es(e.value,!1)}).then(null,function(e){throw r.done=!0,e})});Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{take:function(e){re(this);var t=Hs(js(+e));return new Cf(Fs(this),{remaining:t})}});var Mf=Qc.toArray;Qt({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{toArray:function(){return Mf(this,void 0,[])}});var Nf=Ie.f,xf=X("toStringTag"),Uf=function(e,t,r){e&&!r&&(e=e.prototype),e&&!y(e,xf)&&Nf(e,xf,{configurable:!0,value:t})},Ff=os.IteratorPrototype,Vf=function(){return this},jf=function(e,t,r,n){var i=t+" Iterator";return e.prototype=Cr(Ff,{next:Ce(+!n,r)}),Uf(e,i,!1),ms[i]=Vf,e},Bf="Incorrect Iterator.range arguments",Hf="NumericRangeIterator",Xf=gt.set,Wf=gt.getterFor(Hf),qf=RangeError,Gf=TypeError,Kf=jf(function(e,t,r,n,i,s){if(typeof e!=n||t!==1/0&&t!==-1/0&&typeof t!=n)throw new Gf(Bf);if(e===1/0||e===-1/0)throw new qf(Bf);var a,o=t>e,c=!1;if(void 0===r)a=void 0;else if(Y(r))a=r.step,c=!!r.inclusive;else{if(typeof r!=n)throw new Gf(Bf);a=r}if(f(a)&&(a=o?s:-s),typeof a!=n)throw new Gf(Bf);if(a===1/0||a===-1/0||a===i&&e!==t)throw new qf(Bf);Xf(this,{type:Hf,start:e,end:t,step:a,inclusive:c,hitsEnd:e!=e||t!=t||a!=a||t>e!=a>i,currentCount:i,zero:i}),q||(this.start=e,this.end=t,this.step=a,this.inclusive=c)},Hf,function(){var e=Wf(this);if(e.hitsEnd)return Es(void 0,!0);var t=e.start,r=e.end,n=t+e.step*e.currentCount++;n===r&&(e.hitsEnd=!0);var i=e.inclusive;return(r>t?i?n>r:n>=r:i?r>n:r>=n)?(e.hitsEnd=!0,Es(void 0,!0)):Es(n,!1)}),Yf=function(e){Qn(Kf.prototype,e,{get:function(){return Wf(this)[e]},set:function(){},configurable:!0,enumerable:!1})};q&&(Yf("start"),Yf("end"),Yf("inclusive"),Yf("step"));var zf=Kf;"function"==typeof BigInt&&Qt({target:"BigInt",stat:!0,forced:!0},{range:function(e,t,r){return new zf(e,t,r,"bigint",BigInt(0),BigInt(1))}});var $f=Vt.f,Jf="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Qf={f:function(e){return Jf&&"Window"===xe(e)?function(e){try{return $f(e)}catch(e){return So(Jf)}}(e):$f(je(e))}},Zf=o(function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),ep=Object.isExtensible,tp=o(function(){ep(1)})||Zf?function(e){return!!Y(e)&&(!Zf||"ArrayBuffer"!==xe(e))&&(!ep||ep(e))}:ep,rp=t(function(e){var t=Ie.f,r=!1,n=P("meta"),i=0,s=function(e){t(e,n,{value:{objectID:"O"+i++,weakData:{}}})},a=e.exports={enable:function(){a.enable=function(){},r=!0;var e=Vt.f,t=d([].splice),i={};i[n]=1,e(i).length&&(Vt.f=function(r){for(var i=e(r),s=0,a=i.length;s<a;s++)if(i[s]===n){t(i,s,1);break}return i},Qt({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Qf.f}))},fastKey:function(e,t){if(!Y(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!y(e,n)){if(!tp(e))return"F";if(!t)return"E";s(e)}return e[n].objectID},getWeakData:function(e,t){if(!y(e,n)){if(!tp(e))return!0;if(!t)return!1;s(e)}return e[n].weakData},onFreeze:function(e){return po&&r&&tp(e)&&!y(e,n)&&s(e),e}};dt[n]=!0}),np=X("iterator"),ip=!1;try{var sp=0,ap={next:function(){return{done:!!sp++}},return:function(){ip=!0}};ap[np]=function(){return this},Array.from(ap,function(){throw 2})}catch(e){}var op=function(e,t,r){var n,i;return Tr&&K(n=t.constructor)&&n!==r&&Y(i=n.prototype)&&i!==r.prototype&&Tr(e,i),e},cp=function(e,t,r){var n=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),a=n?"set":"add",c=s[e],u=c&&c.prototype,l=c,h={},p=function(e){var t=d(u[e]);Et(u,e,"add"===e?function(e){return t(this,0===e?0:e),this}:"delete"===e?function(e){return!(i&&!Y(e))&&t(this,0===e?0:e)}:"get"===e?function(e){return i&&!Y(e)?void 0:t(this,0===e?0:e)}:"has"===e?function(e){return!(i&&!Y(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if($t(e,!K(c)||!(i||u.forEach&&!o(function(){(new c).entries().next()}))))l=r.getConstructor(t,e,n,a),rp.enable();else if($t(e,!0)){var _=new l,v=_[a](i?{}:-0,1)!==_,m=o(function(){_.has(1)}),g=function(){try{if(!ip)return!1}catch(e){return!1}var e=!1;try{var t={};t[np]=function(){return{next:function(){return{done:e=!0}}}},function(e){new c(e)}(t)}catch(e){}return e}(),y=!i&&o(function(){for(var e=new c,t=5;t--;)e[a](t,t);return!e.has(-0)});g||((l=t(function(e,t){Ni(e,u);var r=op(new c,e,l);return f(t)||ra(t,r[a],{that:r,AS_ENTRIES:n}),r})).prototype=u,u.constructor=l),(m||y)&&(p("delete"),p("has"),n&&p("get")),(y||v)&&p(a),i&&u.clear&&delete u.clear}return h[e]=l,Qt({global:!0,constructor:!0,forced:l!==c},h),Uf(l,e),i||r.setStrong(l,e,n),l},up=rt.PROPER,lp=rt.CONFIGURABLE,hp=os.IteratorPrototype,dp=os.BUGGY_SAFARI_ITERATORS,fp=X("iterator"),pp="keys",_p="values",vp="entries",mp=function(){return this},gp=X("species"),yp=function(e){var t=se(e);q&&t&&!t[gp]&&Qn(t,gp,{configurable:!0,get:function(){return this}})},Ep=rp.fastKey,Tp=gt.set,bp=gt.getterFor,Sp={getConstructor:function(e,t,r,n){var i=e(function(e,i){Ni(e,s),Tp(e,{type:t,index:Cr(null),first:null,last:null,size:0}),q||(e.size=0),f(i)||ra(i,e[n],{that:e,AS_ENTRIES:r})}),s=i.prototype,a=bp(t),o=function(e,t,r){var n,i,s=a(e),o=c(e,t);return o?o.value=r:(s.last=o={index:i=Ep(t,!0),key:t,value:r,previous:n=s.last,next:null,removed:!1},s.first||(s.first=o),n&&(n.next=o),q?s.size++:e.size++,"F"!==i&&(s.index[i]=o)),e},c=function(e,t){var r,n=a(e),i=Ep(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key===t)return r};return xi(s,{clear:function(){for(var e=a(this),t=e.first;t;)t.removed=!0,t.previous&&(t.previous=t.previous.next=null),t=t.next;e.first=e.last=null,e.index=Cr(null),q?e.size=0:this.size=0},delete:function(e){var t=this,r=a(t),n=c(t,e);if(n){var i=n.next,s=n.previous;delete r.index[n.index],n.removed=!0,s&&(s.next=i),i&&(i.previous=s),r.first===n&&(r.first=i),r.last===n&&(r.last=s),q?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=a(this),n=tn(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),xi(s,r?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return o(this,0===e?0:e,t)}}:{add:function(e){return o(this,e=0===e?0:e,e)}}),q&&Qn(s,"size",{configurable:!0,get:function(){return a(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=bp(t),s=bp(n);!function(e,t,r,n,i,a){jf(r,t,function(){for(var e=s(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?Es("keys"===t?r.key:"values"===t?r.value:[r.key,r.value],!1):(e.target=null,Es(void 0,!0))});var o,c,u,l=function(e){if(e===i&&_)return _;if(!dp&&e&&e in f)return f[e];switch(e){case pp:case _p:case vp:return function(){return new r(this,e)}}return function(){return new r(this)}},h=t+" Iterator",d=!1,f=e.prototype,p=f[fp]||f["@@iterator"]||i&&f[i],_=!dp&&p||l(i),v="Array"===t&&f.entries||p;if(v&&(o=mr(v.call(new e)))!==Object.prototype&&o.next&&(mr(o)!==hp&&(Tr?Tr(o,hp):K(o[fp])||Et(o,fp,mp)),Uf(o,h,!0)),up&&i===_p&&p&&p.name!==_p&&(lp?Qe(f,"name",_p):(d=!0,_=function(){return ie(p,this)})),i)for(u in c={values:l(_p),keys:a?_:l(pp),entries:l(vp)})(dp||d||!(u in f))&&Et(f,u,c[u]);f[fp]!==_&&Et(f,fp,_,{name:i}),ms[t]=_}(e,t,function(e,t){Tp(this,{type:n,target:e,state:i(e),kind:t,last:null})},0,r?"entries":"values",!r),yp(t)}};cp("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Sp);var Ap=rp.getWeakData,wp=gt.set,Ip=gt.getterFor,Rp=Ld.find,Pp=Ld.findIndex,kp=d([].splice),Dp=0,Op=function(e){return e.frozen||(e.frozen=new Lp)},Lp=function(){this.entries=[]},Cp=function(e,t){return Rp(e.entries,function(e){return e[0]===t})};Lp.prototype={get:function(e){var t=Cp(this,e);if(t)return t[1]},has:function(e){return!!Cp(this,e)},set:function(e,t){var r=Cp(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=Pp(this.entries,function(t){return t[0]===e});return~t&&kp(this.entries,t,1),!!~t}};var Mp,Np={getConstructor:function(e,t,r,n){var i=e(function(e,i){Ni(e,s),wp(e,{type:t,id:Dp++,frozen:null}),f(i)||ra(i,e[n],{that:e,AS_ENTRIES:r})}),s=i.prototype,a=Ip(t),o=function(e,t,r){var n=a(e),i=Ap(re(t),!0);return!0===i?Op(n).set(t,r):i[n.id]=r,e};return xi(s,{delete:function(e){var t=a(this);if(!Y(e))return!1;var r=Ap(e);return!0===r?Op(t).delete(e):r&&y(r,t.id)&&delete r[t.id]},has:function(e){var t=a(this);if(!Y(e))return!1;var r=Ap(e);return!0===r?Op(t).has(e):r&&y(r,t.id)}}),xi(s,r?{get:function(e){var t=a(this);if(Y(e)){var r=Ap(e);if(!0===r)return Op(t).get(e);if(r)return r[t.id]}},set:function(e,t){return o(this,e,t)}}:{add:function(e){return o(this,e,!0)}}),i}},xp=gt.enforce,Up=Object,Fp=Array.isArray,Vp=Up.isExtensible,jp=Up.isFrozen,Bp=Up.isSealed,Hp=Up.freeze,Xp=Up.seal,Wp=!s.ActiveXObject&&"ActiveXObject"in s,qp=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Gp=cp("WeakMap",qp,Np),Kp=Gp.prototype,Yp=d(Kp.set);if(ut)if(Wp){Mp=Np.getConstructor(qp,"WeakMap",!0),rp.enable();var zp=d(Kp.delete),$p=d(Kp.has),Jp=d(Kp.get);xi(Kp,{delete:function(e){if(Y(e)&&!Vp(e)){var t=xp(this);return t.frozen||(t.frozen=new Mp),zp(this,e)||t.frozen.delete(e)}return zp(this,e)},has:function(e){if(Y(e)&&!Vp(e)){var t=xp(this);return t.frozen||(t.frozen=new Mp),$p(this,e)||t.frozen.has(e)}return $p(this,e)},get:function(e){if(Y(e)&&!Vp(e)){var t=xp(this);return t.frozen||(t.frozen=new Mp),$p(this,e)?Jp(this,e):t.frozen.get(e)}return Jp(this,e)},set:function(e,t){if(Y(e)&&!Vp(e)){var r=xp(this);r.frozen||(r.frozen=new Mp),$p(this,e)?Yp(this,e,t):r.frozen.set(e,t)}else Yp(this,e,t);return this}})}else po&&o(function(){var e=Hp([]);return Yp(new Gp,e,1),!jp(e)})&&xi(Kp,{set:function(e,t){var r;return Fp(e)&&(jp(e)?r=Hp:Bp(e)&&(r=Xp)),Yp(this,e,t),r&&r(e),this}});var Qp=Object,Zp=TypeError,e_=se("Map"),t_=se("WeakMap"),r_=function(){this.object=null,this.symbol=null,this.primitives=null,this.objectsByIndex=Cr(null)};r_.prototype.get=function(e,t){return this[e]||(this[e]=t())},r_.prototype.next=function(e,t,r){var n=r?this.objectsByIndex[e]||(this.objectsByIndex[e]=new t_):this.primitives||(this.primitives=new e_),i=n.get(t);return i||n.set(t,i=new r_),i};var n_=new r_,i_=function(){var e,t,r=n_,n=arguments.length;for(e=0;e<n;e++)Y(t=arguments[e])&&(r=r.next(e,t,!0));if(this===Qp&&r===n_)throw new Zp("Composite keys must contain a non-primitive component");for(e=0;e<n;e++)Y(t=arguments[e])||(r=r.next(e,t,!1));return r},s_=Object,a_=function(){var e=se("Object","freeze");return e?e(Cr(null)):Cr(null)};Qt({global:!0,forced:!0},{compositeKey:function(){return Ia(i_,s_,arguments).get("object",a_)}}),Qt({global:!0,forced:!0},{compositeSymbol:function(){return 1===arguments.length&&"string"==typeof arguments[0]?se("Symbol").for(arguments[0]):Ia(i_,null,arguments).get("symbol",se("Symbol"))}});var o_=d(DataView.prototype.getUint8);Qt({target:"DataView",proto:!0,forced:!0},{getUint8Clamped:function(e){return o_(this,e)}});var c_=Math.round,u_=d(DataView.prototype.setUint8);Qt({target:"DataView",proto:!0,forced:!0},{setUint8Clamped:function(e,t){u_(Bn(this),Xn(e),function(e){var t=c_(e);return t<0?0:t>255?255:255&t}(t))}});var l_=function(){return d(de(this))};Qt({target:"Function",proto:!0,forced:!0},{demethodize:l_});var h_=Object.getOwnPropertyDescriptor,d_=/^\s*class\b/,f_=d(d_.exec);Qt({target:"Function",stat:!0,sham:!0,forced:!0},{isCallable:function(e){return K(e)&&!function(e){try{if(!q||!f_(d_,ot(e)))return!1}catch(e){}var t=h_(e,"prototype");return!!t&&y(t,"writable")&&!t.writable}(e)}}),Qt({target:"Function",stat:!0,forced:!0},{isConstructor:xc});var p_=Ie.f,__=X("metadata"),v_=Function.prototype;void 0===v_[__]&&p_(v_,__,{value:null}),Qt({target:"Function",proto:!0,forced:!0,name:"demethodize"},{unThis:l_});var m_=os.IteratorPrototype.map,g_=function(e,t){return[t,e]},y_=function(){return ie(m_,this,g_)};Qt({target:"Iterator",name:"indexed",proto:!0,real:!0,forced:!0},{asIndexedPairs:y_});var E_=RangeError,T_=d([].push),b_=Cs(function(){for(var e,t=this.iterator,r=this.next,n=this.chunkSize,i=[];;){if((e=re(ie(r,t))).done)return i.length?i:void(this.done=!0);if(T_(i,e.value),i.length===n)return i}});Qt({target:"Iterator",proto:!0,real:!0,forced:!0},{chunks:function(e){var t=re(this);return"number"==typeof e&&e&&e>>>0===e?new b_(Fs(t),{chunkSize:e}):Ts(t,"throw",new E_("chunkSize must be integer in [1, 2^32-1]"))}}),Qt({target:"Iterator",proto:!0,real:!0,forced:!0},{indexed:y_});var S_=TypeError;Qt({target:"Iterator",stat:!0,forced:!0},{range:function(e,t,r){if("number"==typeof e)return new zf(e,t,r,"number",0,1);if("bigint"==typeof e)return new zf(e,t,r,"bigint",BigInt(0),BigInt(1));throw new S_("Incorrect Iterator.range arguments")}});var A_=RangeError,w_=TypeError,I_=d([].push),R_=d([].slice),P_="allow-partial",k_=Cs(function(){for(var e,t,r=this.iterator,n=this.next,i=this.buffer,s=this.windowSize,a=this.allowPartial;;){if(e=re(ie(n,r)),t=this.done=!!e.done,a&&t&&i.length&&i.length<s)return Es(i,!1);if(t)return Es(void 0,!0);if(i.length===s&&(this.buffer=i=R_(i,1)),I_(i,e.value),i.length===s)return Es(i,!1)}},!1,!0),D_=function(e,t,r){return re(e),"number"==typeof t&&t&&t>>>0===t?void 0!==r&&"only-full"!==r&&r!==P_?Ts(e,"throw",new w_("Incorrect `undersized` argument")):new k_(Fs(e),{windowSize:t,buffer:[],allowPartial:r===P_}):Ts(e,"throw",new A_("`windowSize` must be integer in [1, 2^32-1]"))};Qt({target:"Iterator",proto:!0,real:!0,forced:!0},{sliding:function(e){return D_(this,e,"allow-partial")}}),Qt({target:"Iterator",proto:!0,real:!0,forced:!0},{toAsync:function(){return new kf(Fs(new Yc(Fs(re(this)))))}}),Qt({target:"Iterator",proto:!0,real:!0,forced:!0},{windows:function(e){return D_(this,e,arguments.length<2?void 0:arguments[1])}});var O_=function(e){return Fs(Qs(e))},L_=TypeError,C_=function(e){var t=e&&e.mode;if(void 0===t||"shortest"===t||"longest"===t||"strict"===t)return t||"shortest";throw new L_("Incorrect `mode` option")},M_=TypeError,N_=d([].slice),x_=d([].push),U_="Iterator is exhausted",F_="throw",V_=Cs(function(){var e=this.iterCount;if(e){for(var t,r,n=this.openIters,i=this.iters,s=this.padding,a=this.mode,o=this.finishResults,c=[],u=0;u<e;u++){var l=i[u];if(null===l)t=s[u];else{try{r=(t=ie(l.next,l.iterator)).done,t=t.value}catch(e){return n[u]=void 0,bs(n,F_,e)}if(r){if(n[u]=void 0,this.openItersCount--,"shortest"===a)return this.done=!0,bs(n,"normal",void 0);if("strict"===a){if(u)return bs(n,F_,new M_(U_));for(var h,d,f=1;f<e;f++){try{d=(h=ie(i[f].next,i[f].iterator)).done,h=h.value}catch(e){return n[f]=void 0,bs(n,F_,h)}if(!d)return bs(n,F_,new M_(U_));n[f]=void 0,this.openItersCount--}return void(this.done=!0)}if(!this.openItersCount)return void(this.done=!0);i[u]=null,t=s[u]}}x_(c,t)}return o?o(c):c}this.done=!0}),j_=function(e,t,r,n){var i=e.length;return new V_({iters:e,iterCount:i,openIters:N_(e,0),openItersCount:i,mode:t,padding:r,finishResults:n})},B_=d([].concat),H_=d([].push),X_="throw";Qt({target:"Iterator",stat:!0},{zip:function(e){re(e);for(var t,r,n,i=arguments.length>1?Hh(arguments[1]):void 0,s=C_(i),a="longest"===s?Hh(i&&i.padding):void 0,o=[],c=[],u=O_(e);!r;){try{r=(n=re(ie(u.next,u.iterator))).done}catch(e){return bs(o,X_,e)}if(!r){try{t=la(n.value,!0)}catch(e){return bs(B_([u.iterator],o),X_,e)}H_(o,t)}}var l,h,d,f=o.length;if("longest"===s)if(void 0===a)for(l=0;l<f;l++)H_(c,void 0);else{try{d=O_(a)}catch(e){return bs(o,X_,e)}var p=!0;for(l=0;l<f;l++)if(p){try{h=(n=re(ie(d.next,d.iterator))).done,n=n.value}catch(e){return bs(o,X_,e)}h?p=!1:H_(c,n)}else H_(c,void 0);if(p)try{Ts(d.iterator,"normal")}catch(e){return bs(o,X_,e)}}return j_(o,s,c)}});var W_=se("Object","create"),q_=se("Reflect","ownKeys"),G_=d([].push),K_="throw";Qt({target:"Iterator",stat:!0},{zipKeyed:function(e){re(e);var t,r,n,i=arguments.length>1?Hh(arguments[1]):void 0,s=C_(i),a="longest"===s?Hh(i&&i.padding):void 0,o=[],c=[],u=q_(e),l=[],h=Le.f;for(t=0;t<u.length;t++)try{if(r=u[t],!ie(h,e,r))continue;void 0!==(n=e[r])&&(G_(l,r),G_(o,la(n,!0)))}catch(e){return bs(o,K_,e)}var d=o.length;if("longest"===s)if(void 0===a)for(t=0;t<d;t++)G_(c,void 0);else for(t=0;t<l.length;t++){try{n=a[l[t]]}catch(e){return bs(o,K_,e)}G_(c,n)}return j_(o,s,c,function(e){for(var t=W_(null),r=0;r<d;r++)ns(t,l[r],e[r]);return t})}});var Y_=Wo.has,z_=function(e){return Y_(e),e},$_=Wo.remove;Qt({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var e,t=z_(this),r=!0,n=0,i=arguments.length;n<i;n++)e=$_(t,arguments[n]),r=r&&e;return!!r}});var J_=Wo.get,Q_=Wo.has,Z_=Wo.set;Qt({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(e,t){var r,n,i=z_(this);return Q_(i,e)?(r=J_(i,e),"update"in t&&(r=t.update(r,e,i),Z_(i,e,r)),r):(n=t.insert(e,i),Z_(i,e,n),n)}}),Qt({target:"Map",proto:!0,real:!0,forced:!0},{every:function(e){var t=z_(this),r=tn(e,arguments.length>1?arguments[1]:void 0);return!1!==Qd(t,function(e,n){if(!r(e,n,t))return!1},!0)}});var ev=Wo.Map,tv=Wo.set;Qt({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(e){var t=z_(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=new ev;return Qd(t,function(e,i){r(e,i,t)&&tv(n,i,e)}),n}}),Qt({target:"Map",proto:!0,real:!0,forced:!0},{find:function(e){var t=z_(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=Qd(t,function(e,n){if(r(e,n,t))return{value:e}},!0);return n&&n.value}}),Qt({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(e){var t=z_(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=Qd(t,function(e,n){if(r(e,n,t))return{key:n}},!0);return n&&n.key}});var rv=function(e,t,r){return function(n){var i=m(n),s=arguments.length,a=s>1?arguments[1]:void 0,o=void 0!==a,c=o?tn(a,s>2?arguments[2]:void 0):void 0,u=new e,l=0;return ra(i,function(e){var n=o?c(e,l++):e;r?t(u,re(n)[0],n[1]):t(u,n)}),u}};Qt({target:"Map",stat:!0,forced:!0},{from:rv(Wo.Map,Wo.set,!0)});var nv=Wo.get,iv=Wo.has,sv=Wo.set;Qt({target:"Map",proto:!0,real:!0,forced:E},{getOrInsert:function(e,t){return iv(z_(this),e)?nv(this,e):(sv(this,e,t),t)}});var av=Wo.get,ov=Wo.has,cv=Wo.set;Qt({target:"Map",proto:!0,real:!0,forced:E},{getOrInsertComputed:function(e,t){if(z_(this),de(t),ov(this,e))return av(this,e);0===e&&1/e==-1/0&&(e=0);var r=t(e);return cv(this,e,r),r}}),Qt({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(e){return!0===Qd(z_(this),function(t){if(function(e,t){return e===t||e!=e&&t!=t}(t,e))return!0},!0)}});var uv=Wo.Map;Qt({target:"Map",stat:!0,forced:!0},{keyBy:function(e,t){var r=new(K(this)?this:uv);de(t);var n=de(r.set);return ra(e,function(e){ie(n,r,t(e),e)}),r}}),Qt({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(e){var t=Qd(z_(this),function(t,r){if(t===e)return{key:r}},!0);return t&&t.key}});var lv=Wo.Map,hv=Wo.set;Qt({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(e){var t=z_(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=new lv;return Qd(t,function(e,i){hv(n,r(e,i,t),e)}),n}});var dv=Wo.Map,fv=Wo.set;Qt({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(e){var t=z_(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=new dv;return Qd(t,function(e,i){fv(n,i,r(e,i,t))}),n}});var pv=Wo.set;Qt({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(e){for(var t=z_(this),r=arguments.length,n=0;n<r;)ra(arguments[n++],function(e,r){pv(t,e,r)},{AS_ENTRIES:!0});return t}});var _v=function(e,t,r){return function(){for(var n=new e,i=arguments.length,s=0;s<i;s++){var a=arguments[s];r?t(n,re(a)[0],a[1]):t(n,a)}return n}};Qt({target:"Map",stat:!0,forced:!0},{of:_v(Wo.Map,Wo.set,!0)});var vv=TypeError;Qt({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=z_(this),r=arguments.length<2,n=r?void 0:arguments[1];if(de(e),Qd(t,function(i,s){r?(r=!1,n=i):n=e(n,i,s,t)}),r)throw new vv("Reduce of empty map with no initial value");return n}}),Qt({target:"Map",proto:!0,real:!0,forced:!0},{some:function(e){var t=z_(this),r=tn(e,arguments.length>1?arguments[1]:void 0);return!0===Qd(t,function(e,n){if(r(e,n,t))return!0},!0)}});var mv=TypeError,gv=Wo.get,yv=Wo.has,Ev=Wo.set;Qt({target:"Map",proto:!0,real:!0,forced:!0},{update:function(e,t){var r=z_(this),n=arguments.length;de(t);var i=yv(r,e);if(!i&&n<3)throw new mv("Updating absent value");var s=i?gv(r,e):de(n>2?arguments[2]:void 0)(e,r);return Ev(r,e,t(s,e,r)),r}});var Tv=TypeError,bv=function(e,t){var r,n=re(this),i=de(n.get),s=de(n.has),a=de(n.set),o=arguments.length>2?arguments[2]:void 0;if(!K(t)&&!K(o))throw new Tv("At least one callback required");return ie(s,n,e)?(r=ie(i,n,e),K(t)&&(r=t(r),ie(a,n,e,r))):K(o)&&(r=o(),ie(a,n,e,r)),r};Qt({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:bv}),Qt({target:"Map",proto:!0,real:!0,forced:!0},{upsert:bv});var Sv=TypeError,Av=function(e){if("number"==typeof e)return e;throw new Sv("Argument is not a number")},wv=Math.min,Iv=Math.max,Rv=function(e,t,r){return wv(Iv(Av(e),Av(t)),Av(r))};Qt({target:"Math",stat:!0,forced:!0},{clamp:Rv}),Qt({target:"Math",stat:!0,nonConfigurable:!0,nonWritable:!0},{DEG_PER_RAD:Math.PI/180});var Pv=180/Math.PI;Qt({target:"Math",stat:!0,forced:!0},{degrees:function(e){return e*Pv}});var kv=function(e,t,r,n,i){var s=+e,a=+t,o=+r,c=+n,u=+i;return s!=s||a!=a||o!=o||c!=c||u!=u?NaN:s===1/0||s===-1/0?s:(s-a)*(u-c)/(o-a)+c},Dv=Math.fround||function(e){return Zo(e,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)};Qt({target:"Math",stat:!0,forced:!0},{fscale:function(e,t,r,n,i){return Dv(kv(e,t,r,n,i))}}),Qt({target:"Math",stat:!0,forced:!0},{iaddh:function(e,t,r,n){var i=e>>>0,s=r>>>0;return(t>>>0)+(n>>>0)+((i&s|(i|s)&~(i+s>>>0))>>>31)|0}}),Qt({target:"Math",stat:!0,forced:!0},{imulh:function(e,t){var r=65535,n=+e,i=+t,s=n&r,a=i&r,o=n>>16,c=i>>16,u=(o*a>>>0)+(s*a>>>16);return o*c+(u>>16)+((s*c>>>0)+(u&r)>>16)}}),Qt({target:"Math",stat:!0,forced:!0},{isubh:function(e,t,r,n){var i=e>>>0,s=r>>>0;return(t>>>0)-(n>>>0)-((~i&s|(i^~s)&i-s>>>0)>>>31)|0}}),Qt({target:"Math",stat:!0,nonConfigurable:!0,nonWritable:!0},{RAD_PER_DEG:180/Math.PI});var Ov=Math.PI/180;Qt({target:"Math",stat:!0,forced:!0},{radians:function(e){return e*Ov}}),Qt({target:"Math",stat:!0,forced:!0},{scale:kv});var Lv=s.isFinite,Cv=Number.isFinite||function(e){return"number"==typeof e&&Lv(e)},Mv="Seeded Random",Nv=Mv+" Generator",xv=gt.set,Uv=gt.getterFor(Nv),Fv=TypeError,Vv=jf(function(e){xv(this,{type:Nv,seed:e%2147483647})},Mv,function(){var e=Uv(this),t=e.seed=(1103515245*e.seed+12345)%2147483647;return Es((1073741823&t)/1073741823,!1)});Qt({target:"Math",stat:!0,forced:!0},{seededPRNG:function(e){var t=re(e).seed;if(!Cv(t))throw new Fv('Math.seededPRNG() argument should have a "seed" field with a finite value.');return new Vv(t)}}),Qt({target:"Math",stat:!0,forced:!0},{signbit:function(e){var t=+e;return t==t&&0===t?1/t==-1/0:t<0}}),Qt({target:"Math",stat:!0,forced:!0},{umulh:function(e,t){var r=65535,n=+e,i=+t,s=n&r,a=i&r,o=n>>>16,c=i>>>16,u=(o*a>>>0)+(s*a>>>16);return o*c+(u>>>16)+((s*c>>>0)+(u&r)>>>16)}});var jv=d(1.1.valueOf);Qt({target:"Number",proto:!0,forced:!0},{clamp:function(e,t){return Rv(jv(this),e,t)}});var Bv="Invalid number representation",Hv=RangeError,Xv=SyntaxError,Wv=TypeError,qv=parseInt,Gv=Math.pow,Kv=/^[\d.a-z]+$/,Yv=d("".charAt),zv=d(Kv.exec),$v=d(1.1.toString),Jv=d("".slice),Qv=d("".split);Qt({target:"Number",stat:!0,forced:!0},{fromString:function(e,t){var r=1;if("string"!=typeof e)throw new Wv(Bv);if(!e.length)throw new Xv(Bv);if("-"===Yv(e,0)&&(r=-1,!(e=Jv(e,1)).length))throw new Xv(Bv);var n=void 0===t?10:At(t);if(n<2||n>36)throw new Hv("Invalid radix");if(!zv(Kv,e))throw new Xv(Bv);var i=Qv(e,"."),s=qv(i[0],n);if(i.length>1&&(s+=qv(i[1],n)/Gv(n,i[1].length)),10===n&&$v(s,n)!==e)throw new Xv(Bv);return r*s}}),Qt({target:"Number",stat:!0,forced:!0},{range:function(e,t,r){return new zf(e,t,r,"number",0,1)}});var Zv="Object Iterator",em=gt.set,tm=gt.getterFor(Zv),rm=jf(function(e,t){var r=m(e);em(this,{type:Zv,mode:t,object:r,keys:br(r),index:0})},"Object",function(){for(var e=tm(this),t=e.keys;;){if(null===t||e.index>=t.length)return e.object=e.keys=null,Es(void 0,!0);var r=t[e.index++],n=e.object;if(y(n,r)){switch(e.mode){case"keys":return Es(r,!1);case"values":return Es(n[r],!1)}return Es([r,n[r]],!1)}}});Qt({target:"Object",stat:!0,forced:!0},{iterateEntries:function(e){return new rm(e,"entries")}}),Qt({target:"Object",stat:!0,forced:!0},{iterateKeys:function(e){return new rm(e,"keys")}}),Qt({target:"Object",stat:!0,forced:!0},{iterateValues:function(e){return new rm(e,"values")}});var nm=X("observable"),im="Observable",sm="Subscription",am="SubscriptionObserver",om=gt.getterFor,cm=gt.set,um=om(im),lm=om(sm),hm=om(am),dm=function(e){this.observer=re(e),this.cleanup=null,this.subscriptionObserver=null};dm.prototype={type:sm,clean:function(){var e=this.cleanup;if(e){this.cleanup=null;try{e()}catch(e){}}},close:function(){if(!q){var e=this.facade,t=this.subscriptionObserver;e.closed=!0,t&&(t.closed=!0)}this.observer=null},isClosed:function(){return null===this.observer}};var fm=function(e,t){var r,n=cm(this,new dm(e));q||(this.closed=!1);try{(r=fe(e,"start"))&&ie(r,e,this)}catch(e){}if(!n.isClosed()){var i=n.subscriptionObserver=new pm(n);try{var s=t(i),a=s;f(s)||(n.cleanup=K(s.unsubscribe)?function(){a.unsubscribe()}:de(s))}catch(e){return void i.error(e)}n.isClosed()&&n.clean()}};fm.prototype=xi({},{unsubscribe:function(){var e=lm(this);e.isClosed()||(e.close(),e.clean())}}),q&&Qn(fm.prototype,"closed",{configurable:!0,get:function(){return lm(this).isClosed()}});var pm=function(e){cm(this,{type:am,subscriptionState:e}),q||(this.closed=!1)};pm.prototype=xi({},{next:function(e){var t=hm(this).subscriptionState;if(!t.isClosed()){var r=t.observer;try{var n=fe(r,"next");n&&ie(n,r,e)}catch(e){}}},error:function(e){var t=hm(this).subscriptionState;if(!t.isClosed()){var r=t.observer;t.close();try{var n=fe(r,"error");n&&ie(n,r,e)}catch(e){}t.clean()}},complete:function(){var e=hm(this).subscriptionState;if(!e.isClosed()){var t=e.observer;e.close();try{var r=fe(t,"complete");r&&ie(r,t)}catch(e){}e.clean()}}}),q&&Qn(pm.prototype,"closed",{configurable:!0,get:function(){return hm(this).subscriptionState.isClosed()}});var _m=function(e){Ni(this,vm),cm(this,{type:im,subscriber:de(e)})},vm=_m.prototype;xi(vm,{subscribe:function(e){var t=arguments.length;return new fm(K(e)?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:Y(e)?e:{},um(this).subscriber)}}),Et(vm,nm,function(){return this}),Qt({global:!0,constructor:!0,forced:!0},{Observable:_m}),yp(im);var mm=X("observable");Qt({target:"Observable",stat:!0,forced:!0},{from:function(e){var t=xc(this)?this:se("Observable"),r=fe(re(e),mm);if(r){var n=re(ie(r,e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}var i=Qs(e);return new t(function(e){ra(i,function(t,r){if(e.next(t),e.closed)return r()},{IS_ITERATOR:!0,INTERRUPTED:!0}),e.complete()})}});var gm=se("Array");Qt({target:"Observable",stat:!0,forced:!0},{of:function(){for(var e=xc(this)?this:se("Observable"),t=arguments.length,r=gm(t),n=0;n<t;)r[n]=arguments[n++];return new e(function(e){for(var n=0;n<t;n++)if(e.next(r[n]),e.closed)return;e.complete()})}});var ym=se("Map"),Em=se("WeakMap"),Tm=d([].push),bm=A("metadata"),Sm=bm.store||(bm.store=new Em),Am=function(e,t,r){var n=Sm.get(e);if(!n){if(!r)return;Sm.set(e,n=new ym)}var i=n.get(t);if(!i){if(!r)return;n.set(t,i=new ym)}return i},wm={store:Sm,getMap:Am,has:function(e,t,r){var n=Am(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=Am(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){Am(r,n,!0).set(e,t)},keys:function(e,t){var r=Am(e,t,!1),n=[];return r&&r.forEach(function(e,t){Tm(n,t)}),n},toKey:function(e){return void 0===e||"symbol"==typeof e?e:String(e)}},Im=wm.toKey,Rm=wm.set;Qt({target:"Reflect",stat:!0},{defineMetadata:function(e,t,r){var n=arguments.length<4?void 0:Im(arguments[3]);Rm(e,t,re(r),n)}});var Pm=wm.toKey,km=wm.getMap,Dm=wm.store;Qt({target:"Reflect",stat:!0},{deleteMetadata:function(e,t){var r=arguments.length<3?void 0:Pm(arguments[2]),n=km(re(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var i=Dm.get(t);return i.delete(r),!!i.size||Dm.delete(t)}});var Om=wm.has,Lm=wm.get,Cm=wm.toKey,Mm=function(e,t,r){if(Om(e,t,r))return Lm(e,t,r);var n=mr(t);return null!==n?Mm(e,n,r):void 0};Qt({target:"Reflect",stat:!0},{getMetadata:function(e,t){var r=arguments.length<3?void 0:Cm(arguments[2]);return Mm(e,re(t),r)}});var Nm=d(nf),xm=d([].concat),Um=wm.keys,Fm=wm.toKey,Vm=function(e,t){var r=Um(e,t),n=mr(e);if(null===n)return r;var i=Vm(n,t);return i.length?r.length?Nm(xm(r,i)):i:r};Qt({target:"Reflect",stat:!0},{getMetadataKeys:function(e){var t=arguments.length<2?void 0:Fm(arguments[1]);return Vm(re(e),t)}});var jm=wm.get,Bm=wm.toKey;Qt({target:"Reflect",stat:!0},{getOwnMetadata:function(e,t){var r=arguments.length<3?void 0:Bm(arguments[2]);return jm(e,re(t),r)}});var Hm=wm.keys,Xm=wm.toKey;Qt({target:"Reflect",stat:!0},{getOwnMetadataKeys:function(e){var t=arguments.length<2?void 0:Xm(arguments[1]);return Hm(re(e),t)}});var Wm=wm.has,qm=wm.toKey,Gm=function(e,t,r){if(Wm(e,t,r))return!0;var n=mr(t);return null!==n&&Gm(e,n,r)};Qt({target:"Reflect",stat:!0},{hasMetadata:function(e,t){var r=arguments.length<3?void 0:qm(arguments[2]);return Gm(e,re(t),r)}});var Km=wm.has,Ym=wm.toKey;Qt({target:"Reflect",stat:!0},{hasOwnMetadata:function(e,t){var r=arguments.length<3?void 0:Ym(arguments[2]);return Km(e,re(t),r)}});var zm=wm.toKey,$m=wm.set;Qt({target:"Reflect",stat:!0},{metadata:function(e,t){return function(r,n){$m(e,t,re(r),zm(n))}}});var Jm=$u.add;Qt({target:"Set",proto:!0,real:!0,forced:!0},{addAll:function(){for(var e=Qu(this),t=0,r=arguments.length;t<r;t++)Jm(e,arguments[t]);return e}});var Qm=$u.remove;Qt({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var e,t=Qu(this),r=!0,n=0,i=arguments.length;n<i;n++)e=Qm(t,arguments[n]),r=r&&e;return!!r}});var Zm=X("iterator"),eg=Object,tg=se("Set"),rg=function(e){return function(e){return Y(e)&&"number"==typeof e.size&&K(e.has)&&K(e.keys)}(e)?e:function(e){if(f(e))return!1;var t=eg(e);return void 0!==t[Zm]||"@@iterator"in t||y(ms,ir(t))}(e)?new tg(e):e};Qt({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(e){return ie(gl,this,rg(e))}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{every:function(e){var t=Qu(this),r=tn(e,arguments.length>1?arguments[1]:void 0);return!1!==sl(t,function(e){if(!r(e,e,t))return!1},!0)}});var ng=$u.Set,ig=$u.add;Qt({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(e){var t=Qu(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=new ng;return sl(t,function(e){r(e,e,t)&&ig(n,e)}),n}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{find:function(e){var t=Qu(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=sl(t,function(e){if(r(e,e,t))return{value:e}},!0);return n&&n.value}}),Qt({target:"Set",stat:!0,forced:!0},{from:rv($u.Set,$u.add,!1)}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(e){return ie(Rl,this,rg(e))}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(e){return ie(Dl,this,rg(e))}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(e){return ie(Ll,this,rg(e))}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(e){return ie(Nl,this,rg(e))}});var sg=d([].join),ag=d([].push);Qt({target:"Set",proto:!0,real:!0,forced:!0},{join:function(e){var t=Qu(this),r=void 0===e?",":Xr(e),n=[];return sl(t,function(e){ag(n,e)}),sg(n,r)}});var og=$u.Set,cg=$u.add;Qt({target:"Set",proto:!0,real:!0,forced:!0},{map:function(e){var t=Qu(this),r=tn(e,arguments.length>1?arguments[1]:void 0),n=new og;return sl(t,function(e){cg(n,r(e,e,t))}),n}}),Qt({target:"Set",stat:!0,forced:!0},{of:_v($u.Set,$u.add,!1)});var ug=TypeError;Qt({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=Qu(this),r=arguments.length<2,n=r?void 0:arguments[1];if(de(e),sl(t,function(i){r?(r=!1,n=i):n=e(n,i,i,t)}),r)throw new ug("Reduce of empty set with no initial value");return n}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{some:function(e){var t=Qu(this),r=tn(e,arguments.length>1?arguments[1]:void 0);return!0===sl(t,function(e){if(r(e,e,t))return!0},!0)}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(e){return ie(jl,this,rg(e))}}),Qt({target:"Set",proto:!0,real:!0,forced:!0},{union:function(e){return ie(Wl,this,rg(e))}});var lg=d("".charAt),hg=d("".charCodeAt),dg=d("".slice),fg=function(e){return function(t,r){var n,i,s=Xr(_(t)),a=At(r),o=s.length;return a<0||a>=o?e?"":void 0:(n=hg(s,a))<55296||n>56319||a+1===o||(i=hg(s,a+1))<56320||i>57343?e?lg(s,a):n:e?dg(s,a,a+2):i-56320+(n-55296<<10)+65536}},pg={codeAt:fg(!1),charAt:fg(!0)},_g=pg.charAt;Qt({target:"String",proto:!0,forced:!0},{at:function(e){var t=Xr(_(this)),r=t.length,n=At(e),i=n>=0?n:r+n;return i<0||i>=r?void 0:_g(t,i)}});var vg=TypeError,mg=d([].push),gg=d([].join),yg=function(e){var t=je(e),r=Dt(t);if(!r)return"";for(var n=arguments.length,i=[],s=0;;){var a=t[s++];if(void 0===a)throw new vg("Incorrect template");if(mg(i,Xr(a)),s===r)return gg(i,"");s<n&&mg(i,Xr(arguments[s]))}};Qt({target:"String",stat:!0,forced:!0},{cooked:yg});var Eg=pg.codeAt,Tg=pg.charAt,bg="String Iterator",Sg=gt.set,Ag=gt.getterFor(bg),wg=jf(function(e){Sg(this,{type:bg,string:e,index:0})},"String",function(){var e,t=Ag(this),r=t.string,n=t.index;return n>=r.length?Es(void 0,!0):(e=Tg(r,n),t.index+=e.length,Es({codePoint:Eg(e,0),position:n},!1))});Qt({target:"String",proto:!0,forced:!0},{codePoints:function(){return new wg(Xr(_(this)))}});var Ig=WeakMap.prototype,Rg={WeakMap:WeakMap,set:d(Ig.set),get:d(Ig.get),has:d(Ig.has),remove:d(Ig.delete)},Pg=String.fromCharCode,kg=se("String","fromCodePoint"),Dg=d("".charAt),Og=d("".charCodeAt),Lg=d("".indexOf),Cg=d("".slice),Mg=function(e,t){var r=Og(e,t);return r>=48&&r<=57},Ng=function(e,t,r){if(r>=e.length)return-1;for(var n=0;t<r;t++){var i=xg(Og(e,t));if(-1===i)return-1;n=16*n+i}return n},xg=function(e){return e>=48&&e<=57?e-48:e>=97&&e<=102?e-97+10:e>=65&&e<=70?e-65+10:-1},Ug=function(e){for(var t,r="",n=0,i=0;(i=Lg(e,"\\",i))>-1;){if(r+=Cg(e,n,i),++i===e.length)return;var s=Dg(e,i++);switch(s){case"b":r+="\b";break;case"t":r+="\t";break;case"n":r+="\n";break;case"v":r+="\v";break;case"f":r+="\f";break;case"r":r+="\r";break;case"\r":i<e.length&&"\n"===Dg(e,i)&&++i;case"\n":case"\u2028":case"\u2029":break;case"0":if(Mg(e,i))return;r+="\0";break;case"x":if(-1===(t=Ng(e,i,i+2)))return;i+=2,r+=Pg(t);break;case"u":if(i<e.length&&"{"===Dg(e,i)){var a=Lg(e,"}",++i);if(-1===a)return;t=Ng(e,i,a),i=a+1}else t=Ng(e,i,i+4),i+=4;if(-1===t||t>1114111)return;r+=kg(t);break;default:if(Mg(s,0))return;r+=s}n=i}return r+Cg(e,n)},Fg=Ie.f,Vg=new Rg.WeakMap,jg=Rg.get,Bg=Rg.has,Hg=Rg.set,Xg=Array,Wg=TypeError,qg=Object.freeze||Object,Gg=Object.isFrozen,Kg=Math.min,Yg=d("".charAt),zg=d("".slice),$g=d("".split),Jg=d(/./.exec),Qg=/([\n\u2028\u2029]|\r\n?)/g,Zg=RegExp("^["+Du+"]*"),ey=RegExp("[^"+Du+"]"),ty="Invalid tag",ry=function(e,t){if(void 0===t||e===t)return e;for(var r=0,n=Kg(e.length,t.length);r<n&&Yg(e,r)===Yg(t,r);r++);return zg(e,0,r)},ny=function(e){return yt(function(t){var r=So(arguments);return r[0]=function(e){var t=e.raw;if(po&&!Gg(t))throw new Wg("Raw template should be frozen");if(Bg(Vg,t))return jg(Vg,t);var r=function(e){var t,r,n,i,s=m(e),a=Dt(s),o=Xg(a),c=Xg(a),u=0;if(!a)throw new Wg(ty);for(;u<a;u++){var l=s[u];if("string"!=typeof l)throw new Wg(ty);o[u]=$g(l,Qg)}for(u=0;u<a;u++){var h=u+1===a;if(t=o[u],0===u){if(1===t.length||t[0].length>0)throw new Wg("Invalid opening line");t[1]=""}if(h){if(1===t.length||Jg(ey,t[t.length-1]))throw new Wg("Invalid closing line");t[t.length-2]="",t[t.length-1]=""}for(var d=2;d<t.length;d+=2){var f=t[d],p=d+1===t.length&&!h,_=Jg(Zg,f)[0];p||_.length!==f.length?r=ry(_,r):t[d]=""}}var v=r?r.length:0;for(u=0;u<a;u++){for(n=(t=o[u])[0],i=1;i<t.length;i+=2)n+=t[i]+zg(t[i+1],v);c[u]=n}return c}(t),n=function(e){for(var t=0,r=e.length,n=Xg(r);t<r;t++)n[t]=Ug(e[t]);return n}(r);return Fg(n,"raw",{value:qg(r)}),qg(n),Hg(Vg,t,n),n}(re(t)),Ia(e,this,r)},"")},iy=ny(yg);Qt({target:"String",stat:!0,forced:!0},{dedent:function(e){return re(e),K(e)?ny(e):Ia(iy,this,arguments)}}),Pe("customMatcher");var sy=se("Symbol"),ay=sy.keyFor,oy=d(sy.prototype.valueOf),cy=sy.isRegisteredSymbol||function(e){try{return void 0!==ay(oy(e))}catch(e){return!1}};Qt({target:"Symbol",stat:!0},{isRegisteredSymbol:cy}),Qt({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:cy});for(var uy=se("Symbol"),ly=uy.isWellKnownSymbol,hy=se("Object","getOwnPropertyNames"),dy=d(uy.prototype.valueOf),fy=A("wks"),py=0,_y=hy(uy),vy=_y.length;py<vy;py++)try{var my=_y[py];ce(uy[my])&&X(my)}catch(e){}var gy=function(e){if(ly&&ly(e))return!0;try{for(var t=dy(e),r=0,n=hy(fy),i=n.length;r<i;r++)if(fy[n[r]]==t)return!0}catch(e){}return!1};Qt({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:gy}),Qt({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:gy}),Pe("matcher"),Pe("metadata"),Pe("metadataKey"),Pe("observable"),Pe("patternMatch"),Pe("replaceAll");var yy=TypeError,Ey=Th.aTypedArrayConstructor;(0,Th.exportTypedArrayStaticMethod)("fromAsync",function(e){var t=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(se("Promise"))(function(r){!function(e){if(xc(e))return e;throw new yy(le(e)+" is not a constructor")}(t),r(su(e,n,i))}).then(function(e){return bn(Ey(t),e)})},!0);var Ty=Th.getTypedArrayConstructor,by=function(e,t){return bn(Ty(e),t)},Sy=Ld.filterReject,Ay=Th.aTypedArray;(0,Th.exportTypedArrayMethod)("filterOut",function(e){var t=Sy(Ay(this),e,arguments.length>1?arguments[1]:void 0);return by(this,t)},!0);var wy=Ld.filterReject,Iy=Th.aTypedArray;(0,Th.exportTypedArrayMethod)("filterReject",function(e){var t=wy(Iy(this),e,arguments.length>1?arguments[1]:void 0);return by(this,t)},!0);var Ry=Th.aTypedArray,Py=Th.getTypedArrayConstructor;(0,Th.exportTypedArrayMethod)("groupBy",function(e){var t=arguments.length>1?arguments[1]:void 0;return Ud(Ry(this),e,t,Py)},!0);var ky=Th.aTypedArray,Dy=Th.getTypedArrayConstructor,Oy=Th.exportTypedArrayMethod,Ly=Math.max,Cy=Math.min;Oy("toSpliced",function(e,t){var r,n,i,s,a,o,c,u=ky(this),l=Dy(u),h=Dt(u),d=Rt(e,h),f=arguments.length,p=0;if(0===f)r=n=0;else if(1===f)r=0,n=h-d;else if(n=Cy(Ly(At(t),0),h-d),r=f-2){s=new l(r),i=Lh(s);for(var _=2;_<f;_++)a=arguments[_],s[_-2]=i?Mh(a):+a}for(c=new l(o=h+r-n);p<d;p++)c[p]=u[p];for(;p<d+r;p++)c[p]=s[p-d];for(;p<o;p++)c[p]=u[p+n-r];return c},!0);var My=Th.aTypedArray,Ny=Th.getTypedArrayConstructor,xy=Th.exportTypedArrayMethod,Uy=d(nf);xy("uniqueBy",function(e){return My(this),bn(Ny(this),Uy(this,e))},!0);var Fy=Rg.has,Vy=function(e){return Fy(e),e},jy=Rg.remove;Qt({target:"WeakMap",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var e,t=Vy(this),r=!0,n=0,i=arguments.length;n<i;n++)e=jy(t,arguments[n]),r=r&&e;return!!r}}),Qt({target:"WeakMap",stat:!0,forced:!0},{from:rv(Rg.WeakMap,Rg.set,!0)}),Qt({target:"WeakMap",stat:!0,forced:!0},{of:_v(Rg.WeakMap,Rg.set,!0)});var By=Rg.get,Hy=Rg.has,Xy=Rg.set;Qt({target:"WeakMap",proto:!0,real:!0,forced:!0},{emplace:function(e,t){var r,n,i=Vy(this);return Hy(i,e)?(r=By(i,e),"update"in t&&(r=t.update(r,e,i),Xy(i,e,r)),r):(n=t.insert(e,i),Xy(i,e,n),n)}});var Wy=Rg.get,qy=Rg.has,Gy=Rg.set;Qt({target:"WeakMap",proto:!0,real:!0,forced:E},{getOrInsert:function(e,t){return qy(Vy(this),e)?Wy(this,e):(Gy(this,e,t),t)}});var Ky=new Rg.WeakMap,Yy=Rg.set,zy=Rg.remove,$y=Rg.get,Jy=Rg.has,Qy=Rg.set,Zy=!function(){try{WeakMap.prototype.getOrInsertComputed&&(new WeakMap).getOrInsertComputed(1,function(){throw 1})}catch(e){return e instanceof TypeError}}();Qt({target:"WeakMap",proto:!0,real:!0,forced:Zy},{getOrInsertComputed:function(e,t){if(Vy(this),function(e){Yy(Ky,e,1),zy(Ky,e)}(e),de(t),Jy(this,e))return $y(this,e);var r=t(e);return Qy(this,e,r),r}}),Qt({target:"WeakMap",proto:!0,real:!0,forced:!0},{upsert:bv});var eE=WeakSet.prototype,tE={WeakSet:WeakSet,add:d(eE.add),has:d(eE.has),remove:d(eE.delete)},rE=tE.has,nE=function(e){return rE(e),e},iE=tE.add;Qt({target:"WeakSet",proto:!0,real:!0,forced:!0},{addAll:function(){for(var e=nE(this),t=0,r=arguments.length;t<r;t++)iE(e,arguments[t]);return e}});var sE=tE.remove;Qt({target:"WeakSet",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var e,t=nE(this),r=!0,n=0,i=arguments.length;n<i;n++)e=sE(t,arguments[n]),r=r&&e;return!!r}}),Qt({target:"WeakSet",stat:!0,forced:!0},{from:rv(tE.WeakSet,tE.add,!1)}),Qt({target:"WeakSet",stat:!0,forced:!0},{of:_v(tE.WeakSet,tE.add,!1)});var aE={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},oE=Ie.f,cE="DOMException",uE=se("Error"),lE=se(cE),hE=function(){Ni(this,dE);var e=arguments.length,t=Wr(e<1?void 0:arguments[0]),r=Wr(e<2?void 0:arguments[1],"Error"),n=new lE(t,r),i=new uE(t);return i.name=cE,oE(n,"stack",Ce(1,Vr(i.stack,1))),op(n,this,hE),n},dE=hE.prototype=lE.prototype,fE="stack"in new uE(cE),pE="stack"in new lE(1,2),_E=lE&&q&&Object.getOwnPropertyDescriptor(s,cE),vE=!(!_E||_E.writable&&_E.configurable),mE=fE&&!vE&&!pE;Qt({global:!0,constructor:!0,forced:mE},{DOMException:mE?hE:lE});var gE=se(cE),yE=gE.prototype;if(yE.constructor!==gE)for(var EE in oE(yE,"constructor",Ce(1,gE)),aE)if(y(aE,EE)){var TE=aE[EE],bE=TE.s;y(gE,bE)||oE(gE,bE,Ce(6,TE.c))}var SE,AE,wE,IE,RE=TypeError,PE=function(e,t){if(e<t)throw new RE("Not enough arguments");return e},kE=/(?:ipad|iphone|ipod).*applewebkit/i.test(O),DE=s.setImmediate,OE=s.clearImmediate,LE=s.process,CE=s.Dispatch,ME=s.Function,NE=s.MessageChannel,xE=s.String,UE=0,FE={},VE="onreadystatechange";o(function(){SE=s.location});var jE=function(e){if(y(FE,e)){var t=FE[e];delete FE[e],t()}},BE=function(e){return function(){jE(e)}},HE=function(e){jE(e.data)},XE=function(e){s.postMessage(xE(e),SE.protocol+"//"+SE.host)};DE&&OE||(DE=function(e){PE(arguments.length,1);var t=K(e)?e:ME(e),r=So(arguments,1);return FE[++UE]=function(){Ia(t,void 0,r)},AE(UE),UE},OE=function(e){delete FE[e]},pi?AE=function(e){LE.nextTick(BE(e))}:CE&&CE.now?AE=function(e){CE.now(BE(e))}:NE&&!kE?(IE=(wE=new NE).port2,wE.port1.onmessage=HE,AE=tn(IE.postMessage,IE)):s.addEventListener&&K(s.postMessage)&&!s.importScripts&&SE&&"file:"!==SE.protocol&&!o(XE)?(AE=XE,s.addEventListener("message",HE,!1)):AE=VE in J("script")?function(e){wr.appendChild(J("script"))[VE]=function(){wr.removeChild(this),jE(e)}}:function(e){setTimeout(BE(e),0)});var WE={set:DE,clear:OE},qE=WE.clear;Qt({global:!0,bind:!0,enumerable:!0,forced:s.clearImmediate!==qE},{clearImmediate:qE});var GE=s.Function,KE=/MSIE .\./.test(O)||"BUN"===fi&&function(){var e=s.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),YE=WE.set,zE=s.setImmediate?function(e){return KE?function(t,r){var n=PE(arguments.length,1)>1,i=K(t)?t:GE(t),s=n?So(arguments,1):[],a=n?function(){Ia(i,this,s)}:i;return e(a)}:e}(YE):YE;Qt({global:!0,bind:!0,enumerable:!0,forced:s.setImmediate!==zE},{setImmediate:zE});var $E=RegExp.prototype,JE=Ku.correct?function(e){return e.flags}:function(e){return Ku.correct||!ae($E,e)||y(e,"flags")?e.flags:ie(Yu,e)},QE=s.Object,ZE=s.Array,eT=s.Date,tT=s.Error,rT=s.TypeError,nT=s.PerformanceMark,iT=se("DOMException"),sT=Wo.Map,aT=Wo.has,oT=Wo.get,cT=Wo.set,uT=$u.Set,lT=$u.add,hT=$u.has,dT=se("Object","keys"),fT=d([].push),pT=d((!0).valueOf),_T=d(1.1.valueOf),vT=d("".valueOf),mT=d(eT.prototype.getTime),gT=P("structuredClone"),yT="DataCloneError",ET="Transferring",TT=function(e){return!o(function(){var t=new s.Set([7]),r=e(t),n=e(QE(7));return r===t||!r.has(7)||!Y(n)||7!==+n})&&e},bT=function(e,t){return!o(function(){var r=new t,n=e({a:r,b:r});return!(n&&n.a===n.b&&n.a instanceof t&&n.a.stack===r.stack)})},ST=s.structuredClone,AT=!bT(ST,tT)||!bT(ST,iT)||!function(e){return!o(function(){var t=e(new s.AggregateError([1],gT,{cause:3}));return"AggregateError"!==t.name||1!==t.errors[0]||t.message!==gT||3!==t.cause})}(ST),wT=!ST&&TT(function(e){return new nT(gT,{detail:e}).detail}),IT=TT(ST)||wT,RT=function(e){throw new iT("Uncloneable type: "+e,yT)},PT=function(e,t){throw new iT((t||"Cloning")+" of "+e+" cannot be properly polyfilled in this engine",yT)},kT=function(e,t){return IT||PT(t),IT(e)},DT=function(e,t,r){if(aT(t,e))return oT(t,e);var n,i,a,o,c,u;if("SharedArrayBuffer"===(r||ir(e)))n=IT?IT(e):e;else{var l=s.DataView;l||K(e.slice)||PT("ArrayBuffer");try{if(K(e.slice)&&!e.resizable)n=e.slice(0);else{i=e.byteLength,a="maxByteLength"in e?{maxByteLength:e.maxByteLength}:void 0,n=new ArrayBuffer(i,a),o=new l(e),c=new l(n);for(u=0;u<i;u++)c.setUint8(u,o.getUint8(u))}}catch(e){throw new iT("ArrayBuffer is detached",yT)}}return cT(t,e,n),n},OT=function(e,t){if(ce(e)&&RT("Symbol"),!Y(e))return e;if(t){if(aT(t,e))return oT(t,e)}else t=new sT;var r,n,i,a,o,c,u,l,h=ir(e);switch(h){case"Array":i=ZE(Dt(e));break;case"Object":i={};break;case"Map":i=new sT;break;case"Set":i=new uT;break;case"RegExp":i=new RegExp(e.source,JE(e));break;case"Error":switch(n=e.name){case"AggregateError":i=new(se(n))([]);break;case"EvalError":case"RangeError":case"ReferenceError":case"SuppressedError":case"SyntaxError":case"TypeError":case"URIError":i=new(se(n));break;case"CompileError":case"LinkError":case"RuntimeError":i=new(se("WebAssembly",n));break;default:i=new tT}break;case"DOMException":i=new iT(e.message,e.name);break;case"ArrayBuffer":case"SharedArrayBuffer":i=DT(e,t,h);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":c="DataView"===h?e.byteLength:e.length,i=function(e,t,r,n,i){var a=s[t];return Y(a)||PT(t),new a(DT(e.buffer,i),r,n)}(e,h,e.byteOffset,c,t);break;case"DOMQuad":try{i=new DOMQuad(OT(e.p1,t),OT(e.p2,t),OT(e.p3,t),OT(e.p4,t))}catch(t){i=kT(e,h)}break;case"File":if(IT)try{i=IT(e),ir(i)!==h&&(i=void 0)}catch(e){}if(!i)try{i=new File([e],e.name,e)}catch(e){}i||PT(h);break;case"FileList":if(a=function(){var e;try{e=new s.DataTransfer}catch(t){try{e=new s.ClipboardEvent("").clipboardData}catch(e){}}return e&&e.items&&e.files?e:null}()){for(o=0,c=Dt(e);o<c;o++)a.items.add(OT(e[o],t));i=a.files}else i=kT(e,h);break;case"ImageData":try{i=new ImageData(OT(e.data,t),e.width,e.height,{colorSpace:e.colorSpace})}catch(t){i=kT(e,h)}break;default:if(IT)i=IT(e);else switch(h){case"BigInt":i=QE(e.valueOf());break;case"Boolean":i=QE(pT(e));break;case"Number":i=QE(_T(e));break;case"String":i=QE(vT(e));break;case"Date":i=new eT(mT(e));break;case"Blob":try{i=e.slice(0,e.size,e.type)}catch(e){PT(h)}break;case"DOMPoint":case"DOMPointReadOnly":r=s[h];try{i=r.fromPoint?r.fromPoint(e):new r(e.x,e.y,e.z,e.w)}catch(e){PT(h)}break;case"DOMRect":case"DOMRectReadOnly":r=s[h];try{i=r.fromRect?r.fromRect(e):new r(e.x,e.y,e.width,e.height)}catch(e){PT(h)}break;case"DOMMatrix":case"DOMMatrixReadOnly":r=s[h];try{i=r.fromMatrix?r.fromMatrix(e):new r(e)}catch(e){PT(h)}break;case"AudioData":case"VideoFrame":K(e.clone)||PT(h);try{i=e.clone()}catch(e){RT(h)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":PT(h);default:RT(h)}}switch(cT(t,e,i),h){case"Array":case"Object":for(u=dT(e),o=0,c=Dt(u);o<c;o++)l=u[o],ns(i,l,OT(e[l],t));break;case"Map":e.forEach(function(e,r){cT(i,OT(r,t),OT(e,t))});break;case"Set":e.forEach(function(e){lT(i,OT(e,t))});break;case"Error":Qe(i,"message",OT(e.message,t)),y(e,"cause")&&Qe(i,"cause",OT(e.cause,t)),"AggregateError"===n?i.errors=OT(e.errors,t):"SuppressedError"===n&&(i.error=OT(e.error,t),i.suppressed=OT(e.suppressed,t));case"DOMException":jr&&Qe(i,"stack",OT(e.stack,t))}return i};Qt({global:!0,enumerable:!0,sham:!vi,forced:AT},{structuredClone:function(e){var t,r,n=PE(arguments.length,1)>1&&!f(arguments[1])?re(arguments[1]):void 0,i=n?n.transfer:void 0;void 0!==i&&(r=function(e,t){if(!Y(e))throw new rT("Transfer option cannot be converted to a sequence");var r=[];ra(e,function(e){fT(r,re(e))});for(var n,i,a,o,c,u=0,l=Dt(r),h=new uT;u<l;){if(n=r[u++],"ArrayBuffer"===(i=ir(n))?hT(h,n):aT(t,n))throw new iT("Duplicate transferable",yT);if("ArrayBuffer"!==i){if(vi)o=ST(n,{transfer:[n]});else switch(i){case"ImageBitmap":a=s.OffscreenCanvas,xc(a)||PT(i,ET);try{(c=new a(n.width,n.height)).getContext("bitmaprenderer").transferFromImageBitmap(n),o=c.transferToImageBitmap()}catch(e){}break;case"AudioData":case"VideoFrame":K(n.clone)&&K(n.close)||PT(i,ET);try{o=n.clone(),n.close()}catch(e){}break;case"MediaSourceHandle":case"MessagePort":case"MIDIAccess":case"OffscreenCanvas":case"ReadableStream":case"RTCDataChannel":case"TransformStream":case"WebTransportReceiveStream":case"WebTransportSendStream":case"WritableStream":PT(i,ET)}if(void 0===o)throw new iT("This object cannot be transferred: "+i,yT);cT(t,n,o)}else lT(h,n)}return h}(i,t=new sT));var a=OT(e,t);return r&&function(e){sl(e,function(e){vi?IT(e,{transfer:[e]}):K(e.transfer)?e.transfer():Ti?Ti(e):PT("ArrayBuffer",ET)})}(r),a}});var LT=X("iterator"),CT=!o(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),n="";return e.pathname="c%20d",t.forEach(function(e,r){t.delete("b"),n+=r+e}),r.delete("a",2),r.delete("b",void 0),!t.size&&!q||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[LT]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==n||"x"!==new URL("https://x",void 0).host}),MT=se("URL"),NT=CT&&o(function(){MT.canParse()}),xT=o(function(){return 1!==MT.canParse.length});Qt({target:"URL",stat:!0,forced:!NT||xT},{canParse:function(e){var t=PE(arguments.length,1),r=Xr(e),n=t<2||void 0===arguments[1]?void 0:Xr(arguments[1]);try{return!!new MT(r,n)}catch(e){return!1}}});var UT=se("URL");Qt({target:"URL",stat:!0,forced:!CT},{parse:function(e){var t=PE(arguments.length,1),r=Xr(e),n=t<2||void 0===arguments[1]?void 0:Xr(arguments[1]);try{return new UT(r,n)}catch(e){return null}}});var FT=URLSearchParams,VT=FT.prototype,jT=d(VT.append),BT=d(VT.delete),HT=d(VT.forEach),XT=d([].push),WT=new FT("a=1&a=2&b=3");WT.delete("a",1),WT.delete("b",void 0),WT+""!="a=2"&&Et(VT,"delete",function(e){var t=arguments.length,r=t<2?void 0:arguments[1];if(t&&void 0===r)return BT(this,e);var n=[];HT(this,function(e,t){XT(n,{key:t,value:e})}),PE(t,1);for(var i,s=Xr(e),a=Xr(r),o=0,c=0,u=!1,l=n.length;o<l;)i=n[o++],u||i.key===s?(u=!0,BT(this,i.key)):c++;for(;c<l;)(i=n[c++]).key===s&&i.value===a||jT(this,i.key,i.value)},{enumerable:!0,unsafe:!0});var qT=URLSearchParams,GT=qT.prototype,KT=d(GT.getAll),YT=d(GT.has),zT=new qT("a=1");!zT.has("a",2)&&zT.has("a",void 0)||Et(GT,"has",function(e){var t=arguments.length,r=t<2?void 0:arguments[1];if(t&&void 0===r)return YT(this,e);var n=KT(this,e);PE(t,1);for(var i=Xr(r),s=0;s<n.length;)if(n[s++]===i)return!0;return!1},{enumerable:!0,unsafe:!0});var $T=URLSearchParams.prototype,JT=d($T.forEach);q&&!("size"in $T)&&Qn($T,"size",{get:function(){var e=0;return JT(this,function(){e++}),e},configurable:!0,enumerable:!0});const QT={MANIFEST:"manifest",SEGMENT:"segment"},ZT={method:"GET",async:!0,retry:0,throwHttpErrors:!0,headers:{},hooks:{beforeRequest:[],beforeRetry:[],afterResponse:[]},validateStatus:function(e){return e>=200&&e<300},retryStatus:function(e){return[408,413,429].includes(e)||e>=500&&e<600}};function eb(e){return e.filter((e,t,r)=>r.indexOf(e)===t)}function tb(e,t){return e.reduce((e,r,n,i)=>e.concat(t(r,n,i)),[])}function rb(e){return(t,...r)=>(r.forEach(r=>{for(const n in r){const i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,Object.assign(i,e))}}),t)}const nb=rb({enumerable:!1,configurable:!0,writeable:!1}),ib=rb({enumerable:!1,configurable:!1,writeable:!1}),sb=rb({enumerable:!0,configurable:!0,writeable:!1}),ab={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},ob=e=>new Promise(t=>setTimeout(t,e));function cb(e){return"webkitDisplayingFullscreen"in e&&e.webkitDisplayingFullscreen}function ub(e){if(e&&cb(e))return!0;const t=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find(e=>void 0!==e);return Boolean(t)}const lb=()=>{const e=window.navigator.connection?.downlink;return void 0===e?null:1e3*e*1e3};function hb(e){try{const t=new URLSearchParams;return Object.entries(e).forEach(([e,r])=>{void 0!==r&&t.append(e,String(r))}),t.toString()}catch(e){return""}}function db(e){if("string"!=typeof e)return{};try{const t=new URLSearchParams(e),r={};return t.forEach((e,t)=>{r[t]=e}),r}catch(e){return{}}}function fb(e){try{return new URL(e)}catch(e){return{}}}const pb=(e,t,r=!1)=>{try{const n=new URL(e);return Object.entries(t).forEach(([e,t])=>{r&&void 0===t||n.searchParams.set(e,t?.toString()??"")}),n.toString()}catch(t){return e}},_b=e=>{try{const{username:t,password:r,host:n}=new URL(e);return n?t||r?`${t}:${r}@${n}`:n:null}catch(e){return null}};function vb(e){const t=fb(e),r=t&&t.pathname.match(/^\/(exp=)?(\d{10,})/);if(r&&r[2])return 1e3*Number(r[2])}async function mb(e){return/json=1/.test(e)?(await yS(e).json()).url:e}function gb(e){e.substring(0,e.lastIndexOf("/")+1)}const yb=(e,t=!1)=>new Promise((r,n)=>{if(t){const t=document.querySelector(`script[src="${e}"]`);if(t&&!t.dataset.error)return void setTimeout(r,0)}const i=document.createElement("script");i.src=e,i.addEventListener("load",r),i.addEventListener("error",e=>{i.dataset.error="true",n(e.error)}),document.head.appendChild(i)}),Eb=e=>Math.pow(e,2),Tb=e=>Math.sqrt(e),bb=(e,t)=>{const r=(...e)=>{},n=(...e)=>{};return Object.assign(n,{log:r,warn:(...e)=>{},error:(...e)=>{}}),n};function Sb(e,...t){return t.reduce((e,t)=>(Object.keys(t||{}).forEach(r=>{const n=e[r],i=t[r];n&&void 0===i||(Array.isArray(i)?e[r]=(n||[]).concat(i):(e=>e&&"object"==typeof e)(i)?e[r]=Sb({},n,i):e[r]=i)}),e),e)}const Ab=void 0!==window.ManagedMediaSource?window.ManagedMediaSource:window.MediaSource,wb=(e=!1)=>e?window.MediaSource:Ab,Ib=navigator.userAgent.toLowerCase(),Rb=["googlebot","google-inspectiontool"],Pb=["bingbot","bingpreview","yandex","slurp","facebookexternalhit","msnbot","feedly","parse.ly"],kb=["gptbot","claude-web","claudebot","perplexitybot","perplexity-user"];function Db(e){e=e.toLowerCase();const t=new RegExp(e).test(Ib);return"safari"===e?t&&new RegExp("version").test(Ib):t}function Ob(e){const t=document.createElement("div"),r=e.charAt(0).toUpperCase()+e.slice(1),n=(e+" "+["Webkit","Moz","O","ms"].join(r+" ")+r).split(" ");for(let e in n){const r=n[e];if(void 0!==t.style[r])return r}return e}const Lb=!!Db("android")&&(parseFloat(Ib.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Cb=window.devicePixelRatio||1,Mb=!(!Db("windows phone")&&!Db("iemobile"))&&(parseFloat(Ib.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),Nb=!!Db("msie")&&parseFloat(Ib.replace(/^.*msie (\d+).*$/,"$1")),xb=!!Db("trident")&&parseFloat(Ib.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,Ub=Db("ipad;")||Db("iphone;")||Db("ipod touch;")?parseFloat(Ib.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")):navigator.userAgent.includes("Mac")&&"ontouchend"in document,Fb=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)/i.test(navigator.userAgent),Vb="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,jb=Db("opera")||Db("opr"),Bb=/^Mozilla\/5\.0 \(.* Mac OS X.*\(KHTML, like Gecko\)(?: Mobile\/[\S]*|)$/i.test(Ib),Hb=(Db("safari")||Fb)&&Db("apple")&&!Db("chrome")&&!Db("android");function Xb(){if(!Db("chrome"))return[];const e=Ib.split(" ").find(function(e){return Ub?/CriOS\//.test(e):/chrome\//.test(e)});return e?e.replace("chrome/","").split(".").map(function(e){return parseInt(e,10)}):[]}function Wb(e){if(!Hb)return!1;const t=e.split("."),r=function(){if(!Db("safari"))return[];const e=Ib.split(" ").find(function(e){return/version\//.test(e)});return e?e.replace("version/","").split(".").map(function(e){return parseInt(e,10)}):[]}();for(let e=0;e<3;e++){const n=parseInt(t[e],10)||0,i=r[e]||0;if(n<i)return!0;if(n>i)return!1}return!0}const qb={autoplayPolicy:Wb("11"),hevc:Wb("11"),dolbyVision:Wb("14.1"),spatial:Wb("11.0.2"),fullscreenRequiresDataLoaded:Wb("17.2")},Gb={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:Lb,appleMail:Bb,hasAutoplayPolicy:Lb||Ub||qb.autoplayPolicy||Xb()[0]>=66,iOS:Ub,iPadOS:Vb,mobileAndroid:Lb&&Db("mobile"),browser:{bb10:Db("bb10"),chrome:Db("chrome"),firefox:Db("firefox"),ie:Nb||xb,edge:Db("edge"),opera:jb,safari:Hb,chromium:"chrome"in window&&!Db("crios"),webKit:Hb||Db("crios")},mse:Ab,devicePixelRatio:Cb,iPhone:Db("iphone;")||Db("ipod touch;")||Db("ipod;"),iPad:Db("ipad;"),iPadNonRetina:Db("ipad;")&&Cb<2,mac:Db("mac os"),navigatorConnectionDownlink:!!window.navigator.connection?.downlink,pictureInPictureSupportType:function(){if("pictureInPictureEnabled"in document)return"pip-api";const e=document.createElement("video");return!("function"!=typeof e.webkitSetPresentationMode||!e.webkitSupportsPresentationMode("picture-in-picture"))&&"webkit-presentation-mode"}(),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,passiveEvents:function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}return e}(),svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Db("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:Ob("transform"),transitionProperty:Ob("transition"),webp:function(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:Mb,mediaCapabilities:"mediaCapabilities"in navigator,webShare:"canShare"in navigator&&"share"in navigator,isGoogleBot:(()=>{const e=Ib.toLowerCase();return Rb.some(t=>e.includes(t))})(),isCrawler:(()=>{const e=Ib.toLowerCase();return Pb.some(t=>e.includes(t))})(),isLLMBot:(()=>{const e=Ib.toLowerCase();return kb.some(t=>e.includes(t))})(),storageAccessAPI:"requestStorageAccess"in document&&"hasStorageAccess"in document,clipboardAPI:"clipboard"in navigator&&"write"in navigator.clipboard,videoContentPreload:!Db("iphone"),intersectionObserver:"IntersectionObserver"in window},Kb=e=>{Gb.mse=e},Yb=/mac os x 10_13/.test(Ib),zb=Gb.iOS&&Gb.iOS>=11,$b="undefined"!=typeof matchMedia&&(matchMedia("(color-gamut: p3)").matches&&screen.pixelDepth>24||matchMedia("(dynamic-range: high), (video-dynamic-range: high)").matches);function Jb(e,t){let r=!0,n=!0;function i(){return n=r&&"visible"===document.visibilityState,n}if(!Gb.intersectionObserver)return t?.(!0),{cleanup:()=>{},isInView:!0};const s=new IntersectionObserver(e=>{const[s]=e;r=!!s?.isIntersecting,i(),t?.(n)},{threshold:.5});s.observe(e);const a=()=>{i(),t?.(n)};return document.addEventListener("visibilitychange",a),{cleanup:()=>{s.disconnect(),document.removeEventListener("visibilitychange",a)},get isInView(){return n}}}async function Qb(e){return new Promise(t=>{const{cleanup:r}=Jb(e,e=>{e&&(t(),r())})})}function Zb(){let e,t,r=new Promise((r,n)=>{e=r,t=n});return Object.assign(r,{resolve:e,reject:t}),r}function eS(e,t){if(!t||!t.length)return 0;if(1===t.length&&t.end(0)-t.start(0)<1e-6)return 0;let r=0;for(let n=t.length-1;n>=0&&t.end(n)>e;--n)r+=t.end(n)-Math.max(t.start(n),e);return r}function tS(e,t){let r=e;for(let n=0;n<t.length;n++)if(t.start(n)<=e&&t.end(n)>=e){r=t.end(n);break}return r-e}function rS(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function nS(){return Math.trunc(rS()/1e3)}function iS(e){return nS()-e}function sS(e){return rS()-e}Gb.hevc=function(e="hvc1"){return void 0!==Ab?Ab.isTypeSupported(`video/mp4; codecs="${e}"`):qb.hevc&&(Yb||zb)}("hvc1.2.4.H150.90"),Gb.hdr=$b,Gb.dolbyVision=function(){const e='video/mp4; codecs="dvh1"';let t=void 0!==Ab&&Ab.isTypeSupported(e);if(!t){const r=document.createElement("video");"canPlayType"in r&&(t="probably"===r.canPlayType(e))}return!((Vb||Gb.iOS)&&!qb.dolbyVision)&&t}(),Gb.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(Ab.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||Ab.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||Ab.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||Ab.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),Gb.av1=void 0!==Ab&&Ab.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),Gb.webvr=!(!window.navigator||!("getVRDisplays"in window.navigator)),Gb.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),Gb.spatialPlayback=!!Gb.mse,Gb.stereoscopic=Gb.spatialPlayback&&Gb.mobileAndroid,Gb.chromeHls=function(){const e=document.createElement("video"),t=Db("chrome")&&Xb()[0]>=142;return!("function"!=typeof e.canPlayType||!t||!e.canPlayType(ab.hls))}(),Gb.fullscreenRequiresDataLoaded=Gb.iOS>=17||Gb.iPadOS&&qb.fullscreenRequiresDataLoaded;const aS=e=>Math.trunc(Date.now()/1e3)-e;function oS(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^16*Math.random()>>e/4).toString(16))}function cS(e,t){this.headers={},this.perfTimings={},Sb(this,t),this.ok=2==(this.status/100|0),this.body=e,this.text=()=>Promise.resolve(e),this.json=()=>Promise.resolve(JSON.parse(e)),this.blob=()=>Promise.resolve(new Blob([e])),this.arrayBuffer=()=>Promise.resolve(e),this.clone=()=>new cS(e,this),this.isVimeoResponse=!0}class uS extends Error{constructor(){super("The operation was aborted."),this.name="AbortError"}}class lS extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}class hS extends Error{constructor(){super("A network error occurred."),this.name="NetworkError"}}class dS extends Error{constructor(e){super("Request timed out."),this.name="TimeoutError",this.timeoutMs=e}}function fS(e,t){let{url:r,method:n,body:i,onDownloadProgress:s}=e,a=100;return new Promise(function(o,c){const u=t?new t:new XMLHttpRequest,l=window.performance;u.open(n.toUpperCase(),r,e.async),e.timeout&&(u.timeout=e.timeout),u.onload=function(){if(0===u.status&&(!u.responseURL||0!==u.responseURL.indexOf("file:")))return;const e={};u.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(t,r,n)=>{e[r]=e[r]?`${e[r]},${n}`:n});let t={};if(window.performance&&void 0!==window.performance.getEntriesByType){const e=window.performance.getEntriesByType("resource");if(e.length&&e.length>=a&&("function"==typeof l.clearResourceTimings&&l.clearResourceTimings(),"function"==typeof l.setResourceTimingBufferSize&&(l.setResourceTimingBufferSize(500),a=500)),e.length){const r=e.filter(e=>e.name===u.responseURL).sort((e,t)=>e.connectStart-t.connectStart);r.length&&(t=r[r.length-1].toJSON())}}o(new cS(u.response,{headers:e,statusText:u.statusText,status:u.status,url:u.responseURL,perfTimings:t}))},u.onabort=function(){c(new uS)},u.onerror=function(){c(new hS)},u.ontimeout=function(){c(new dS(e.timeout))},"function"==typeof s&&u.addEventListener("progress",s);for(let t in e.headers)u.setRequestHeader(t,e.headers[t]);e.withCredentials&&(u.withCredentials=!0),e.responseType&&(u.responseType=e.responseType),e.abort=u.abort.bind(u),u.send(i||null)})}const pS=.3;function _S(e,t){const r=e.then.bind(e);return Object.assign(e,{abort:t,then:(...e)=>_S(r(...e),t)})}const vS=["get","post","put","patch","head","delete"],mS={json:"application/json",text:"text/plain",arrayBuffer:"*/*",blob:"*/*"},gS=["get"];function yS(e,t){t=new ES(e,t);const{method:r,json:n,jwt:i,searchParams:s}=t;async function a(){const e=t.hooks.beforeRequest||[];for(let r=0;r<e.length;r++){const n=e[r],i=await n(t);if(i instanceof ES){t=i;break}if(i?.isVimeoResponse)return Promise.resolve(i).then(TS(t))}return fS(t).then(TS(t))}n&&(t.headers["Content-Type"]=mS.json,t.body=JSON.stringify(n)),i&&(t.headers.Authorization=`jwt ${i}`),s&&(t.url=pb(t.url,s));const o=-1!==gS.indexOf(r.toLowerCase())?function(e){let t=0;return async function r(n){try{return await n()}catch(i){const s=function(r){if(!e.retryAbortErrors&&r instanceof uS)return 0;if(r instanceof dS)return 0;if(t>=e.retry)return 0;if(r instanceof lS){if(!e.retryStatus(r.response.status))return 0;const t=function(e){const t="retry-after".toLowerCase();for(const r in e)if(r.toLowerCase()===t)return e[r];return null}(r.response.headers);if(t&&e.retryStatus(r.response.status)){let e=Number(t);return isNaN(e)?e=Date.parse(t)-Date.now():e*=1e3,e}if(413===r.response.status)return 0}return pS*2**(t-1)*1e3}(i);if(t++,0!==s&&t>0){await ob(s);const a=e?.hooks?.beforeRetry||[];for(let r=0;r<a.length;r++){const n=a[r];await n(e,i,t)}return r(n)}if(e.throwHttpErrors)throw i}}}(t)(a):a();for(const e in mS)o[e]=async()=>(t.headers["Content-Type"]=mS[e],(await o).clone()[e]());return _S(o,()=>t.abort())}function ES(e,t){Sb(this,ZT,e="string"==typeof e?{url:e}:e,t)}function TS(e){const{validateStatus:t,throwHttpErrors:r,hooks:n}=e;return async i=>{const s=n.afterResponse||[];for(let t=0;t<s.length;t++){const r=s[t],n=await r(e,i.clone());n instanceof cS&&(i=n)}if(!t||t(i.status))return i;if(r)throw new lS(i);return i}}vS.forEach(function(e){return yS[e]=(t,r)=>yS(t,{method:e,...r}),yS[e]});const{get:bS,post:SS,put:AS,patch:wS,head:IS}=yS,RS={ARRAY_BUFFER:"arraybuffer"};var PS=Object.freeze({__proto__:null,ContentTypes:QT,defaults:ZT,requestMethods:vS,responseTypes:mS,retryMethods:gS,request:yS,Request:ES,get:bS,post:SS,put:AS,patch:wS,head:IS,Response:cS,ResponseTypes:RS,AbortError:uS,HTTPError:lS,NetworkError:hS,TimeoutError:dS,xhr:fS}),kS=Array.isArray,DS="object"==typeof global&&global&&global.Object===Object&&global,OS="object"==typeof self&&self&&self.Object===Object&&self,LS=DS||OS||Function("return this")(),CS=LS.Symbol,MS=Object.prototype,NS=MS.hasOwnProperty,xS=MS.toString,US=CS?CS.toStringTag:void 0,FS=Object.prototype.toString,VS=CS?CS.toStringTag:void 0;function jS(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":VS&&VS in Object(e)?function(e){var t=NS.call(e,US),r=e[US];try{e[US]=void 0;var n=!0}catch(e){}var i=xS.call(e);return n&&(t?e[US]=r:delete e[US]),i}(e):function(e){return FS.call(e)}(e)}function BS(e){return null!=e&&"object"==typeof e}function HS(e){return"symbol"==typeof e||BS(e)&&"[object Symbol]"==jS(e)}var XS=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,WS=/^\w*$/;function qS(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function GS(e){if(!qS(e))return!1;var t=jS(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var KS=LS["__core-js_shared__"],YS=function(){var e=/[^.]+$/.exec(KS&&KS.keys&&KS.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),zS=Function.prototype.toString;function $S(e){if(null!=e){try{return zS.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var JS=/^\[object .+?Constructor\]$/,QS=Function.prototype,ZS=Object.prototype,eA=QS.toString,tA=ZS.hasOwnProperty,rA=RegExp("^"+eA.call(tA).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function nA(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!qS(e)||function(e){return!!YS&&YS in e}(e))&&(GS(e)?rA:JS).test($S(e))}(r)?r:void 0}var iA=nA(Object,"create"),sA=Object.prototype.hasOwnProperty,aA=Object.prototype.hasOwnProperty;function oA(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function cA(e,t){return e===t||e!=e&&t!=t}function uA(e,t){for(var r=e.length;r--;)if(cA(e[r][0],t))return r;return-1}oA.prototype.clear=function(){this.__data__=iA?iA(null):{},this.size=0},oA.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},oA.prototype.get=function(e){var t=this.__data__;if(iA){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return sA.call(t,e)?t[e]:void 0},oA.prototype.has=function(e){var t=this.__data__;return iA?void 0!==t[e]:aA.call(t,e)},oA.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=iA&&void 0===t?"__lodash_hash_undefined__":t,this};var lA=Array.prototype.splice;function hA(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}hA.prototype.clear=function(){this.__data__=[],this.size=0},hA.prototype.delete=function(e){var t=this.__data__,r=uA(t,e);return!(r<0||(r==t.length-1?t.pop():lA.call(t,r,1),--this.size,0))},hA.prototype.get=function(e){var t=this.__data__,r=uA(t,e);return r<0?void 0:t[r][1]},hA.prototype.has=function(e){return uA(this.__data__,e)>-1},hA.prototype.set=function(e,t){var r=this.__data__,n=uA(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var dA=nA(LS,"Map");function fA(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function pA(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function _A(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(_A.Cache||pA),r}pA.prototype.clear=function(){this.size=0,this.__data__={hash:new oA,map:new(dA||hA),string:new oA}},pA.prototype.delete=function(e){var t=fA(this,e).delete(e);return this.size-=t?1:0,t},pA.prototype.get=function(e){return fA(this,e).get(e)},pA.prototype.has=function(e){return fA(this,e).has(e)},pA.prototype.set=function(e,t){var r=fA(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},_A.Cache=pA;var vA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mA=/\\(\\)?/g,gA=function(){var e=_A(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(vA,function(e,r,n,i){t.push(n?i.replace(mA,"$1"):r||e)}),t},function(e){return 500===t.size&&t.clear(),e}),t=e.cache;return e}(),yA=CS?CS.prototype:void 0,EA=yA?yA.toString:void 0;function TA(e){if("string"==typeof e)return e;if(kS(e))return function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(e,TA)+"";if(HS(e))return EA?EA.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function bA(e){return null==e?"":TA(e)}function SA(e,t){return kS(e)?e:function(e,t){if(kS(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!HS(e))||WS.test(e)||!XS.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:gA(bA(e))}function AA(e){if("string"==typeof e||HS(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function wA(e,t){for(var r=0,n=(t=SA(t,e)).length;null!=e&&r<n;)e=e[AA(t[r++])];return r&&r==n?e:void 0}function IA(e,t,r){var n=null==e?void 0:wA(e,t);return void 0===n?r:n}var RA="object"==typeof global&&global&&global.Object===Object&&global,PA="object"==typeof self&&self&&self.Object===Object&&self,kA=(RA||PA||Function("return this")()).Symbol,DA=Object.prototype,OA=DA.hasOwnProperty,LA=DA.toString,CA=kA?kA.toStringTag:void 0,MA=Object.prototype.toString,NA=kA?kA.toStringTag:void 0;var xA=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object),UA=Function.prototype,FA=Object.prototype,VA=UA.toString,jA=FA.hasOwnProperty,BA=VA.call(Object),HA=function(){var e,t=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof t?t.observable?e=t.observable:(e=t("observable"),t.observable=e):e="@@observable",e}(),XA="@@redux/INIT";function WA(e,t,r){var n;if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(WA)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,s=t,a=[],o=a,c=!1;function u(){o===a&&(o=a.slice())}function l(){return s}function h(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return u(),o.push(e),function(){if(t){t=!1,u();var r=o.indexOf(e);o.splice(r,1)}}}function d(e){if(!function(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||"[object Object]"!=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":NA&&NA in Object(e)?function(e){var t=OA.call(e,CA),r=e[CA];try{e[CA]=void 0;var n=!0}catch(e){}var i=LA.call(e);return n&&(t?e[CA]=r:delete e[CA]),i}(e):function(e){return MA.call(e)}(e)}(e))return!1;var t=xA(e);if(null===t)return!0;var r=jA.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&VA.call(r)==BA}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,s=i(s,e)}finally{c=!1}for(var t=a=o,r=0;r<t.length;r++)(0,t[r])();return e}return d({type:XA}),(n={dispatch:d,subscribe:h,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,d({type:XA})}})[HA]=function(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(l())}return r(),{unsubscribe:t(r)}}})[HA]=function(){return this},e},n}function qA(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var GA=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function KA(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(r,n,i){var s,a=e(r,n,i),o=a.dispatch,c={getState:a.getState,dispatch:function(e){return o(e)}};return s=t.map(function(e){return e(c)}),o=qA.apply(void 0,s)(a.dispatch),GA({},a,{dispatch:o})}}}function YA(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function zA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $A(e,t){return e.get(YA(e,t))}function JA(e,t,r){zA(e,t),t.set(e,r)}function QA(e,t,r){return e.set(YA(e,t),r),r}function ZA(e,t){zA(e,t),t.add(e)}function ew(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tw=new WeakMap,rw=new WeakMap;class nw{constructor(){JA(this,tw,Object.create(null)),JA(this,rw,void 0),ew(this,"eventNames",()=>Object.keys($A(tw,this))),ew(this,"fire",(e,...t)=>{if(!e)throw new Error("Tried to fire an undefined event.");if(e in $A(tw,this)){const r=$A(tw,this)[e].slice(0);for(let e=0,n=r.length;e<n;e++)if(r[e].apply(this,t),$A(rw,this)){QA(rw,this,!1);break}}return this}),ew(this,"halt",()=>(QA(rw,this,!0),this)),ew(this,"on",(e,t,r)=>{const n=[].concat(e);for(let e=0,i=n.length;e<i;e++){const i=n[e];if(!i)throw new Error("Tried to listen for an undefined event.");$A(tw,this)[i]||($A(tw,this)[i]=[]),r?$A(tw,this)[i].unshift(t):$A(tw,this)[i].push(t)}return this}),ew(this,"once",(e,t,r)=>{const n=(...r)=>{this.off(e,n),t.apply(this,r)};return n.handler=t,this.on(e,n,r)}),ew(this,"off",(e,t)=>{if(!e)return QA(tw,this,Object.create(null)),this;const r=[].concat(e);for(let e=0,n=r.length;e<n;e++){const n=r[e];if(!n)throw new Error("Tried to remove an undefined event.");if(n in $A(tw,this)){const e=$A(tw,this)[n];if(t){let r=e.indexOf(t);if(-1===r)for(let n=0,i=e.length;n<i;n++)if(e[n].handler===t){r=n;break}if(-1===r)return this;e.splice(r,1),0===e.length&&delete $A(tw,this)[n]}else delete $A(tw,this)[n]}}return this}),ew(this,"prependOn",(e,t)=>this.on(e,t,!0))}static extend(e){return Object.assign(e,new nw),e}}function iw(e){var t=this.__data__=new hA(e);this.size=t.size}iw.prototype.clear=function(){this.__data__=new hA,this.size=0},iw.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},iw.prototype.get=function(e){return this.__data__.get(e)},iw.prototype.has=function(e){return this.__data__.has(e)},iw.prototype.set=function(e,t){var r=this.__data__;if(r instanceof hA){var n=r.__data__;if(!dA||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new pA(n)}return r.set(e,t),this.size=r.size,this};var sw=function(){try{var e=nA(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();function aw(e,t,r){"__proto__"==t&&sw?sw(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var ow=Object.prototype.hasOwnProperty;function cw(e,t,r){var n=e[t];ow.call(e,t)&&cA(n,r)&&(void 0!==r||t in e)||aw(e,t,r)}function uw(e,t,r,n){var i=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],c=n?n(r[o],e[o],o,r,e):void 0;void 0===c&&(c=e[o]),i?aw(r,o,c):cw(r,o,c)}return r}function lw(e){return BS(e)&&"[object Arguments]"==jS(e)}var hw=Object.prototype,dw=hw.hasOwnProperty,fw=hw.propertyIsEnumerable,pw=lw(function(){return arguments}())?lw:function(e){return BS(e)&&dw.call(e,"callee")&&!fw.call(e,"callee")},_w="object"==typeof exports&&exports&&!exports.nodeType&&exports,vw=_w&&"object"==typeof module&&module&&!module.nodeType&&module,mw=vw&&vw.exports===_w?LS.Buffer:void 0,gw=(mw?mw.isBuffer:void 0)||function(){return!1},yw=/^(?:0|[1-9]\d*)$/;function Ew(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&yw.test(e))&&e>-1&&e%1==0&&e<t}function Tw(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}var bw={};function Sw(e){return function(t){return e(t)}}bw["[object Float32Array]"]=bw["[object Float64Array]"]=bw["[object Int8Array]"]=bw["[object Int16Array]"]=bw["[object Int32Array]"]=bw["[object Uint8Array]"]=bw["[object Uint8ClampedArray]"]=bw["[object Uint16Array]"]=bw["[object Uint32Array]"]=!0,bw["[object Arguments]"]=bw["[object Array]"]=bw["[object ArrayBuffer]"]=bw["[object Boolean]"]=bw["[object DataView]"]=bw["[object Date]"]=bw["[object Error]"]=bw["[object Function]"]=bw["[object Map]"]=bw["[object Number]"]=bw["[object Object]"]=bw["[object RegExp]"]=bw["[object Set]"]=bw["[object String]"]=bw["[object WeakMap]"]=!1;var Aw="object"==typeof exports&&exports&&!exports.nodeType&&exports,ww=Aw&&"object"==typeof module&&module&&!module.nodeType&&module,Iw=ww&&ww.exports===Aw&&DS.process,Rw=function(){try{return ww&&ww.require&&ww.require("util").types||Iw&&Iw.binding&&Iw.binding("util")}catch(e){}}(),Pw=Rw&&Rw.isTypedArray,kw=Pw?Sw(Pw):function(e){return BS(e)&&Tw(e.length)&&!!bw[jS(e)]},Dw=Object.prototype.hasOwnProperty;function Ow(e,t){var r=kS(e),n=!r&&pw(e),i=!r&&!n&&gw(e),s=!r&&!n&&!i&&kw(e),a=r||n||i||s,o=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=o.length;for(var u in e)!t&&!Dw.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ew(u,c))||o.push(u);return o}var Lw=Object.prototype;function Cw(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Lw)}function Mw(e,t){return function(r){return e(t(r))}}var Nw=Mw(Object.keys,Object),xw=Object.prototype.hasOwnProperty;function Uw(e){if(!Cw(e))return Nw(e);var t=[];for(var r in Object(e))xw.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Fw(e){return null!=e&&Tw(e.length)&&!GS(e)}function Vw(e){return Fw(e)?Ow(e):Uw(e)}var jw=Object.prototype.hasOwnProperty;function Bw(e){return Fw(e)?Ow(e,!0):function(e){if(!qS(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=Cw(e),r=[];for(var n in e)("constructor"!=n||!t&&jw.call(e,n))&&r.push(n);return r}(e)}var Hw="object"==typeof exports&&exports&&!exports.nodeType&&exports,Xw=Hw&&"object"==typeof module&&module&&!module.nodeType&&module,Ww=Xw&&Xw.exports===Hw?LS.Buffer:void 0,qw=Ww?Ww.allocUnsafe:void 0;function Gw(e,t){if(t)return e.slice();var r=e.length,n=qw?qw(r):new e.constructor(r);return e.copy(n),n}function Kw(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function Yw(){return[]}var zw=Object.prototype.propertyIsEnumerable,$w=Object.getOwnPropertySymbols,Jw=$w?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var a=e[r];t(a)&&(s[i++]=a)}return s}($w(e),function(t){return zw.call(e,t)}))}:Yw;function Qw(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var Zw=Mw(Object.getPrototypeOf,Object),eI=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Qw(t,Jw(e)),e=Zw(e);return t}:Yw;function tI(e,t,r){var n=t(e);return kS(e)?n:Qw(n,r(e))}function rI(e){return tI(e,Vw,Jw)}function nI(e){return tI(e,Bw,eI)}var iI=nA(LS,"DataView"),sI=nA(LS,"Promise"),aI=nA(LS,"Set"),oI=nA(LS,"WeakMap"),cI="[object Map]",uI="[object Promise]",lI="[object Set]",hI="[object WeakMap]",dI="[object DataView]",fI=$S(iI),pI=$S(dA),_I=$S(sI),vI=$S(aI),mI=$S(oI),gI=jS;(iI&&gI(new iI(new ArrayBuffer(1)))!=dI||dA&&gI(new dA)!=cI||sI&&gI(sI.resolve())!=uI||aI&&gI(new aI)!=lI||oI&&gI(new oI)!=hI)&&(gI=function(e){var t=jS(e),r="[object Object]"==t?e.constructor:void 0,n=r?$S(r):"";if(n)switch(n){case fI:return dI;case pI:return cI;case _I:return uI;case vI:return lI;case mI:return hI}return t});var yI=gI,EI=Object.prototype.hasOwnProperty,TI=LS.Uint8Array;function bI(e){var t=new e.constructor(e.byteLength);return new TI(t).set(new TI(e)),t}var SI=/\w*$/,AI=CS?CS.prototype:void 0,wI=AI?AI.valueOf:void 0;function II(e,t){var r=t?bI(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var RI=Object.create,PI=function(){function e(){}return function(t){if(!qS(t))return{};if(RI)return RI(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function kI(e){return"function"!=typeof e.constructor||Cw(e)?{}:PI(Zw(e))}var DI=Rw&&Rw.isMap,OI=DI?Sw(DI):function(e){return BS(e)&&"[object Map]"==yI(e)},LI=Rw&&Rw.isSet,CI=LI?Sw(LI):function(e){return BS(e)&&"[object Set]"==yI(e)},MI="[object Arguments]",NI="[object Function]",xI="[object Object]",UI={};function FI(e,t,r,n,i,s){var a,o=1&t,c=2&t,u=4&t;if(r&&(a=i?r(e,n,i,s):r(e)),void 0!==a)return a;if(!qS(e))return e;var l=kS(e);if(l){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&EI.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!o)return Kw(e,a)}else{var h=yI(e),d=h==NI||"[object GeneratorFunction]"==h;if(gw(e))return Gw(e,o);if(h==xI||h==MI||d&&!i){if(a=c||d?{}:kI(e),!o)return c?function(e,t){return uw(e,eI(e),t)}(e,function(e,t){return e&&uw(t,Bw(t),e)}(a,e)):function(e,t){return uw(e,Jw(e),t)}(e,function(e,t){return e&&uw(t,Vw(t),e)}(a,e))}else{if(!UI[h])return i?e:{};a=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return bI(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return function(e,t){var r=t?bI(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return II(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,SI.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return function(e){return wI?Object(wI.call(e)):{}}(e)}}(e,h,o)}}s||(s=new iw);var f=s.get(e);if(f)return f;s.set(e,a),CI(e)?e.forEach(function(n){a.add(FI(n,t,r,n,e,s))}):OI(e)&&e.forEach(function(n,i){a.set(i,FI(n,t,r,i,e,s))});var p=l?void 0:(u?c?nI:rI:c?Bw:Vw)(e);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r););}(p||e,function(n,i){p&&(n=e[i=n]),cw(a,i,FI(n,t,r,i,e,s))}),a}function VI(e){return FI(e,5)}function jI(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function BI(e){return e}UI[MI]=UI["[object Array]"]=UI["[object ArrayBuffer]"]=UI["[object DataView]"]=UI["[object Boolean]"]=UI["[object Date]"]=UI["[object Float32Array]"]=UI["[object Float64Array]"]=UI["[object Int8Array]"]=UI["[object Int16Array]"]=UI["[object Int32Array]"]=UI["[object Map]"]=UI["[object Number]"]=UI[xI]=UI["[object RegExp]"]=UI["[object Set]"]=UI["[object String]"]=UI["[object Symbol]"]=UI["[object Uint8Array]"]=UI["[object Uint8ClampedArray]"]=UI["[object Uint16Array]"]=UI["[object Uint32Array]"]=!0,UI["[object Error]"]=UI[NI]=UI["[object WeakMap]"]=!1;var HI=Math.max;function XI(e,t,r){return t=HI(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=HI(n.length-t,0),a=Array(s);++i<s;)a[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=r(a),jI(e,this,o)}}function WI(e){return function(){return e}}var qI=sw?function(e,t){return sw(e,"toString",{configurable:!0,enumerable:!1,value:WI(t),writable:!0})}:BI,GI=Date.now,KI=function(e){var t=0,r=0;return function(){var n=GI(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(qI);function YI(e,t){return KI(XI(e,t,BI),e+"")}function zI(e,t,r){(void 0!==r&&!cA(e[t],r)||void 0===r&&!(t in e))&&aw(e,t,r)}var $I=function(e,t,r){for(var n=-1,i=Object(e),s=r(e),a=s.length;a--;){var o=s[++n];if(!1===t(i[o],o,i))break}return e},JI=Function.prototype,QI=Object.prototype,ZI=JI.toString,eR=QI.hasOwnProperty,tR=ZI.call(Object);function rR(e){if(!BS(e)||"[object Object]"!=jS(e))return!1;var t=Zw(e);if(null===t)return!0;var r=eR.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&ZI.call(r)==tR}function nR(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function iR(e,t,r,n,i){e!==t&&$I(t,function(s,a){if(i||(i=new iw),qS(s))!function(e,t,r,n,i,s,a){var o=nR(e,r),c=nR(t,r),u=a.get(c);if(u)zI(e,r,u);else{var l=s?s(o,c,r+"",e,t,a):void 0,h=void 0===l;if(h){var d=kS(c),f=!d&&gw(c),p=!d&&!f&&kw(c);l=c,d||f||p?kS(o)?l=o:function(e){return BS(e)&&Fw(e)}(o)?l=Kw(o):f?(h=!1,l=Gw(c,!0)):p?(h=!1,l=II(c,!0)):l=[]:rR(c)||pw(c)?(l=o,pw(o)?l=function(e){return uw(e,Bw(e))}(o):qS(o)&&!GS(o)||(l=kI(c))):h=!1}h&&(a.set(c,l),i(l,c,n,s,a),a.delete(c)),zI(e,r,l)}}(e,t,a,r,iR,n,i);else{var o=n?n(nR(e,a),s,a+"",e,t,i):void 0;void 0===o&&(o=s),zI(e,a,o)}},Bw)}function sR(e,t,r,n,i,s){return qS(e)&&qS(t)&&(s.set(t,e),iR(e,t,void 0,sR,s),s.delete(t)),e}function aR(e){return YI(function(t,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,a&&function(e,t,r){if(!qS(r))return!1;var n=typeof t;return!!("number"==n?Fw(r)&&Ew(t,r.length):"string"==n&&t in r)&&cA(r[t],e)}(r[0],r[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++n<i;){var o=r[n];o&&e(t,o,n,s)}return t})}var oR=aR(function(e,t,r,n){iR(e,t,r,n)}),cR=YI(function(e){return e.push(void 0,sR),jI(oR,void 0,e)});class uR extends nw{static get displayName(){return"ExternalDisplay"}static get supported(){return!1}static get supportedVideoTypes(){return[]}constructor(e){super(),this._available=!1,this._active=!1,this._video=e}get active(){return this._active}get available(){return this._available}get element(){return document.createElement("div")}showPicker(){}getFile(){const e=this.constructor.displayName.replace("ExternalDisplay","");if(this._video.externalDisplayFiles?.[e])return this._video.externalDisplayFiles[e];const t=this.constructor.supportedVideoTypes,r=this._video.files.filter(e=>-1!==t.indexOf(e.mime)).sort((e,r)=>e.mime===r.mime?e.priority-r.priority:t.indexOf(e.mime)-t.indexOf(r.mime));if(!r.length)throw new Error(`No files available for ${this.constructor.displayName} external display.`);return r[0]}}const lR={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",RESIZE:"resize",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},hR={ADD_TRACK:"addtrack",REMOVE_TRACK:"removetrack",CHANGE:"change"},dR={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},fR={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},pR={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_START:"downloadstart",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DOWNLOAD_TIMEOUT:"downloadtimeout",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_CDM_CHANGE:"drmcdmchange",DRM_FAILURE:"drmfailure",DRM_KEY_SWITCH:"drmkeyswitch",DRM_OUTPUT_RESTRICTED:"drmoutputrestricted",EME_UNSUPPORTED:"emeunsupported",NO_SUPPORTED_CDM:"nosupportedcdm",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",MEDIA_URL_BAD_REQUEST:"mediaurlbadrequest",STREAM_CHANGE:"streamchange",STREAM_CHANGE_START:"streamchangestart",STREAM_UPDATED:"streamupdated",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",AVAILABLE_STREAMS_CHANGED:"availablestreamschanged",MEDIA_CAPABILITY_STREAMS_UNSUPPORTED:"mediacapabilitystreamsunsupported",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",STREAMS_LOADED:"streamsloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",TEXT_TRACKS_AVAILABLE:"texttracksavailable",AV_DURATION_MISMATCH:"avdurationmismatch",BUFFER_STARTED:"bufferstarted",BUFFER_ENDED:"bufferended",QUOTA_EXCEEDED_ERROR:"quotaexceedederror",CHAPTER_CUES_UPDATED:"chaptercuesupdated",APPEND_BUFFER_END:"appendbufferend",DROPPED_FRAME_PERCENT_EXCEEDED:"droppedframepercentexceeded",LOAD_SEGMENT_FAILED:"loadsegmentfailed",AUDIO_TRACK_CHANGED:"audiotrackchanged",SEGMENT_CUES_LOADED:"segmentcuesloaded",HLS_JS_ERROR:"hlsjserror"},_R={STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",STREAM_ENDED:"livestreamended",BUFFER_GAP_JUMP:"livebuffergapjump",BUFFER_GAP_JUMP_PREVENT:"livebuffergapjumpprevent",STALL_JUMP:"livestalljump",LATENCY_UPDATED:"latencyupdated"},vR={CAMERA_UPDATE:"cameraupdate",CAMERA_CHANGE:"camerachange",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported",WEBVR_ENTER:"entervr",WEBVR_EXIT:"exitvr",WEBVR_HARDWARE_AVAILABLE:"webvrhardwareavailable",AMBISONIC_UNSUPPORTED:"ambisonicunsupported"},mR={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_TO:"mediasessionseekto",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},gR=Object.assign({},lR,hR,dR,fR,pR,vR,_R,mR),yR="webkitplaybacktargetavailabilitychanged",ER="webkitcurrentplaybacktargetiswirelesschanged";class AirPlayExternalDisplay extends uR{static get displayName(){return"AirPlayExternalDisplay"}static get supported(){return"WebKitPlaybackTargetAvailabilityEvent"in window}static get supportedVideoTypes(){return[ab.hls,ab.h264]}constructor(e){super(e),this._listenerLoadedMetadata=null,this._listenerAvailability=null,this._listenerTarget=null,this._videoElement=document.createElement("video"),this.createEventListeners(),this.addVideoEventListeners()}createEventListeners(){this._listenerLoadedMetadata=e=>{this.fire(lR.LOADED_METADATA,e)},this._listenerAvailability=e=>{switch(e.availability){case"available":this._available||(this._available=!0,this.fire(fR.AIRPLAY_AVAILABLE));break;case"not-available":this._available&&(this._available=!1,this.fire(fR.AIRPLAY_UNAVAILABLE))}},this._listenerTarget=e=>{this._active=!!e.target.webkitCurrentPlaybackTargetIsWireless,this._active&&this._videoElement.play(),this.fire(this._active?fR.AIRPLAY_ACTIVATED:fR.AIRPLAY_DEACTIVATED)}}addVideoEventListeners(e=this._videoElement){e.addEventListener(lR.LOADED_METADATA,this._listenerLoadedMetadata),e.addEventListener(yR,this._listenerAvailability),e.addEventListener(ER,this._listenerTarget)}removeVideoEventListeners(e=this._videoElement){e.removeEventListener(lR.LOADED_METADATA,this._listenerLoadedMetadata),e.removeEventListener(yR,this._listenerAvailability),e.removeEventListener(ER,this._listenerTarget)}get element(){return this._videoElement}set element(e){if(!(e instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");e!==this._videoElement&&(this.removeVideoEventListeners(this._videoElement),this._videoElement=e,this.addVideoEventListeners(e))}showPicker(){this._videoElement.webkitShowPlaybackTargetPicker(),this.loadMetadata().then(()=>this._videoElement.webkitShowPlaybackTargetPicker()).catch(e=>{})}async loadMetadata(){return this._videoElement.readyState>=1?Promise.resolve():new Promise(async(e,t)=>{this._videoElement.addEventListener(lR.LOADED_METADATA,()=>{e()},{once:!0});try{let{src:e,mime:t}=this.getFile();const r=document.createElement("source");r.type=t,r.src=await mb(e),this._videoElement.appendChild(r),this._videoElement.load()}catch(e){t(e)}})}}const TR=(()=>{const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);return!!e&&{major:parseInt(e[1],10),minor:parseInt(e[2],10)}})(),bR=function(e){for(let t=0,r=this.length;t<r;t++)if(this[t].id===`${e}`)return this[t];return null};function SR(e=[]){return e.item=function(e){return this[e]},e.getTrackById=bR,e}function AR(e){const t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return n}function wR(e,t,r,n){let i=0,s=0,a=0,o=0;const c=e,u=t,l=r/n;return c/u>=l?(s=u,i=(l*u).toFixed(2)):(i=c,s=(c/l).toFixed(2)),a=Math.max((c-i)/2,0),o=Math.max((u-s)/2,0),{width:i,height:s,left:a,top:o}}function IR(e,t){let r=e;return t&&(r+=`;codecs="${t}"`),r}function RR(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;const r=Math.pow(10,t);return Math.round(e*r)/r}function PR(e,t){return e&&e.tests&&e.tests[t]?e.tests[t]:null}const kR="telecine-snapshot",DR=`[${kR}]`,OR=(e,t)=>{let r=t.querySelector(DR);r||(r=document.createElement("canvas"),r.setAttribute(kR,""),t.appendChild(r)),r.setAttribute("width",`${t.clientWidth}px`),r.setAttribute("height",`${t.clientHeight}px`),r.style.display="";const{width:n,height:i,left:s,top:a}=wR(e.clientWidth,e.clientHeight,e.videoWidth,e.videoHeight);r.style.cssText=`position:absolute;width:${n}px;height:${i}px;left:${s}px;top:${a}px`;const o=r.getContext("2d");r.width>0&&r.height>0&&o.drawImage(e,0,0,r.width,r.height)},LR=e=>{const t=e.querySelector(DR);t&&(t.style.display="none")};class TelecineError{constructor(e,t){this.name=e,this.message=t,Object.freeze(this)}}const CR=new WeakMap;class MR{static fromVTTCue(e){if(CR.has(e))return CR.get(e);let t={};try{t=JSON.parse(e.text)}catch(e){}return new MR(e.startTime,t)}constructor(e,t={}){const r=parseFloat(e);if(isNaN(r))throw new TypeError("Time must be a number.");if(r<0)throw new TypeError("Time must be a positive number.");this.time=e,this.data=t,this.id=oS();try{const r="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new r(e,e+.25,JSON.stringify(t)),this.vttCue.id=this.id}catch(e){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this browser.")}CR.set(this.vttCue,this),Object.freeze(this)}}function NR(e,t,r){let n;try{document.removeChild({})}catch(i){n=Object.create(Object.getPrototypeOf(i),{name:{value:t,configurable:!0,writable:!0},code:{value:e,configurable:!0,writable:!0},message:{value:r,configurable:!0,writable:!0},toString:{value:()=>`${t}: DOM Exception ${e}`,configurable:!0,writable:!0}})}return Object.freeze(n)}const xR=(e,t)=>{if(!e||void 0===e[t])throw NR(1,"INDEX_SIZE_ERR");return e[t]};function UR(e=[],t=[]){return Object.freeze({get length(){return e.length},start:t=>xR(e,t),end:e=>xR(t,e),[Symbol.iterator]:()=>function(e,t){let r=0;return{[Symbol.iterator](){return this},next:()=>r<e.length?{done:!1,value:t?[e[r],t[r++]]:e[r++]}:{done:!0}}}(e,t)})}UR.from=function(e){if(!(e instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");const t=[],r=[];for(let n=0,i=e.length;n<i;n++)t.push(e.start(n)),r.push(e.end(n));return UR(t,r)};const FR="DRMFailure",VR="MediaUnknownError",jR="MediaUrlBadRequest",BR="PlayInterrupted",HR="TextTracksNotSupported",XR="NoSupportedCDM",WR="inline",qR="picture-in-picture",GR=document.createElement("video"),KR={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},YR=function(){const e="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in e?e.DISABLED:"disabled",hidden:"HIDDEN"in e?e.HIDDEN:"hidden",showing:"SHOWING"in e?e.SHOWING:"showing"}}(),zR=function(){const e=document.createElement("track");return"track"in e&&"oncuechange"in e.track}(),$R=new WeakMap;class JR extends nw{static get displayName(){return"HTMLScanner"}static get supportsMse(){return!1}static get supportsLive(){return!1}static supported(){return JR.supportedVideoTypes.length>0}static get supportedVideoTypes(){const e=[];if("function"!=typeof GR.canPlayType)return e;for(const t in KR){const r=KR[t];Gb.android&&t===ab.hls||(Gb.android&&!Gb.mobileAndroid&&t===ab.h264&&Gb.android instanceof String?parseInt(Gb.android.split(".")[0],10)>3&&e.push(t):t===ab.hls&&Gb.browser.chrome&&!Gb.chromeHls||GR.canPlayType(r).replace(/^no$/,"")&&e.push(t))}return e}static get supportedAudioTypes(){return[]}static get supportedExternalDisplays(){return[AirPlayExternalDisplay]}static get supportsAudioTracksFromScanner(){return void 0!==GR.audioTracks&&this.supportedVideoTypes.includes(ab.hls)}constructor(e,t={}){super(),this._element=e,this._options=t,this._telecineVideo=null,this._currentFile=null,this._externalDisplays=[];let r=e.querySelector("video");r||(r=document.createElement("video"),r.preload="none",this._element.appendChild(r)),r.setAttribute("tabindex","-1"),this._video=r,t.playRequest&&(this._playRequest=t.playRequest,this._playRequest.video=r),t.htmlScanner&&t.htmlScanner.controls&&(this._video.controls=!0);const n=PR(t,"cross_origin_texttracks");"variant"===n?.group&&this._video.setAttribute("crossOrigin","anonymous"),this._boundHandleVideoEvent=this.handleVideoEvent.bind(this),this._boundHandleAudioEvent=this.handleAudioEvent.bind(this),this.addVideoEventListeners(),this.addAudioEventListeners(),this._preload="none",this._externalDisplayActivated=!1,this._inFullscreen=!1,this._lastCurrentTime=-1,this._switchingVideo=!1,this._resetInViewTracking()}deactivate(){this._telecineVideo&&(this._telecineVideo.off(pR.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeVideoEventListeners(),this.removeAudioEventListeners(),this._switchingVideo||this.removeSnapshot(),this._video.style.display="none",this._cleanUpInViewTracking()}reactivate(){this.addVideoEventListeners(),this.addAudioEventListeners(),this._video.style.display="",this._resetInViewTracking()}addVideoEventListeners(e=this._video){Object.keys(lR).forEach(t=>{const r=lR[t];e.addEventListener(r,this._boundHandleVideoEvent)})}addAudioEventListeners(e=this._video){e?.audioTracks&&"function"==typeof e.audioTracks?.addEventListener&&(e.audioTracks.addEventListener(hR.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(hR.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(hR.CHANGE,this._boundHandleAudioEvent))}removeVideoEventListeners(e=this._video){Object.keys(lR).forEach(t=>{const r=lR[t];e.removeEventListener(r,this._boundHandleVideoEvent)})}removeAudioEventListeners(e=this._video){e?.audioTracks&&"function"==typeof e.audioTracks?.removeEventListener&&(e.audioTracks.removeEventListener(hR.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(hR.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(hR.CHANGE,this._boundHandleAudioEvent))}play(e){return this._playRequest.start(e).catch(e=>{if("sd-fallback"!==this._telecineVideo.drmHandler?.state||"AbortError"!==e.name)throw this._onPlayError(e),e})}_onPlayError(e){this.fire(lR.ERROR,new TelecineError(e?.name,e?.message))}pause(){this._playRequest.cancel(),this._video.pause()}onpause(){}ontimeupdate(){this._lastCurrentTime=this.currentTime}addTextTrack(e){let t,r;return e.src?(t=document.createElement("track"),t.kind=e.kind,t.src=e.src,t.id=`telecine-track-${e.id}`,t.srclang=e.language,t.label=e.label,this._video.appendChild(t),r=t.track):(r=this._video.addTextTrack(e.kind,e.label,e.language),this._textTracks=this._textTracks||{},this._textTracks[`telecine-track-${e.id}`]=r),this._addTextTrackListeners(e,r,t),r}_addTextTrackListeners(e,t,r){t.addEventListener("cuechange",()=>e.dispatchEvent("cuechange")),this._video.addEventListener(lR.TIME_UPDATE,()=>{ub(this._video)&&(e.mode=t.mode)});const n=()=>{const r=Gb.iOS&&ub(this._video);!e._modeHasBeenSet||r?e.mode=t.mode:t.mode=YR[e.mode]},i=[];if(r?r.addEventListener("load",n):n(),[lR.LOADED_DATA,lR.SEEKING].forEach(e=>{this._video.addEventListener(e,n),i.push([e,n])}),e._modeHasBeenSet&&(t.mode=YR[e.mode]),!zR){let r=[];const n=()=>{if(t&&"disabled"!==YR[t.mode]){if(r.length!==t.activeCues.length)return e.dispatchEvent("cuechange"),void(r=Array.from(t.activeCues));for(let n=0,i=t.activeCues.length;n<i;n++)if(t.activeCues[n].startTime!==r[n].startTime)return e.dispatchEvent("cuechange"),void(r=Array.from(e.activeCues))}};this._video.addEventListener(lR.TIME_UPDATE,n),i.push([lR.TIME_UPDATE,n])}return $R.set(e,i),t}removeTextTrack(e){const t=this._video.querySelector(`#telecine-track-${e.id}`);t&&this._video.removeChild(t);const r=$R.get(e);Array.isArray(r)&&r.forEach(([e,t])=>{this._video.removeEventListener(e,t)})}getCuesForTrack(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t?Array.from(t.cues):[]}getActiveCuesForTrack(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t&&t.activeCues?Array.from(t.activeCues):[]}setModeForTrack(e,t){const r=this.getTrackById(`telecine-track-${e.id}`);return r&&r.mode!==YR[t]&&(r.mode=YR[t],zR||"disabled"===t||e.dispatchEvent("cuechange")),this}setSrcForTrack(e,t){const r=this._video.querySelector(`#telecine-track-${e.id}`);return r&&null===r.track.cues&&(r.src=t),this}get audioTracks(){return this._video.audioTracks}enableAudioTrack(e){if(!this.constructor.supportsAudioTracksFromScanner||!this.audioTracks)return null;if(!e)return null;if(!this.audioTracks.getTrackById(e))return null;let t=null;for(let r=0;r<this.audioTracks.length;r++){const n=this.audioTracks[r].id===e;this.audioTracks[r].enabled=n,n&&(t=this.audioTracks[r])}return t}get chaptersTrack(){return this._chaptersTrack}_createChapterCue(e,t,r=null){let n;this._chaptersTrack||(this._chaptersTrack=this._video.addTextTrack("chapters"),this._chaptersTrack.mode="hidden");const i=e.timecode,s=r?r.timecode:t,a=window.VTTCue||window.TextTrackCue;try{n=new a(i,s,e.title)}catch(e){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}n.size=(s-i)/t,n.id=i,this._chaptersTrack.addCue(n)}addChapter(e,t){const r=this.video.chapters,n={timecode:e,title:t};r.push(n),r.sort((e,t)=>e.timecode-t.timecode);const i=r[r.indexOf(n)+1];this._createChapterCue(n,this.video.duration,i),this._updateChapterCues(this._chaptersTrack,this.video.duration)}removeChapter(e){try{this._chaptersTrack.removeCue(e)}catch(e){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}const t=this.video.chapters.find(t=>t.timecode===e.timecode);this.video.chapters.splice(t,1),this._updateChapterCues(this._chaptersTrack,this.video.duration)}_updateChapterCues(e,t){for(let r=0;r<e.cues.length;r++){let n=e.cues[r],i=e.cues[r+1];const s=i?i.startTime:t;n.endTime=s,n.size=(s-n.startTime)/t}this.fire(pR.CHAPTER_CUES_UPDATED)}addChapters(e,t){0!==e.length&&t&&(e=e.filter(e=>this._isValidChapter(e,t))).sort((e,t)=>e.timecode-t.timecode).forEach((r,n)=>this._createChapterCue(r,t,e[n+1]))}addCuePoint(e,t={}){if(this._cuePointTrack||(this._cuePointTrack=this._video.addTextTrack("metadata"),this._cuePointTrack.mode="hidden",this._cuePointTrack.addEventListener("cuechange",e=>{Array.from(e.target.activeCues).forEach(e=>{this.fire(pR.CUE_POINT,MR.fromVTTCue(e))})}),this._video.addEventListener(lR.CAN_PLAY,e=>{this._cuePointTrack.mode="hidden"})),e=parseFloat(e),isNaN(e))throw new TypeError("Time must be a number.");if(e<0||e>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");const r=new MR(e,t);return this._cuePointTrack.addCue(r.vttCue),r}removeCuePoint(e){if(!e)throw new TelecineError("InvalidCuePoint","The specified cue point is not valid.");return this._cuePointTrack.removeCue(e.vttCue),!0}removeAllCuePoints(){return this._cuePointTrack&&this._cuePointTrack.length&&Array.from(this._cuePointTrack.cues).forEach(e=>{this._cuePointTrack.removeCue(e)}),!0}get manifest(){return this._manifest}get manifestLoaded(){return!!this._manifest}get buffered(){return UR.from(this._video.buffered)}get cuePoints(){return this._cuePointTrack?.cues&&"function"==typeof this._cuePointTrack?.cues[Symbol.iterator]?Array.from(this._cuePointTrack.cues).map(e=>MR.fromVTTCue(e)):[]}get currentFile(){return this._currentFile}set currentFile(e){const t=!this._video.paused,r=this.currentTime,n=!this._currentFile||e.video.id!==this._currentFile.video.id;if(n||this.takeSnapshot(),this._currentFile=e,n&&(this._video.preload=this._preload),this.constructor===JR&&this._video.readyState>0&&(this._video.currentTime=0),(Gb.iOS||Gb.android)&&this._currentFile.video.title){let e=this._currentFile.video.title;this._currentFile.video.subtitle&&(e=`${e} ${this._currentFile.video.subtitle}`),this._video.setAttribute("title",e)}else this._video.removeAttribute("title");this.setVideoSrc(this._currentFile.src,n),this.fire(pR.CURRENT_FILE_CHANGE,e),Gb.iOS&&!n&&this.play().catch(this._onPlayError.bind(this)),this.constructor!==JR||n?t&&this.play().catch(this._onPlayError.bind(this)):(this.seekToTime(r).then(e=>(t&&this.play().catch(this._onPlayError.bind(this)),e)).catch(()=>{}),this.once(lR.CAN_PLAY,()=>this.removeSnapshot()),this.once(lR.PLAYING,()=>this.removeSnapshot()))}get currentTime(){return this._video.currentTime}set currentTime(e){this.seekToTime(e)}get disableRemotePlayback(){return this._video.disableRemotePlayback}set disableRemotePlayback(e){this._video.disableRemotePlayback=e,e?this._video.setAttribute("disableRemotePlayback",""):this._video.removeAttribute("disableRemotePlayback")}get duration(){return this._video.duration}get ended(){return this._video.ended}get externalDisplayAvailable(){return this._externalDisplays.some(e=>e.available)}get externalDisplayActive(){return this._externalDisplays.some(e=>e.active)}get loop(){return this._video.loop}set loop(e){this._video.loop=e}get isLowerProfileAvailable(){return null}get muted(){return this._video.muted}set muted(e){this._video.muted=e}get playsinline(){return this._video.playsinline}set playsinline(e){this._video.playsinline=e,e?this._video.setAttribute("playsinline",""):this._video.removeAttribute("playsinline")}get paused(){return this._video.paused}get defaultPlaybackRate(){return this._video.defaultPlaybackRate}set defaultPlaybackRate(e){this._video.defaultPlaybackRate=e}get playbackRate(){return this._video.playbackRate}set playbackRate(e){this._video.playbackRate=e}get played(){return this._video.played}get seekable(){return this._video.seekable}get seeking(){return this._video.seeking}get preload(){return this._preload}set preload(e){this._video.preload=e,this._preload=e}get autoPictureInPicture(){return this._video.autoPictureInPicture}set autoPictureInPicture(e){this._video.autoPictureInPicture=e}get disablePictureInPicture(){return this._video.disablePictureInPicture}set disablePictureInPicture(e){this._video.disablePictureInPicture=e}get pictureInPictureActive(){return this._video.webkitPresentationMode===qR||!!document.pictureInPictureElement}get isPlayRequestActive(){return this._playRequest?.active??!1}async requestPictureInPicture(){switch(this._video.readyState<1&&await this._initPreload(),Gb.pictureInPictureSupportType){case"pip-api":return this._video.requestPictureInPicture();case"webkit-presentation-mode":return this._video.webkitSetPresentationMode(qR);default:throw new Error("Picture-in-picture is not supported by this browser")}}_initPreload(){return this.preload="auto",new Promise(e=>{this.once(lR.LOADED_METADATA,e)})}async exitPictureInPicture(){switch(Gb.pictureInPictureSupportType){case"pip-api":return document.exitPictureInPicture();case"webkit-presentation-mode":return this._video.webkitSetPresentationMode(WR);default:throw new Error("Picture-in-picture is not supported by this browser")}}isInView(){return this._playerInViewTracker?.isInView??!0}get pictureInPictureEnabled(){if(this.disablePictureInPicture)return!1;switch(Gb.pictureInPictureSupportType){case"pip-api":return document.pictureInPictureEnabled;case"webkit-presentation-mode":return!0;default:return!1}}get video(){return this._telecineVideo}get videoElement(){return this._video}set video(e){if(this.reactivate(),this._telecineVideo!==e){if(this._telecineVideo&&(this._telecineVideo.off(pR.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeAllCuePoints(),this._telecineVideo=e,this._files=this.filterFiles(this._telecineVideo),this._telecineVideo.on(pR.FILE_SRC_UPDATE,e=>{e===this._currentFile&&this._updateCurrentFile()}),this._telecineVideo.on("texttracksrcupdate",e=>{this.video.currentScanner&&this.video.currentScanner.setSrcForTrack(e,e.src)}),this._options.externalDisplays&&this._options.externalDisplays.length){this._externalDisplays=[];let t=this.constructor.supportedExternalDisplays;Array.isArray(t)||(t=[]);const r=t.map(e=>e.displayName);this._options.externalDisplays.filter(e=>e.supported&&-1!==r.indexOf(e.displayName)).forEach(t=>{const r=new t(e),n=t.displayName.replace("ExternalDisplay","");r.on(lR.LOADED_METADATA,e=>this.fire(lR.LOADED_METADATA,e)),r.on("available",()=>this.fire(dR.AVAILABLE,{type:n})),r.on("unavailable",()=>this.fire(dR.UNAVAILABLE,{type:n})),r.on("activated",()=>{"function"==typeof this.onexternaldisplayactivated&&this.onexternaldisplayactivated(r),this.fire(dR.ACTIVATED,{type:n})}),r.on("deactivated",()=>{"function"==typeof this.onexternaldisplaydeactivated&&this.onexternaldisplaydeactivated(r),this.fire(dR.DEACTIVATED,{type:n})}),this._externalDisplays.push(r)})}this._updateCurrentFile(),Gb.iOS&&this._externalDisplays.forEach(e=>{"AirPlay"===e.constructor.displayName&&(e.element=this._video)}),this.initDrm()}}get videoWidth(){return this._video.videoWidth}get videoHeight(){return this._video.videoHeight}get volume(){return Tb(this._video.volume)}set volume(e){this._video.volume=Eb(e)}get readyState(){return this._video.readyState}onerror(){if(!this._video.error)return!1;switch(this._video.error.code){case this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this._fireVideoError("MediaSrcNotSupportedError","The media was not suitable."),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_DECODE:return-1!==this._lastCurrentTime&&Gb.iOS?(this._video.load(),this.currentTime=this._lastCurrentTime,this._lastCurrentTime=-1,!1):(this._fireVideoError("MediaDecodeError","The media could not be decoded."),this._switchToNextFile(),!1);case this._video.error.MEDIA_ERR_NETWORK:return this._fireVideoError("MediaNetworkError","A network error occurred while fetching the media."),!1;case this._video.error.MEDIA_ERR_ABORTED:return this._fireVideoError("MediaAbortedError","The user agent aborted the fetching of the media."),!1;default:return this._fireVideoError(VR,"An unknown error occurred."),!1}}_fireVideoError(e,t){this.fire(lR.ERROR,new TelecineError(e,t))}onended(){if(this._video.paused||this._video.pause(),this.currentTime<this._video.duration)return!1}onwaiting(){return!1}onwebkitbeginfullscreen(){this._inFullscreen=!0}onwebkitendfullscreen(){this._video.webkitPresentationMode===WR&&!0===this._video.controls&&(this._video.controls=!1),this._inFullscreen=!1}onwebkitpresentationmodechanged(){this.fire(this.pictureInPictureActive?lR.ENTER_PICTURE_IN_PICTURE:lR.LEAVE_PICTURE_IN_PICTURE)}filterFiles(e){return e.files.filter(t=>!(t.mime===ab.hls&&Gb.chromeHls&&e.metadata.drm||-1===this.constructor.supportedVideoTypes.indexOf(t.mime)))}shouldHandleVideoEvent(e){return!0}handleVideoEvent(e){e.target===this._video&&!1!==this.shouldHandleVideoEvent(e)&&("function"==typeof this[`on${e.type}`]&&!1===this[`on${e.type}`](e)||this.fire(e.type))}handleAudioEvent(){this.fire(pR.AUDIO_TRACK_CHANGED)}swapVideo(e,t){const r=e.paused;this.removeVideoEventListeners(e),this.removeAudioEventListeners(e),e.parentElement.replaceChild(t,e),e.pause(),this._playRequest&&(this._playRequest.video=t),t.currentTime=e.currentTime,r||t.play(),this.addVideoEventListeners(t),this.addAudioEventListeners(t),this._video=t}onexternaldisplayactivated(e){this._externalDisplayActivated||(this._video!==e.element&&(this._originalVideo=this._video,this.swapVideo(this._video,e.element)),this._externalDisplayActivated=!0)}onexternaldisplaydeactivated(e){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(e.element,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)}setVideoSrc(e){this._video.src=e}canSeekTo(e){const t=this.duration;if(t&&e>t&&(e=t),this._video.seekable.length>0)for(let t=0,r=this._video.seekable.length;t<r;t++)if(this._video.seekable.start(t)<=e&&this._video.seekable.end(t)>=e)return!0;return!1}seekToTime(e){return this.canSeekTo(e)?(this._video.currentTime=e,Promise.resolve(this._video.currentTime)):new Promise(t=>{const r=()=>{this.canSeekTo(e)&&(Object.keys(lR).forEach(e=>{const t=lR[e];this._video.removeEventListener(t,r)}),this._video.currentTime=e,t(this._video.currentTime))};Object.keys(lR).forEach(e=>{const t=lR[e];this._video.addEventListener(t,r)})})}takeSnapshot(){OR(this._video,this._element)}removeSnapshot(){LR(this._element)}getTrackById(e){if(this._textTracks&&this._textTracks[e])return this._textTracks[e];if("function"==typeof this._video.textTracks.getTrackById)return this._video.textTracks.getTrackById(e);const t=document.getElementById(e);return t?t.track:null}initDrm(){const e=this._telecineVideo.drmHandler;e&&e.init(this)}showExternalDisplayPicker(e){if(!this._externalDisplays.length)throw new TelecineError("ExternalDisplayUnavailable","No external displays are available.");if(!e)return void this._externalDisplays[0].showPicker();const t=this._externalDisplays.filter(t=>t.constructor.displayName.replace("ExternalDisplay","")===e)[0];if(!t)throw new TelecineError("InvalidExternalDisplay","The specified external display is not available.");t.showPicker()}setCaptionsShouldDisplay(e){}setCaptionsShouldLoad(e){}_pickFile(){if(this._files.length<1)return null;const e=this._files.slice(0).sort((e,t)=>e.priority-t.priority);return e[0]}_updateCurrentFile(){const e=this._pickFile();e?this.currentFile=e:this.fire(pR.SCANNER_ERROR,{reason:"all files failed"})}_isValidChapter(e,t){return void 0!==e.timecode&&e.timecode>=0&&e.timecode<=t&&void 0!==e.title}_switchToNextFile(){const e=this._files.indexOf(this._currentFile);this._files.splice(e,1),this._updateCurrentFile()}_cleanUpInViewTracking(){this._playerInViewTracker?.cleanup()}_resetInViewTracking(){this._cleanUpInViewTracking(),this._playerInViewTracker=Jb(this._element)}}function QR(e,t=[]){if(0===e.length)return 0;let r=0,n=0;for(let i=0;i<e.length;i++){const s=t[i]||1;n+=s,r+=e[i]*s}return r/n}function ZR(e){const t=[...e].sort((e,t)=>e-t),r=Math.floor(t.length/2);return t.length%2?t[r]:(t[r-1]+t[r])/2}class eP extends Error{}var tP=new WeakMap,rP=new WeakMap,nP=new WeakMap,iP=new WeakMap,sP=new WeakMap,aP=new WeakMap,oP=new WeakMap,cP=new WeakMap,uP=new WeakMap,lP=new WeakMap,hP=new WeakMap,dP=new WeakMap,fP=new WeakMap,pP=new WeakMap,_P=new WeakMap,vP=new WeakMap,mP=new WeakMap,gP=new WeakSet;class yP extends nw{constructor(e={}){super(),ZA(this,gP),JA(this,tP,void 0),JA(this,rP,void 0),JA(this,nP,100),JA(this,iP,void 0),JA(this,sP,void 0),JA(this,aP,void 0),JA(this,oP,new Set),JA(this,cP,void 0),JA(this,uP,!1),JA(this,lP,void 0),JA(this,hP,void 0),JA(this,dP,!1),JA(this,fP,[]),JA(this,pP,[]),JA(this,_P,[]),JA(this,vP,[]),JA(this,mP,[]),QA(tP,this,bb());const{parallel:t=1,retryAbortErrors:r=!0,retryCount:n=3,timeout:i=0}=e;QA(rP,this,t),QA(iP,this,r),QA(sP,this,n),QA(aP,this,i),YA(gP,this,TP).call(this)}getPercentileSpeed(e=5,t=.8){return function(e,t){if(0===e.length)return 0;const r=[...e].sort((e,t)=>e-t);if(t<=0)return r[0];if(t>=1)return r[r.length-1];const n=r.length*t,i=Math.floor(n),s=i+1,a=n%1;return s>=r.length?r[i]:r[i]*(1-a)+r[s]*a}($A(mP,this).slice(-e),t)}getAverageSpeed(e=5,t=[]){return QR($A(mP,this).slice(-e),t)}getHarmonicAverageSpeed(e=5){return function(e){if(0===e.length)return 0;let t=0;for(let r=0;r<e.length;r++)t+=1/e[r];return e.length/t}($A(mP,this).slice(-e))}getMedianSpeed(e=5){return ZR($A(mP,this).slice(-e))}getResponseSpeeds(){return $A(mP,this)}getProgressSpeeds(){return $A(vP,this)}getFailedSegments(){return $A(pP,this)}getSuccessfulSegments(){return $A(_P,this)}resetResponseSpeeds(){$A(mP,this).length=0}get pendingFetches(){const e=[];return $A(oP,this).forEach(t=>{const r=$A(cP,this).get(t);r&&(r.elapsedTime=rS()-t.data.requestSendTime,e.push(r))}),e}add(e){return new Promise((t,r)=>{const n=YA(gP,this,AP).call(this,e,t,r);YA(gP,this,bP).call(this,n),$A(uP,this)&&!$A(dP,this)&&YA(gP,this,SP).call(this)})}abort(e=null){$A(fP,this).filter(t=>!e||e===t.stream).forEach(e=>{e.reject(new eP("Stream manually aborted")),this.fire("downloadabort",e.identifier)}),QA(fP,this,$A(fP,this).filter(t=>e&&e!==t.stream)),$A(oP,this).forEach(t=>{e&&e!==t.stream||t.request.abort()})}start(){$A(uP,this)||(QA(uP,this,!0),YA(gP,this,SP).call(this))}stop(){QA(uP,this,!1)}saveResponseSpeeds(e,t,r){if(!e.includeWithBandwidthChecks)return;const n=YA(gP,this,DP).call(this,e,t,r),i=r<15e4&&Gb.navigatorConnectionDownlink?Math.max(lb(),n):n;$A(mP,this).push(i),$A(mP,this).length>100&&$A(mP,this).shift()}}function EP(e){let t=0;for(;t<$A(fP,this).length&&!($A(fP,this)[t].priority>e.priority);t++);$A(fP,this).splice(t,0,e)}function TP(){if(QA(cP,this,new WeakMap),window.addEventListener("online",()=>{this.start(),$A(hP,this)&&($A(hP,this).resolve(),QA(hP,this,null))}),window.addEventListener("offline",()=>{this.stop(),this.abort(),QA(hP,this,Zb())}),Gb.navigatorConnectionDownlink){const e=lb();$A(mP,this).push(e)}}function bP(e){e.hasOwnProperty("priority")?YA(gP,this,EP).call(this,e):$A(fP,this).push(e)}function SP(){if(!$A(uP,this))return;QA(dP,this,!0);const e=$A(rP,this)-$A(oP,this).size;for(let t=0;t<e;t++)YA(gP,this,IP).call(this)}function AP(e,t,r){let n=e;return"object"==typeof e&&e.id&&(n=e.id),Object.assign({},e,{identifier:n,resolve:t,reject:r})}function wP(){0!==$A(oP,this).size||0!==$A(fP,this).length?$A(oP,this).size<$A(rP,this)&&YA(gP,this,SP).call(this):QA(dP,this,!1)}function IP(){if(0===$A(fP,this).length)return void QA(dP,this,!1);const e=$A(fP,this).shift(),{url:t,byteRange:r,isInitSegmentRequest:n,identifier:i,stream:s,timeout:a}=e,o={stream:s,data:{url:t,isInitSegmentRequest:n,requestSendTime:rS(),uuid:oS()}};let c=$A(aP,this);"number"==typeof a&&a>=0&&(c=a);const u={url:t,type:QT.SEGMENT,responseType:RS.ARRAY_BUFFER,retry:$A(sP,this),hooks:{beforeRetry:[YA(gP,this,RP).bind(this)]},onDownloadProgress:YA(gP,this,PP).call(this,i,o),headers:r&&{Range:`bytes=${r}`},retryAbortErrors:$A(iP,this),timeout:c};this.fire("downloadstart",i),o.request=yS(u).then(YA(gP,this,kP).call(this,o,e)).catch(YA(gP,this,CP).call(this,o,e)),$A(oP,this).add(o)}async function RP(){$A(hP,this)&&await $A(hP,this)}function PP(e,t){let r=0,n=0,i=rS();return s=>{if(s.lengthComputable){const a=8*(s.loaded-n),o=rS(),c=o-i,u={startTime:i,length:c,bitrate:a/(c/1e3),index:r};r>0&&($A(vP,this).length>=$A(nP,this)&&$A(vP,this).shift(),$A(vP,this).push(u)),i=o,n=s.loaded,r+=1,$A(cP,this).set(t,{bytesTotal:s.total,bytesLoaded:s.loaded,percent:s.loaded/s.total,identifier:e}),this.fire("progress",e)}}}function kP(e,t){const r=rS(),{identifier:n,resolve:i}=t;return async s=>{let a=rS()-r,o=await s.arrayBuffer();Object.prototype.hasOwnProperty.call(s,"perfTimings")&&Object.prototype.hasOwnProperty.call(s.perfTimings,"responseStart")&&(t.perfTimings=s.perfTimings),e.data.duration=rS()-e.data.requestSendTime,$A(oP,this).delete(e),$A(cP,this).delete(e),this.saveResponseSpeeds(t,a,o.byteLength),this.fire("downloadend",n,{request:e,response:s}),$A(_P,this).push({url:e.data.url,status:200,duration:e.data.duration}),o=await YA(gP,this,OP).call(this,e,o),i(o),YA(gP,this,wP).call(this)}}function DP(e,t,r){const n=2e5,i=t/1e3,s=e.perfTimings;let a=r/i;const o=s&&r<=16e3;if(e.excludeConnectTime&&r>16e3&&r<=n){const e=(50*Math.max(0,1-r/n)+150)/1e3;a=r/Math.max(.1,i-e)}else if(o){const e=s.fetchStart||s.workerStart||s.requestStart||0;a=r/(i-Math.max(0,s.responseStart-e)/1e3)}return 8*a}function OP(e,t){return e.data.url&&e.data.url.split("?")[0].endsWith(".ts")?YA(gP,this,LP).call(this,e,t):Promise.resolve(new Uint8Array(t))}async function LP(e,t){if(!$A(lP,this)){const e=await YA(gP,this,MP).call(this);QA(lP,this,new e({keepOriginalTimestamps:!0}))}return new Promise(r=>{$A(lP,this).on("data",t=>{$A(lP,this).off("data");let n=new Uint8Array(t.initSegment.byteLength+t.data.byteLength);n.set(t.initSegment,0),n.set(t.data,t.initSegment.byteLength),r(e.data.isInitSegmentRequest?t.initSegment:n)}),$A(lP,this).push(new Uint8Array(t)),$A(lP,this).flush()})}function CP(e,t){const{identifier:r,reject:n,size:i}=t;return t=>{const s=rS()-e.data.requestSendTime;if(e.data.duration=s,t instanceof uS)$A(pP,this).push({url:e.data.url,status:"abort",duration:s}),this.fire("downloadabort",r);else if(t instanceof lS){const n=t.response.status;$A(pP,this).push({url:e.data.url,status:n,duration:s}),this.fire("downloaderror",r,n)}else if(t instanceof dS){if($A(pP,this).push({url:e.data.url,status:"timeout",duration:s}),"number"==typeof i&&i>0&&t.timeoutMs>0){let e=8*i/(t.timeoutMs/1e3);e*=.5,$A(tP,this).call(this,"Adding degraded speed of",e,"after timeout of",t.timeoutMs,"ms"),$A(mP,this).push(e)}this.fire("downloadtimeout",r,{timeoutMs:t.timeoutMs})}$A(cP,this).delete(e),$A(oP,this).delete(e),n(t),YA(gP,this,wP).call(this)}}function MP(){return import("./mux-mp4.module.js").then(({default:e})=>e)}var NP=new WeakMap,xP=new WeakMap,UP=new WeakMap,FP=new WeakMap,VP=new WeakMap,jP=new WeakMap,BP=new WeakMap,HP=new WeakMap,XP=new WeakMap,WP=new WeakMap,qP=new WeakMap,GP=new WeakMap,KP=new WeakMap,YP=new WeakMap,zP=new WeakMap,$P=new WeakMap,JP=new WeakMap,QP=new WeakMap,ZP=new WeakMap,ek=new WeakMap,tk=new WeakMap,rk=new WeakMap,nk=new WeakMap,ik=new WeakSet;class sk extends nw{constructor(e,t){super(),ZA(this,ik),JA(this,NP,void 0),JA(this,xP,void 0),JA(this,UP,void 0),JA(this,FP,void 0),JA(this,VP,void 0),JA(this,jP,void 0),JA(this,BP,-1),JA(this,HP,!1),JA(this,XP,!1),JA(this,WP,{}),JA(this,qP,void 0),JA(this,GP,!0),JA(this,KP,null),JA(this,YP,!0),JA(this,zP,!1),JA(this,$P,!1),JA(this,JP,void 0),JA(this,QP,null),JA(this,ZP,void 0),JA(this,ek,null),JA(this,tk,[]),JA(this,rk,void 0),JA(this,nk,[]),QA(jP,this,bb()),QA(VP,this,t),QA(ZP,this,e),QA(NP,this,YA(ik,this,ok).bind(this)),QA(xP,this,YA(ik,this,dk).bind(this)),QA(UP,this,YA(ik,this,hk).bind(this)),QA(FP,this,YA(ik,this,vk).bind(this)),$A(ZP,this).on("durationset",$A(NP,this))}get activeStream(){return $A(tk,this)[$A(BP,this)]||null}get activeStreamIndex(){return $A(BP,this)}get endTime(){if(!$A(ek,this))return void $A(jP,this).warn("SourceBuffer is not set.");const e=$A(ek,this).buffered;return e.length>0?e.end(e.length-1):void 0}get sourceBuffer(){return $A(ek,this)}set sourceBuffer(e){QA(ek,this,e),YA(ik,this,ck).call(this),this.fire("sourcebufferattach")}get streams(){return $A(tk,this)}addStream(e){e.on("segmentadd",$A(FP,this));const t=$A(tk,this).push(e)-1;e.index=t,-1===$A(BP,this)&&(YA(ik,this,lk).call(this,t),QA(zP,this,!0))}getBufferState(){return $A(WP,this)}setBufferState(e){QA(WP,this,e)}streamIndexAtTime(e){if($A(WP,this)[void 0])return this.activeStreamIndex;const t=YA(ik,this,ak).call(this,e)-1,r=$A(WP,this)[t];return r?.stream||-1}switchTo(e,t=!0,r={}){let n;n="number"==typeof e?e:e.index;let i=$A(BP,this)!==n;const s=i;if(!i&&$A(zP,this)&&(i=!0),i){QA(zP,this,!1);const e=$A(BP,this),r=$A(tk,this)[e];this.fire("streamchangestart",e,n),r&&s&&t&&r.abort(),QA(rk,this,n),YA(ik,this,lk).call(this,n)}return YA(ik,this,vk).call(this),new Promise(e=>{i?QA(QP,this,()=>{$A(rk,this)===n&&(QA(QP,this,null),e(),this.fire("streamchange",n,r))}):e()})}isTimeInBuffer(e){if(!$A(ek,this))return $A(jP,this).warn("SourceBuffer is not set."),!1;for(let t=0;t<$A(ek,this).buffered.length;t++){const r=$A(ek,this).buffered.start(t),n=$A(ek,this).buffered.end(t);if(r<=e&&n>=e)return!0}return!1}hasAppendedFinalSegment(){return void 0!==$A(qP,this)&&this.isTimeInBuffer($A(qP,this))}clear(){$A(tk,this).forEach(e=>e.clear())}remove(e,t=$A(ZP,this).mediaSource.duration){return new Promise(r=>{$A(nk,this).push([e,t,r]),YA(ik,this,vk).call(this)})}removeEventListeners(){$A(ek,this)&&($A(ek,this).removeEventListener("updateend",$A(UP,this)),YA(ik,this,uk).call(this,$A(ek,this))&&$A(ek,this).removeEventListener("bufferedchange",$A(xP,this)))}removeSorcerer(){$A(ZP,this).off("durationset",$A(NP,this)),QA(ZP,this,null)}}function ak(e){let t=Math.floor(e/6);return e>6&&e%6>=2?t+=1:e<8&&(t=1),t}function ok(){const e=$A(ZP,this).mediaSource.duration,t=YA(ik,this,ak).call(this,e);for(let e=0;e<t;e++)$A(WP,this)[e]={segment:e,stream:null,type:$A(VP,this)}}function ck(){$A(ek,this)?($A(ek,this).addEventListener("updateend",$A(UP,this)),YA(ik,this,uk).call(this,$A(ek,this))&&$A(ek,this).addEventListener("bufferedchange",$A(xP,this))):$A(jP,this).warn("SourceBuffer is not set.")}function uk(e){return"undefined"!=typeof ManagedSourceBuffer&&e instanceof ManagedSourceBuffer}function lk(e){QA(YP,this,!0),QA(BP,this,e),$A(ZP,this).setStreamIndex(e)}function hk(){YA(ik,this,pk).call(this),YA(ik,this,_k).call(this),YA(ik,this,vk).call(this)}function dk(e){e.removedRanges?.length>0&&$A(jP,this).call(this,"Browser removed %s buffer:",$A(VP,this),(e=>{const t=[];for(let r=0;r<e.length;r++)t.push(`${e.start(r)}-${e.end(r)}`);return t.join(", ")})(e.removedRanges))}function fk(){if($A(ek,this))try{const e=$A(ek,this).buffered,t=$A(ZP,this)._video.buffered;if(e.length&&t.length){const r=e.start(0),n=t.start(0);r<n&&$A(ZP,this).removeBuffer(0,n)}}catch(e){$A(jP,this).error("Error failed to handle mismatch between video and sourceBuffer.")}else $A(jP,this).warn("SourceBuffer is not set.")}function pk(){if($A(XP,this)&&this.endTime)return QA(XP,this,!1),QA(qP,this,this.endTime),$A(ZP,this).checkEndOfStream(),void YA(ik,this,fk).call(this);this.activeStream&&!this.activeStream.hasNextSegment()&&void 0!==$A(qP,this)&&$A(qP,this)>0&&"open"===$A(ZP,this).readyState&&$A(ZP,this).checkEndOfStream()}function _k(){$A(KP,this)&&(this.fire("appendbufferend",$A(KP,this)),QA(KP,this,null),$A(QP,this)&&$A(QP,this).call(this))}function vk(){if(!$A(ek,this))return $A(jP,this).log("SourceBuffer is not set. Waiting for sourcebufferattach event."),void this.on("sourcebufferattach",$A(FP,this));this.activeStream&&"closed"!==$A(ZP,this).readyState&&($A(ek,this).updating||($A(nk,this).length?YA(ik,this,mk).call(this):$A($P,this)||$A(HP,this)||($A(YP,this)?YA(ik,this,gk).call(this):YA(ik,this,yk).call(this))))}function mk(){const e=$A(ek,this),t=$A(nk,this).shift();if(!t||!e)return void $A(jP,this).warn("No entries to remove or sourceBuffer is not set.");const[r,n,i]=t,s=()=>{e.removeEventListener("updateend",s),i(),void 0!==$A(JP,this)&&clearTimeout($A(JP,this)),QA(JP,this,setTimeout(()=>{QA($P,this,!1),YA(ik,this,vk).call(this)},5e3))};e.addEventListener("updateend",s),e.remove(r,n)}function gk(){QA(YP,this,!1),QA(HP,this,!0),this.activeStream?this.activeStream.getInitSegment().then(e=>(QA(KP,this,null),$A(ek,this)&&e&&$A(ek,this).appendBuffer(e),QA(HP,this,!1),e)).catch(e=>{$A(jP,this).error("Error appending init segment to the buffer:",e),QA(YP,this,!0),QA(HP,this,!1)}):$A(jP,this).error("No active stream to append init segment.")}function yk(){if(!this.activeStream||!$A(ek,this))return void $A(jP,this).error("No active stream or sourceBuffer to append segment.");const e=this.activeStream.getNextSegment();if(!e)return;const t=this.activeStream.getIdForSegment(e);this.activeStream.isFinal(e)&&QA(XP,this,!0),QA(KP,this,t),this.fire("appendbufferstart",t);try{$A(ek,this).appendBuffer(e),$A(WP,this)[t.segment]=t,$A(GP,this)&&(QA(GP,this,!1),this.fire("initialbufferstart"))}catch(t){if("QuotaExceededError"===t.name){QA($P,this,!0),this.fire("quotaexceedederror",$A(ek,this).buffered),$A(jP,this).error("Error QuotaExceededError.");const t=6;if($A(ZP,this)._video.currentTime>t){const e=0,r=$A(ZP,this)._video.currentTime-t;$A(jP,this).call(this,`Removing buffer from ${e} to ${r}…`),$A(ZP,this).removeBuffer(e,r)}this.activeStream.dequeueSegment(e)}}}var Ek=new WeakMap,Tk=new WeakMap,bk=new WeakMap,Sk=new WeakMap,Ak=new WeakMap,wk=new WeakMap,Ik=new WeakMap;class Rk extends nw{static isValidSegmentUrl(e){return"string"==typeof e||"object"==typeof e&&"url"in e&&"byteRange"in e&&"string"==typeof e.url&&"string"==typeof e.byteRange}constructor(e,t="",r=new yP){super(),ew(this,"codec",void 0),ew(this,"index",NaN),JA(this,Ek,void 0),JA(this,Tk,new WeakMap),JA(this,bk,void 0),JA(this,Sk,void 0),JA(this,Ak,!0),JA(this,wk,[]),JA(this,Ik,{}),QA(Ek,this,bb()),QA(Sk,this,e),this.codec=t,QA(bk,this,r),$A(bk,this).start()}get pendingFetches(){return $A(bk,this).pendingFetches}getIdForSegment(e){return Rk.isValidSegmentUrl(e)?$A(Ik,this)[e]:$A(Tk,this).get(e).id}getSegmentUrl(e){return"object"==typeof e&&"url"in e?e.url:e}getSegmentByteRange(e){return"object"==typeof e&&"byteRange"in e?e.byteRange:void 0}isFinal(e){return $A(Tk,this).get(e).final}addSegment(e,{identifier:t=null,isFinalSegment:r=!1,loadOnly:n=!1,priority:i=0,includeWithBandwidthChecks:s=!0,excludeConnectTime:a=!1,timeout:o=null,size:c=null}={}){if($A(Ak,this)&&this.getInitSegment(),Rk.isValidSegmentUrl(e)){$A(Ik,this)[e]=t||e;const u=this.getIdForSegment(e);return this.fire("queued",u),$A(bk,this).add({byteRange:this.getSegmentByteRange(e),excludeConnectTime:a,id:u,includeWithBandwidthChecks:s,isInitSegmentRequest:!1,priority:i,size:c,stream:this,timeout:o,url:this.getSegmentUrl(e)}).then(i=>{$A(Tk,this).set(i,{id:t||e,final:r}),$A(wk,this).push(i),this.fire("bufferqueueadd",u),n||this.fire("segmentadd")})}return $A(Tk,this).set(e,{id:t,final:r}),$A(wk,this).push(e),this.fire("bufferqueueadd",t),Promise.resolve()}clear(){QA(wk,this,[])}async abort(){if($A(Ak,this))try{await this.getInitSegment()}catch(e){$A(Ek,this).error("Error getting init segment:",e)}$A(bk,this).abort(this)}hasNextSegment(){return $A(wk,this).length>0}getNextSegment(){return $A(wk,this).shift()}dequeueSegment(e){$A(wk,this).unshift(e)}getInitSegment(){const e=this.getSegmentUrl($A(Sk,this));return e?(QA(Ak,this,!1),Rk.isValidSegmentUrl(e)?$A(bk,this).add({byteRange:this.getSegmentByteRange($A(Sk,this)),id:null,isInitSegmentRequest:!0,priority:0,stream:this,url:e}).then(e=>(QA(Sk,this,e),$A(Sk,this))):Promise.resolve($A(Sk,this))):Promise.resolve(null)}}var Pk=new WeakMap,kk=new WeakMap,Dk=new WeakMap,Ok=new WeakMap,Lk=new WeakMap,Ck=new WeakMap,Mk=new WeakMap,Nk=new WeakMap,xk=new WeakMap,Uk=new WeakMap,Fk=new WeakMap,Vk=new WeakSet;class jk{constructor(e,t=-1){ZA(this,Vk),ew(this,"streamIndex",void 0),JA(this,Pk,void 0),JA(this,kk,void 0),JA(this,Dk,void 0),JA(this,Ok,void 0),JA(this,Lk,!1),JA(this,Ck,void 0),JA(this,Mk,{}),JA(this,Nk,{}),JA(this,xk,0),JA(this,Uk,0),JA(this,Fk,!1),QA(Ok,this,e),this.streamIndex=t,QA(Pk,this,this.start.bind(this)),QA(kk,this,this.stop.bind(this)),QA(Dk,this,YA(Vk,this,Wk).bind(this))}init(){YA(Vk,this,Bk).call(this)}start(){QA(Lk,this,!0),YA(Vk,this,Xk).call(this)}stop(){QA(Lk,this,!1)}destroy(){this.stop(),YA(Vk,this,Hk).call(this)}getDroppedFrameRate(e,t=-1,r="average"){const n=$A(Mk,this)[t];if(!n||n.length<e)return 0;const i=n.slice(-e);return"median"===r?ZR(i):QR(i)}getDroppedFrameTotal(){return{dropped:YA(Vk,this,qk).call(this),total:YA(Vk,this,Gk).call(this)}}}function Bk(){$A(Fk,this)||($A(Ok,this).addEventListener("playing",$A(Pk,this)),$A(Ok,this).addEventListener("pause",$A(kk,this)),$A(Ok,this).addEventListener("ended",$A(kk,this)),document.addEventListener("visibilitychange",$A(Dk,this)),QA(Fk,this,!0))}function Hk(){$A(Ok,this).removeEventListener("playing",$A(Pk,this)),$A(Ok,this).removeEventListener("pause",$A(kk,this)),$A(Ok,this).removeEventListener("ended",$A(kk,this)),document.removeEventListener("visibilitychange",$A(Dk,this)),QA(Fk,this,!1)}function Xk(){if(!$A(Lk,this)||-1===this.streamIndex)return;if(Gb.browser.safari&&(document.hidden||"hidden"===document.visibilityState))return;void 0!==$A(Ck,this)&&clearTimeout($A(Ck,this));const e=YA(Vk,this,qk).call(this),t=e-$A(xk,this);QA(xk,this,e);const r=YA(Vk,this,Kk).call(this),n=r-$A(Uk,this);QA(Uk,this,r),$A(Mk,this)[this.streamIndex]||($A(Mk,this)[this.streamIndex]=[]),$A(Nk,this)[this.streamIndex]||($A(Nk,this)[this.streamIndex]=[]),$A(Mk,this)[this.streamIndex].length>100&&$A(Mk,this)[this.streamIndex].shift(),$A(Nk,this)[this.streamIndex].length>100&&$A(Nk,this)[this.streamIndex].shift(),$A(Mk,this)[this.streamIndex].push(t),$A(Nk,this)[this.streamIndex].push(n),QA(Ck,this,setTimeout(()=>{YA(Vk,this,Xk).call(this)},1e3))}function Wk(){!Gb.browser.safari||document.hidden&&"hidden"===document.visibilityState||YA(Vk,this,Xk).call(this)}function qk(){return"function"==typeof $A(Ok,this).getVideoPlaybackQuality?$A(Ok,this).getVideoPlaybackQuality().droppedVideoFrames:$A(Ok,this).webkitDroppedFrameCount||0}function Gk(){return"function"==typeof $A(Ok,this).getVideoPlaybackQuality?$A(Ok,this).getVideoPlaybackQuality().totalVideoFrames:$A(Ok,this).webkitDecodedFrameCount||0}function Kk(){if("function"==typeof $A(Ok,this).getVideoPlaybackQuality){const e=$A(Ok,this).getVideoPlaybackQuality();return e.totalVideoFrames-e.droppedVideoFrames}return $A(Ok,this).webkitDecodedFrameCount||0}var Yk=new WeakMap,zk=new WeakMap,$k=new WeakMap,Jk=new WeakMap,Qk=new WeakMap,Zk=new WeakMap,eD=new WeakMap,tD=new WeakMap,rD=new WeakMap,nD=new WeakMap,iD=new WeakMap;class sD extends nw{constructor(e,t={}){super(),ew(this,"_video",void 0),ew(this,"allowSegmentRequests",void 0),JA(this,Yk,void 0),JA(this,zk,void 0),JA(this,$k,void 0),JA(this,Jk,void 0),JA(this,Qk,void 0),JA(this,Zk,void 0),JA(this,eD,void 0),JA(this,tD,void 0),JA(this,rD,void 0),JA(this,nD,void 0),JA(this,iD,void 0),ew(this,"isInstanceofManagedMediaSource",e=>"undefined"!=typeof ManagedMediaSource&&e instanceof ManagedMediaSource),QA(Zk,this,bb()),this._video=e,QA(tD,this,t),this.allowSegmentRequests=!0;const r=$A(tD,this).disableMMS;QA(eD,this,new(wb(r))),$A(Zk,this).log("Media Source API: "+this._mediaSourceAPIName($A(eD,this)));const{fetcherTimeout:n=0,fetcherRetryAbortErrors:i=!0}=$A(tD,this);QA(rD,this,new jk(e)),QA(Qk,this,new yP({parallel:1,timeout:n,retryAbortErrors:i})),QA(Yk,this,this._onMSSourceClose.bind(this)),QA(zk,this,this._onMSSourceOpen.bind(this)),QA(Jk,this,{audio:null,video:null}),QA($k,this,[]),QA(iD,this,null),this._attachEvents()}setStreamIndex(e){$A(rD,this).streamIndex=e}get activeStreamIndex(){return 1===$A($k,this).length&&this.video?this.video.activeStreamIndex:($A(Zk,this).warn("The activeStreamIndex property on MediaSorcerer only works with single streams"),-1)}get mediaSource(){return $A(eD,this)}get pendingFetches(){return $A(Qk,this).pendingFetches}get readyState(){return $A(eD,this).readyState}get streams(){return 1===$A($k,this).length&&this.video?this.video.streams:($A(Zk,this).warn("The streams property on MediaSorcerer only works with single streams"),!1)}get audio(){return $A(Jk,this).audio?$A(Jk,this).audio:($A(Zk,this).warn("No audio streams have been added to MediaSorcerer"),!1)}get video(){return $A(Jk,this).video?$A(Jk,this).video:($A(Zk,this).warn("No video streams have been added to MediaSorcerer"),!1)}getCurrentSpeed({type:e="average",howMany:t=10,weights:r=[],percentile:n}={}){switch(e){case"harmonicAverage":return $A(Qk,this).getHarmonicAverageSpeed(t);case"percentile":return $A(Qk,this).getPercentileSpeed(t,n);case"median":return $A(Qk,this).getMedianSpeed(t);case"average":return $A(Qk,this).getAverageSpeed(t,r)}}getResponseSpeeds(){return $A(Qk,this).getResponseSpeeds()}getFailedSegments(){return $A(Qk,this).getFailedSegments()}getSuccessfulSegments(){return $A(Qk,this).getSuccessfulSegments()}getDroppedFrameRate(e,t=this.activeStreamIndex,r="average"){return $A(rD,this).getDroppedFrameRate(e,t,r)}getDroppedFrameTotal(){return $A(rD,this).getDroppedFrameTotal()}clear(){$A($k,this).forEach(e=>e.clear())}initFrameDropper(){$A(rD,this).init()}streamIndexAtTime(e,t){const r=$A(Jk,this)[t];return r?r.streamIndexAtTime(e):-1}removeBuffer(e=0,t=this._video.duration){if(e>=(t=t||0))return Promise.resolve();const r=$A($k,this).map(r=>r.remove(e,t));return Promise.all(r)}setLiveSeekableRange(e,t){"open"===$A(eD,this)?.readyState&&$A(eD,this).setLiveSeekableRange(e,t)}addStream(e,t){const r=this._getCodecType(e);if(!$A(Jk,this)[r]){const t=new sk(this,r);$A(Jk,this)[r]=t,$A($k,this).push(t),$A(nD,this).then(()=>{let n;try{n=$A(eD,this).addSourceBuffer(e)}catch(e){if(22!==e.code)return $A(Zk,this).error(e),void this.fire("srcnotsupported",e);n=$A(Jk,this)[r]}if($A(tD,this).duration){const e=.1;n.appendWindowEnd=$A(tD,this).duration+e}t.sourceBuffer=n}).catch(e=>{$A(Zk,this).error(e)}),["appendbufferstart","appendbufferend","streamchange","streamchangestart","initialbufferstart","quotaexceedederror"].forEach(e=>{t.on(e,(...t)=>{this.fire(e,...t)})})}const n=new Rk(t,e,$A(Qk,this));["queued","bufferqueueadd"].forEach(e=>{n.on(e,t=>{this.fire(e,t)})});const i=$A(Jk,this)[r];return i&&i.addStream(n),n}checkEndOfStream(){if(!$A($k,this).every(e=>e.hasAppendedFinalSegment()))return;const e=()=>{this._video.removeEventListener("timeupdate",e),this.endOfStream()};this._video.addEventListener("timeupdate",e)}abortFetches(){$A(Qk,this).abort()}endOfStream(){if(!$A($k,this).every(e=>e.isTimeInBuffer(this._video.currentTime))){const e=1;if(!(Gb.browser.firefox&&this._video.currentTime<e))return}"open"===$A(eD,this).readyState&&(this._sourceBuffersAreUpdating()||($A(Zk,this).log("Firing MediaSource.endOfStream()"),$A(eD,this).endOfStream(),this.fire("endofstream")))}destroy(){this.clear(),this._removeEventListeners(),this.off(),$A(rD,this).destroy(),$A(Qk,this).abort();const e=this._video.querySelectorAll("source");(this._video.src||e.length>0)&&(this._video.removeAttribute("src"),e.forEach(e=>{this._video.removeChild(e)}),this._video.load())}_mediaSourceAPIName(e){return this.isInstanceofManagedMediaSource(e)?"ManagedMediaSource":"MediaSource"}_attachEvents(){QA(nD,this,new Promise(e=>{QA(iD,this,e),$A(eD,this).addEventListener("sourceopen",$A(zk,this)),$A(eD,this).addEventListener("sourceclose",$A(Yk,this))})),["downloadstart","downloadend","downloadabort","downloaderror","downloadtimeout","progress"].forEach(e=>{$A(Qk,this).on(e,(...t)=>{this.fire(e,...t)})}),this.isInstanceofManagedMediaSource($A(eD,this))&&($A(eD,this).addEventListener("startstreaming",()=>{$A(Zk,this).log("startstreaming event fired"),this.allowSegmentRequests=!0}),$A(eD,this).addEventListener("endstreaming",()=>{$A(Zk,this).log("endstreaming event fired"),this.allowSegmentRequests=!1}))}_sourceBuffersAreUpdating(){for(let e=0;e<$A(eD,this).sourceBuffers.length;e++)if($A(eD,this).sourceBuffers[e].updating)return!0;return!1}_onMSSourceOpen(){$A(Zk,this).log("MediaSource open"),$A(eD,this).removeEventListener("sourceopen",$A(zk,this)),URL.revokeObjectURL(this._video.src),this._video.querySelectorAll("source").forEach(e=>{0===e.src?.indexOf("blob")&&URL.revokeObjectURL(e.src)}),$A(tD,this).duration&&($A(eD,this).duration=$A(tD,this).duration,this.fire("durationset")),$A(iD,this)&&$A(iD,this).call(this)}_onMSSourceClose(){$A(Zk,this).log("MediaSource closed"),$A(eD,this).removeEventListener("sourceclose",$A(Yk,this)),this.fire("sourceclose")}_removeEventListeners(){$A($k,this).forEach(e=>e.removeEventListeners())}_getCodecType(e){return 0===e.indexOf("audio")?"audio":"video"}}class aD{get displayName(){return"Brain"}constructor(e){this.scanner=e,this.STREAM_TYPE_VIDEO="video",this.STREAM_TYPE_AUDIO="audio"}destroy(){}shouldPowerUp(e,t){return!1}shouldPowerDown(e,t){return!1}canPowerUp(e,t){return 1!==e.length&&t<e.length-1}canPowerDown(e,t){return 1!==e.length&&t>0}filterStreams(e){return e}}class oD extends aD{get displayName(){return"MediaSource"}constructor(e,t={}){super(e),this._options=t,this.blacklisted=[],this.whitelisted=[],this.SEGMENT_DURATION=6,this._bufferTargetSeconds=t.bufferTarget||6}isTimeInBuffer(e,t,r){return this._timesAreInRange(e,e,t,r,1)}getDistanceFromBuffer(e,t){let r=e;for(let n=0;n<t.length;n++)if(t.start(n)<=e&&t.end(n)>=e){r=t.end(n);break}return r-e}blacklist(e){this.blacklisted[e]=1}lock(e=[]){this.whitelisted=e}filterStreams(e,t,r,n=null){const i=[];let s,a=!1;for(let o=0;o<e.length;o++)if(s&&s[0]===e[o].width&&s[1]===e[o].height)i.push(e[o]);else{if(a)break;this.blacklisted[o]&&-1===this.whitelisted.indexOf(o)||this.whitelisted.length&&-1===this.whitelisted.indexOf(o)||(this.whitelisted.length?i.push(e[o]):(this._getScaleFromDimensions(t,r,e[o].width,e[o].height,n)>=(r<1e3/(window.devicePixelRatio||1)?1.75:1)&&(a=!0),i.push(e[o]),s=[e[o].width,e[o].height]))}return i}getCurrentSpeed(e="average"){let t=3,r=[1,2,5];return this._options.tests&&this._options.tests.harmonic_average&&this._options.tests.harmonic_average.group&&(e="harmonicAverage",t=this._getMaxLoadableSegmentsAuto(),r=[]),this.scanner.sorcerer.getCurrentSpeed({type:e,howMany:t,weights:r})}shouldUseSurroundSound(e,t){return"240p"!==e[t].quality}getAudioIndexFromVideo(e,t,r){if(0===t.length)return!1;if(!e[r])return 0;const n=t.filter(({channels:e})=>e>2);if(n.length>0&&this.shouldUseSurroundSound(e,r)){const e=n[n.length-1];return t.indexOf(e)}return t.length>1&&0===r&&e[r].height<=360&&e.length>1?"mp4a.40.2"===t[0].codecs&&t[0].bitrate<8e4&&"240p"!==e[r].quality?1:0:t.length-1}_getVisibleDimensions(e,t,r,n){const i=r/n,s=e-t*i,a=t-e/i;let o=e-s,c=t-a;return s>0&&(c=t),a>0&&(o=e),[o,c]}_getScaleFromDimensions(e,t,r,n,i=null){const s=this._getVisibleDimensions(e,t,r,n);let a=r*n;i&&(a*=i);const o=window.devicePixelRatio||1;return a/(s[0]*s[1]*o*o)}_getMaxLoadableSegmentsAuto(){const e=PR(this._options,"lookahead_count");return e&&e.group&&e.data.count?e.data.count:e&&e.data.segment_lookahead_count?e.data.segment_lookahead_count:3}getBufferTarget(){return this._bufferTargetSeconds}_getSecondsToLoadAhead(e,t,r,n=!1){if(n)this._bufferTargetSeconds=1*this.SEGMENT_DURATION;else if(1===this.whitelisted.length){const e=11e6,t=r&&r.bitrate>e;this._bufferTargetSeconds=t?30:15*this.SEGMENT_DURATION}else this._bufferTargetSeconds=this._getMaxLoadableSegmentsAuto()*this.SEGMENT_DURATION;return this._bufferTargetSeconds}_timesAreInRange(e,t,r,n,i=0){if(!r)return!1;t=Math.min(t,n);for(let n=0;n<r.length;n++){const s=r.start(n),a=r.end(n),o=RR(s)-i,c=RR(a)+i;if(o<=e&&c>=t){if(t<s||e>a)continue;return!0}}return!1}_hasSeparateStreams(e){return e.video.length>0&&e.audio.length>0}_isSegmentInBuffer(e,t,r,n){let i=1;return this._hasSeparateStreams(n)&&(i=.1),this._timesAreInRange(e.start,e.end,t,r,i)}}class cD extends oD{get displayName(){return"Skyfire"}constructor(e,t={}){super(e,t),this.BANDWIDTH_UPSWITCH_THRESHOLD=.85,this.BANDWIDTH_DOWNSWITCH_THRESHOLD=.9,this.DEFAULT_TIMEOUT=8e3,this.SEGMENT_RELATIVE_TIMEOUT_RATIO=4/3,this.MINIMUM_TIMEOUT=1e3,this.FRAME_DROP_WINDOW_SECONDS=10}shouldPowerUp(e,t,r){r&&this._options.startingBandwidthThreshold&&(this.BANDWIDTH_UPSWITCH_THRESHOLD=this._options.startingBandwidthThreshold);let n=e.indexOf(t);if(-1===n&&(n=0),!this.canPowerUp(e,n))return Promise.resolve({index:!1,reasonForSwitch:null});const i=this.getCurrentSpeed();if(!i)return Promise.resolve({index:!1,reasonForSwitch:null});const s=this.getStreamFromSpeed(i,e,this.BANDWIDTH_UPSWITCH_THRESHOLD);return s===n||!r&&s>n&&tS(this.scanner.currentTime,this.scanner._video.buffered)<1.5*this.SEGMENT_DURATION?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:s,reasonForSwitch:3})}shouldPowerDown(e,t){const r=e.indexOf(t);if(-1===r){const t=this.isTimeInBuffer(this.scanner._video.duration,this.scanner._video.buffered,this.scanner._video.duration);return this.whitelisted.length||this.blacklisted.length||!t?Promise.resolve({index:e.length-1,reasonForSwitch:6}):Promise.resolve({index:!1,reasonForSwitch:null})}if(!this.canPowerDown(e,r))return Promise.resolve({index:!1,reasonForSwitch:null});const n=this.getCurrentSpeed();if(!n)return Promise.resolve({index:!1,reasonForSwitch:null});if(this.hasTooManyDroppedFrames(r,t,this._options.droppedFrameSwitchPercent))return this.blacklist(r),Promise.resolve({index:r-1,reasonForSwitch:2});const i=this.getStreamFromSpeed(n,e,this.BANDWIDTH_DOWNSWITCH_THRESHOLD);return i===r?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:i,reasonForSwitch:1})}hasTooManyDroppedFrames(e,t,r){return this.scanner.sorcerer.getDroppedFrameRate(this.FRAME_DROP_WINDOW_SECONDS,e,"median")/t.framerate*100>=r}getTimeEstimateToLoad(e,t){const r=t?.segments?.[e];if(!r)return 3;const n=this.getCurrentSpeed(),i=r.end-r.start;return r.size?(8*r.size+t.audioBitrate*i)/n*1.3:i*(t.avg_bitrate+t.audioBitrate)/n*1.3}canPlayFromTimeInStream(e,t){if(!this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration))return!1;if(!t)return!1;const r=this.getSegmentsToLoad(!1,this.STREAM_TYPE_VIDEO,t);if(0===r.length)return!0;const n=tS(e,this.scanner._video.buffered);return this.getTimeEstimateToLoad(r[0],t)<n}getSegmentsToLoad(e,t=this.STREAM_TYPE_VIDEO,r,n=!1){const i=this.scanner._video;if(i.webkitCurrentPlaybackTargetIsWireless)return[];const s=this.scanner.currentTime,a=[],o=s+this._getSecondsToLoadAhead(s,i.duration,r,n),c=this.scanner.sorcerer[t].activeStreamIndex,u=this.scanner._streams[t][c];if(!u)return a;const l=this.scanner.sorcerer[t].sourceBuffer;let h=null;l&&(h=l.buffered);for(let t=0;t<u.segments.length;t++){const r=u.segments[t];if(r.end<s||r.start>o)continue;const n=s>=r.start&&s<r.end,i=this._isSegmentInBuffer(r,h,this.scanner._video.duration,this.scanner._streams);!e&&i||e&&i&&n||n&&this._isPlayheadDirectlyInBuffer(s,h)||(n||o>=r.start)&&a.push(t)}return a}_isPlayheadDirectlyInBuffer(e,t){if(!t)return!1;for(let r=0;r<t.length;r++)if(e>=t.start(r)&&e<=t.end(r))return!0;return!1}getSegmentRelativeTimeout(e,t,r){const n=t?.avg_bitrate,i=e[0]?.avg_bitrate;if(!n||!i||!r)return this.DEFAULT_TIMEOUT;if(n===i)return this.DEFAULT_TIMEOUT;const s=r*this.SEGMENT_RELATIVE_TIMEOUT_RATIO;return Math.max(this.MINIMUM_TIMEOUT,Math.min(this.DEFAULT_TIMEOUT,s))}getStreamFromSpeed(e,t,r=this.BANDWIDTH_UPSWITCH_THRESHOLD){let n=0;for(let i=n;i<t.length;i++)e*r>t[i].avg_bitrate+t[i].audioBitrate&&(n=i);return n}}class uD{constructor(e,t){this._video=e,this._getCurrentStream=t}start(){return clearInterval(this._checkGapInterval),this._checkGapInterval=setInterval(this._checkGap.bind(this),200),this._checkGap()}stop(){clearInterval(this._checkGapInterval)}onSegmentAppended(){this._checkGap()}_checkGap(){const e=this._video.buffered,t=this._video.currentTime,r=this._getGapIndex(e,t);if(0===this._video.readyState)return!1;if(this._video.paused)return!1;const n=this._video.duration;if(t>=n)return this._video.currentTime=n-.1,!0;if(e.length<=r)return!1;const i=e.start(r);return!(i>=n)&&!(i-t>.5||0!==r||(this.stop(),this._correctFirstSegmentStart("audio",i),this._correctFirstSegmentStart("video",i),this._video.currentTime=i,0))}_getGapIndex(e,t){if(!e||!e.length)return null;let r=0;for(;r<e.length;r++){const n=e.start(r),i=e.end(r);if(n>t&&(0===r||i-t<=.1))break}return r>=0?r:null}_correctFirstSegmentStart(e,t){const r=this._getCurrentStream(0,e);r&&r.segments&&r.segments[0]&&(r.segments[0].start=t)}}const lD="br",hD="bl",dD="pr",fD="sid",pD="cid",_D="sf",vD="st",mD="ot",gD="HLSLiveScanner",yD="HlsJsScanner",ED="HTMLScanner",TD="MediaSourceScanner",bD="NativeHLSLiveScanner";class SD{constructor(e,t={}){this._scanner=e,this.sessionId=t.sessionId,this.clipId=t.clipId}getLogAsQueryParam(e,t){return this._buildCMCDQueryParam(this._getLog(e,t))}_getLog(e,t){let r={};return Object.assign(r,this._getStaticSessionData()),Object.assign(r,this._getDynamicSessionData(e,t)),r}_buildCMCDQueryParam(e){return hb({CMCD:this._getObjectAsAlphabetizedString(e)})}_getStaticSessionData(){return{[fD]:`"${this.sessionId}"`,[pD]:`"${this.clipId}"`,[vD]:this._getStreamType(),[_D]:this._getStreamingFormat()}}_getDynamicSessionData(e,t){return{[dD]:this._scanner.playbackRate,[lD]:this._scanner.getBitrateAtTime(this._scanner.currentTime,t,"max")/1e3,[mD]:this._getObjectType(t),[hD]:this._getBufferLength(e)}}_getObjectType(e){switch(e){case"audio":return"a";case"video":return"v";default:return"av"}}_getBufferLength(e){return Math.round(1e3*(parseFloat(e.end)-parseFloat(e.start)))}_getStreamType(){switch(this._scanner.displayName){case gD:case bD:case yD:return"l";default:return"v"}}_getStreamingFormat(){switch(this._scanner.displayName){case gD:case bD:case yD:return'"hls"';default:return'"dash"'}}_getObjectAsAlphabetizedString(e){let t=[],r="";for(const[r,n]of Object.entries(e))t.push({key:r,value:n});return t.sort((e,t)=>e.key.localeCompare(t.key)).forEach(({key:e,value:t})=>{r+=`${e}=${t},`}),r.replace(/,\s*$/,"")}}const AD=["supported"],wD=new Map,ID=bb();function RD(e){const t=PD(e),r=wD.get(t);return r?AD.filter(e=>!r[e]):[]}function PD(e){return`${e.mime_type};${e.codecs};${e.width};${e.height};${e.bitrate};${e.framerate}`}const kD=["embed.criterionchannel.com","embed.criterionchannel.vhx.tv"];async function DD(e,t,r){const n=function(e){const t=e.audio||[],r=e.video||[];return[{video:"HW_SECURE_ALL",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"}].map(e=>{const n={persistentState:"optional",sessionTypes:["temporary"],videoCapabilities:[],audioCapabilities:[]};return r.length&&(n.videoCapabilities=r.map(t=>({contentType:t,robustness:e.video}))),t.length&&(n.audioCapabilities=t.map(t=>({contentType:t,robustness:e.audio}))),n})}(r);return await Promise.all(Object.keys(e).map(async r=>{const i=e[r].id;let s=null;try{if(t)s=new window.WebKitMediaKeys(i);else{const e=await navigator.requestMediaKeySystemAccess(i,n);s=await e.createMediaKeys()}}catch(e){}return{name:i,mediaKeys:s}}))}const OD="video",LD="audio";class CD extends JR{static get displayName(){return"MediaSourceScanner"}static get supportsMse(){return!0}static get supportsLive(){return!1}static supported(e){const t=wb(e);return void 0!==t&&t.isTypeSupported}static get supportedVideoTypes(){return[ab.dash,ab.dashMpd]}constructor(e,t={}){super(e,t),this.reset(),this.manifestLoadDurations=[],this._preserveCurrentTime=!1,this._preloadStreamIndex=null,this._drmSetupError=null}deactivate(){super.deactivate(),this.sorcerer&&this.sorcerer.destroy(),this.reset()}reset(){this._waitingOnSet=new Set,this._streamsForSegment={},Gb.browser.safari&&(this._gapJumper=new uD(this._video,this._getCurrentStream.bind(this))),this.resetBrain(),this._setupCMCDLogger(),this._ready=!1,this._startedPlaying=!1,this._manifest=null,this._streams={},this._streams[LD]=[],this._streams[OD]=[],this._audioStreams=[],this._onReady=null,this._baseUrl=null,this._lastTargetStreamId=null,this._timeToSeekTo=null,this._seekInProgressPromise=null,this._resolveSeek=null,this._resolveStartPreload=null,this._reloadingExistingVideo=!1,this._lastStreamIndex=null,this._checkSwitchUp=!1,this._clearBufferAtTime=!1,this._preloadStream=null,this._removeBufferPromise=null,this._ranIntoBuffer=!1,this._restrictedStreamIndexes=[],this._switching={},this._lastDownloadBitrate=0,this._preloadSegmentStreamIndex=null,this._preserveCurrentTime=!1,this._preloadStreamIndex=null,this._drmSetupError=null,clearInterval(this._loadSegmentsInterval),clearTimeout(this._slowLoadSegmentTimeout)}resetBrain(){const e=this._options.mediaSourceScanner||{};e.tests=this._options.tests,this._brain&&this._brain.destroy(),this._brain=new cD(this,e)}preloadStream(){if(this._preloadStream)return this._preloadStream;let e=0,t=1;this._streams.audio.length&&(t=2);let r=this._getStartingStreamIndex(),n=0;const i=this._brain.getSegmentsToLoad(!1,OD,r);i.length>0&&(n=i[0]);let s=()=>{};const a=(e=!1)=>{e&&(r=this.sorcerer.video.activeStreamIndex),this._preloadSegmentStreamIndex=r,this._restartLoadSegmentsIntervalWithBackoff(!0)},o=r=>{e+=1,e<t||(r.segment===n&&1!==this._restrictedStreamIndexes.length&&null===this._preloadStreamIndex?this._getStreamIndexToLoadAndSwitchReason(!0).then(t=>{let{index:n,reasonForSwitch:i}=t,o={reasonForSwitch:i};if(!1!==n&&n>r.stream){if(this.sorcerer.video.switchTo(n,!1,o),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,n);this.sorcerer.audio.switchTo(e,!1)}return e=0,void a(!0)}s()}).catch(console.error):s())};return this._preloadStream=new Promise(e=>{s=()=>{const t=this._getCurrentStream(r).segments[0].end,n=this._getDuration(!0);if(this.currentTime>=n&&(this.currentTime=n),this.currentTime>t&&(this.sorcerer.clear(),this._waitingOnSet=new Set),this.sorcerer.video.switchTo(r,!1),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,r);this.sorcerer.audio.switchTo(e,!1)}this.sorcerer.off("bufferqueueadd",o),this._preloadSegmentStreamIndex=null,this._ready=!0,e()},this.sorcerer.on("bufferqueueadd",o),a()}),this._preloadStream}async loadManifest(e){await this.video.metadata.p2pReady;const t=Date.now();return Gb.browser.ie&&e&&-1!==e.indexOf("archive_playlist")?(setTimeout(()=>{this._fireVideoError(VR,"An unknown error occurred.")},250),new Promise(()=>{})):yS({url:e,timeout:1e4,type:QT.MANIFEST}).then(r=>(r.url&&r.url!==e&&-1!==r.url.indexOf("live-archive")&&(this._baseUrl=r.url.split("/").slice(0,-2).join("/")),this.manifestLoadDurations.push({url:e,status:r.status,duration:Date.now()-t}),this.fire(pR.MANIFEST_LOADED),r.text())).then(async t=>{let r;if(-1!==e.indexOf(".mpd")){const{parseMPD:n}=await this._loadMediaManifest(),i=this._telecineVideo.enabledAudioTrack;r=n(t,e,{audioLang:i?.language})}else r=JSON.parse(t);return r}).catch(r=>{if(this.manifestLoadDurations.push({url:e,status:r.response&&r.response.status,duration:Date.now()-t}),this.reset(),r instanceof lS&&410===r.response.status)return this.fire(pR.MEDIA_URL_EXPIRED),new Promise(()=>{});throw r instanceof lS&&400===r.response.status?this.fire(pR.MEDIA_URL_BAD_REQUEST,r.response.url):r instanceof dS&&this.fire(pR.MANIFEST_TIMEOUT),r})}setVideoSrc(e,t,r=!0){if(r&&!t&&this._onReady){if(("metadata"===this._preload||"none"===this._preload&&!this.paused)&&!this._ready)return void this._onReady.then(()=>{const t=this.paused;this.setVideoSrc(e,t,!1)}).catch(console.error);const t=this._telecineVideo.drmHandler;if(t&&"sd-fallback"===t.state&&!t.hasFallbackSourceUpdated)return void this._onReady.then(()=>{this.setVideoSrc(e,!0,!1)}).catch(console.error);if("auto"===this._preload)return void this._onReady.then(()=>{this.setVideoSrc(e,!1,!1)}).catch(console.error)}t&&this.reset(),t||!this.paused||this.sorcerer||(t=!0);let n=this._initializeManifest;t&&(n=this._initialize);const i=e.split("/");i.pop();const s=`${i.join("/")}/`;this._reloadingExistingVideo=!t,this._onReady=this._startPreload(e,this._preload).then(this.loadManifest.bind(this)).then(e=>"string"==typeof this._baseUrl&&-1!==this._baseUrl.indexOf("live-archive")?e:(this._baseUrl=s,{manifest:e,isConfigRefresh:!t})).then(n.bind(this)),t&&"auto"===this._preload&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this),!1)),this._onReady=this._addCatchToPromise(this._onReady)}get preload(){return this._preload}set preload(e){this._handlePreloadChanged(this._preload,e),this._preload=e}get videoElement(){return this._video}get videoWidth(){const e=this._getCurrentStream();return e?e.width:this._video.videoWidth}get videoHeight(){const e=this._getCurrentStream();return e?e.height:this._video.videoHeight}get restrictedStreamIndexes(){return this._restrictedStreamIndexes}set restrictedStreamIndexes(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._onReady.then(()=>this.lockStreamIndexes()).catch(console.error))}get preloadStreamIndex(){return this._preloadStreamIndex}set preloadStreamIndex(e){this._preloadStreamIndex=e;const t=null!==e?[this._preloadStreamIndex]:this._restrictedStreamIndexes;this._brain.lock(t)}get currentTime(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime}set currentTime(e){(this._startedPlaying||0!==e)&&(this._hasAudioVideoMismatch&&this._audioDuration&&e>this._audioDuration-1&&!this._brain.isTimeInBuffer(e,this._video.buffered,this._video.duration)&&(e=this._audioDuration-1),this.seekToTime(e))}get downloadSpeed(){return this._lastDownloadBitrate}get brainDebug(){const e=this.sorcerer&&this._brain&&this._brain.getCurrentSpeed?this._brain.getCurrentSpeed():null;let t=this.sorcerer&&this.sorcerer.getResponseSpeeds?this.sorcerer.getResponseSpeeds():null;return t=t?t.slice(-20):[],{currentSpeed:e,responseSpeeds:t}}get isLowerProfileAvailable(){return this.sorcerer?this.sorcerer[OD].activeStreamIndex>0:null}get videoStreams(){return this._streams[OD]}getBufferTarget(){if(this._brain&&this._brain.getBufferTarget)return this._brain.getBufferTarget()}getBitrateAtTime(e,t="video",r="average"){if(!this.sorcerer)return 0;const n=this.sorcerer.streamIndexAtTime(e,t),i=this._streams[t][n];return i?i["average"===r?"avg_bitrate":"bitrate"]??i.bitrate:0}lockStreamIndexes(){const e=this._restrictedStreamIndexes.map(e=>this._streams[OD].indexOf(this._streams[OD][e])),t=!this.paused;if(t&&(this._ignorePauseEvent=!0,this._video.pause()),this._switching[OD]=!1,this._brain.lock(e),!this._startedPlaying&&"auto"!==this._preload)return;const r=Math.max(this.currentTime-7,0),n=Math.min(this.currentTime+7,this._video.duration);this.sorcerer.removeBuffer(r,n).then(()=>{!this._startedPlaying&&"auto"===this._preload||this.ended?this._loadSegments():(this.seekToTime(this.currentTime),t&&this.paused&&(this._ignorePlayEvent=!0,this._video.play()))}).catch(console.error)}seekToTime(e){if(e===this.currentTime)return Promise.resolve();if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,this._handleScrubbing(),this._ready)for(const e in this._streams)if(this._streams[e].length>0){const t=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[t].abort()}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._onReady,this._removeBufferPromise]).then(()=>{this._loadSegments()}).catch(console.error),this._paused&&0===e&&this.fire(lR.SEEKING),this._onReady.then(()=>this._seekInProgressPromise).catch(e=>{})}takeSnapshot(){this._switchingVideo&&super.takeSnapshot()}initDrm(){}onstalled(){return!1}onseeked(e){this._startedPlaying&&this._restartLoadSegmentsIntervalWithBackoff()}onended(e){return super.onended(e),!0}onseeking(e){this._startedPlaying}_handleScrubbing(){this._scrubStart(),clearTimeout(this._scrubTimeout),this._scrubTimeout=setTimeout(()=>{this._scrubEnd()},200)}_scrubStart(){this._scrubbing||(this._scrubbing=!0)}_scrubEnd(){this._scrubbing=!1}ontimeupdate(e){if(!this.sorcerer)return!1;if(super.ontimeupdate(),this._gapJumper&&this._gapJumper.stop(),0===this.currentTime)return this._startedPlaying;if(this._timeToSeekTo)return!1;if(this._startedPlaying||(this._startedPlaying=!0),this._clearBufferAtTime&&this.currentTime>=this._clearBufferAtTime){const e=2;this.sorcerer.removeBuffer(0,this._clearBufferAtTime-e),this._clearBufferAtTime=!1}const t=this.sorcerer.getDroppedFrameTotal();this.fire(pR.DROPPED_FRAMES,t);const r=this.sorcerer.getResponseSpeeds(),n=this._streams[OD][this.sorcerer.video.activeStreamIndex],i=this._options.tests&&this._options.tests.download_bitrate;if((!i||!i.group)&&n&&this._brain.getCurrentSpeed){const e={speed:this._brain.getCurrentSpeed(),bitrate:n.avg_bitrate,speeds:r};this.fire(pR.BANDWIDTH,e)}const s=this._video.buffered.length;if(!s)return!0;const a=this._video.buffered.end(s-1);return Math.ceil(a)===Math.ceil(this._video.duration)||(Math.abs(this.currentTime-a)<.2?(this._ranIntoBuffer||(this.fire(pR.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer[OD].activeStreamIndex>0}),this._ranIntoBuffer=!0),!1):void 0)}_isEnded(){return!!this.ended||Math.ceil(this.currentTime)===Math.ceil(this._video.duration)}_loadSegmentsIntervalTick(){if(!this.sorcerer)return!1;if("closed"===this.sorcerer.readyState)return!1;if(this._video.webkitCurrentPlaybackTargetIsWireless)return!1;if(this._isEnded())return!1;if(null!==this._preloadSegmentStreamIndex){try{this._loadPreloadSegments()}catch(e){return this._handleLoadSegmentFailures(e),!1}return!0}if(0===this.currentTime&&!this._ready)return this._startedPlaying;const e=this._loadSegments();return e&&"function"==typeof e.catch&&e.catch(this._handleLoadSegmentFailures.bind(this)),!0}_handleLoadSegmentFailures(e){e.code===DOMException.INVALID_STATE_ERR?this.fire(pR.SCANNER_ERROR,{reason:e}):this.fire(pR.LOAD_SEGMENT_FAILED,new TelecineError(`${pR.LOAD_SEGMENT_FAILED} - ${e.name}`,e.message)),clearInterval(this._loadSegmentsInterval)}onprogress(){this._brain.canPlayFromTimeInStream(this.currentTime,this._getCurrentStream())&&this._ranIntoBuffer&&(this.fire(pR.STREAM_BUFFER_END),this._ranIntoBuffer=!1)}onwaiting(){return!this._gapJumper||!this._gapJumper.start()}onerror(){return!!this._video.error&&(this._video.error.code===this._video.error.MEDIA_ERR_DECODE?(this.fire(pR.SCANNER_ERROR,{reason:`encountered media decode error. Message: "${this._video.error.message}"`}),!1):this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(this._preserveCurrentTime=!0,this.fire(pR.SCANNER_ERROR,{reason:`encountered media source not supported error. Message: "${this._video.error.message}"`}),!1):super.onerror())}pause(){super.pause()}play(){return null!==this._drmSetupError?(this._fireVideoError(FR,{text:null,code:this._drmSetupError}),Promise.reject()):(this._restartLoadSegmentsIntervalWithBackoff(),super.play(()=>(this._resolveStartPreload&&this._resolveStartPreload(),(!this._reloadingExistingVideo&&!this._ready&&"auto"!==this._preload||this._video.webkitCurrentPlaybackTargetIsWireless)&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),this._onReady.then(()=>Promise.resolve(this._seekInProgressPromise)))))}onpause(){return this._ignorePauseEvent?(this._ignorePauseEvent=!1,!1):(super.onpause(),!0)}onplay(){return!this._ignorePlayEvent||(this._ignorePlayEvent=!1,!1)}_addCallbackToPromise(e,t,r=!0){let n=e.then(t);return r&&(n=this._addCatchToPromise(n)),n}_addCatchToPromise(e){return e.catch(e=>(this.fire(pR.FILE_ERROR,{reason:e}),new Promise(()=>{})))}_handleBufferForSeek(){this._ready&&this._streams[OD][this.sorcerer.video.activeStreamIndex].bitrate/1e3>12e3&&(this._removeBufferPromise=this.sorcerer.removeBuffer())}_startPreload(e,t){return new Promise(r=>{"none"!==t||this._reloadingExistingVideo&&!this.paused||"sd-fallback"===this._telecineVideo.drmHandler?.state?r(e):this._resolveStartPreload=()=>{r(e),this._resolveStartPreload=null}})}_getSeekReadyPromiseForTime(e=this._timeToSeekTo){return new Promise(t=>{const r=this._startedPlaying&&0===e,n=this._brain.canPlayFromTimeInStream(e,this._getCurrentStream());r||n?t(e):(this._handleBufferForSeek(),this._resolveSeek=t)}).then(e=>{this._timeToSeekTo=null,this._seekInProgressPromise=null;const t=new Promise((e,t)=>{this._lastSeekReject=t;const r=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",r)};this._video.addEventListener("seeked",r)});return this._video.currentTime=e,t})}_handlePreloadChanged(e,t){"auto"!==e&&"auto"===t&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),e!==t&&"none"!==t&&this._resolveStartPreload&&this._resolveStartPreload()}_avDurationDifference(e){const t=e.audio.reduce((e,t)=>e+t.duration,0),r=e.video.reduce((e,t)=>e+t.duration,0),n=t/e.audio.length,i=r/e.video.length;return n+4<i?i-n:0}_checkAVMismatch(e){if(!e.audio)return;const t=this._avDurationDifference(e);t>0&&(this._hasAudioVideoMismatch=!0,this.fire(pR.AV_DURATION_MISMATCH,t),this._audioDuration=e.audio.reduce((e,t)=>Math.max(e,t.duration),0))}_processVideoStreams(e){return new Promise(async t=>{const{compatibleStreams:r,incompatibleStreams:n,incompatibleStreamsAttributes:i}=await(async(e=[])=>{let t=e,r=[],n=[];if(Gb.mediaCapabilities)if(0===e.length)ID("No streams to check for MediaCapabilities support");else try{const i=await Promise.all(e.map(async e=>await(async e=>{let t;const r=PD(e),n=wD.get(r);if(n)return n;if(Gb.mediaCapabilities){const n=e.codecs.replace(/,.+/,""),i={type:"media-source",video:{contentType:`${e.mime_type}; codecs=${n}`,width:e.width,height:e.height,bitrate:e.bitrate,framerate:e.framerate}};t=await navigator.mediaCapabilities.decodingInfo(i),wD.set(r,t)}return t})(e)));if(i){if(t=function(e,t){return e.filter((e,r)=>AD.every(e=>t[r][e])||(ID(`Stream ${e.quality} is not supported`,t[r]),!1))}(e,i),0===t.length)return ID("No compatible streams found. Returning all available streams as safeguard."),{compatibleStreams:e,incompatibleStreams:r,incompatibleStreamsAttributes:n};t.length<e.length?(r=e.filter(e=>-1===t.indexOf(e)),n=r.map(RD),ID("Some streams are not supported. Returning compatible streams.")):ID("All streams are supported.")}}catch(e){ID("Error checking stream capabilities",e)}else ID("MediaCapabilities API not supported");return{compatibleStreams:t,incompatibleStreams:r,incompatibleStreamsAttributes:n}})(e);n.length&&(this.fire(pR.AVAILABLE_STREAMS_CHANGED),this.fire(pR.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,{incompatibleStreams:n,incompatibleStreamsAttributes:i})),t(r)})}_manifestContainsSegmentSizes(e){return e.video.every(e=>e.segments.every(e=>"size"in e))}_initializeManifest(e){return new Promise(async(t,r)=>{const{manifest:n,isConfigRefresh:i}=e;n.video||this.fire(pR.SCANNER_ERROR,{reason:"no video streams found in manifest"}),this._manifest=n,this._checkAVMismatch(n);const s=await this._processVideoStreams(n.video);this._streams[OD]=this._sortVideoStreams(s);const a=(e=>{if(!e||!e.length)return[];const t=(e=>e.filter(e=>"opus"===e.codecs&&(!e.ambisonic_order||!Gb.browser.chromium||e.ambisonic_order<=1)))(e),r=e.filter(e=>"opus"!==e.codecs);return Gb.browser.safari||Gb.iOS||Gb.iPadOS||!wb().isTypeSupported('audio/mp4; codecs="opus"')||!t.length?r:t})(n.audio);this._streams[LD]=this._sortAudioStreams(a);for(let e=0;e<this._streams[OD].length;e++){let t=0;if(n.audio){const r=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,e),n=this._streams[LD][r];n&&(t=n.avg_bitrate)}this._streams[OD][e].audioBitrate=t}i||this._initDrm(this._streams[OD],this._streams[LD],this._manifest.key_info),this._manifestContainsSegmentSizes(n)||this.resetBrain(),this.fire(pR.STREAMS_LOADED,this._streams),t()})}_setUpSorcerer(e,t){if(this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new sD(e,t),this.sorcerer.isInstanceofManagedMediaSource(this.sorcerer.mediaSource)){const t=document.createElement("source");t.type="video/mp4",t.src=URL.createObjectURL(this.sorcerer.mediaSource),e.appendChild(t);const{src:r,mime:n}=this._telecineVideo.externalDisplayFiles.AirPlay,i=document.createElement("source");i.type=n,i.src=r,e.appendChild(i)}else e.src=URL.createObjectURL(this.sorcerer.mediaSource);this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments(),this._restartLoadSegmentsIntervalWithBackoff()}_restartLoadSegmentsIntervalWithBackoff(e=!1){this._restartLoadSegmentsInterval(500),clearTimeout(this._slowLoadSegmentTimeout),this._slowLoadSegmentTimeout=setTimeout(()=>{this._restartLoadSegmentsInterval(5e3)},6e4),e&&this._loadSegmentsIntervalTick()}_restartLoadSegmentsInterval(e){clearInterval(this._loadSegmentsInterval),this._loadSegmentsInterval=setInterval(()=>{this._loadSegmentsIntervalTick()},e)}_getDuration(e=!1){let t=e?1/0:0;for(const r in this._streams)this._streams[r].length&&(t=Math[e?"min":"max"](t,this._streams[r][0].duration));return t}_initialize(e){return this._initializeManifest(e).then(()=>{this._setUpSorcerer(this._video,{duration:this._getDuration(),fetcherTimeout:8e3,fetcherRetryAbortErrors:!1,disableMMS:this._options.disableMMS}),this.sorcerer.on("srcnotsupported",()=>{this.fire(pR.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})}),this._video.addEventListener(ER,e=>{const t=!this._video.webkitCurrentPlaybackTargetIsWireless,r="closed"===this.sorcerer.readyState;t&&r&&this.fire(pR.SCANNER_ERROR,{reason:"MediaSource was closed during AirPlay, falling back to Native HLS playback."})});const e=this._getStartingStreamIndex();for(const e in this._streams)this._streams[e].forEach((t,r)=>{let n=this._getSegmentUrl(r,"init",e);this._useRangeRequests(r,e)&&this._streams[e][r].init_segment_range&&(n={url:n,byteRange:this._getRangeForSegment(r,"init",e)}),this.sorcerer.addStream(`${t.mime_type}; codecs="${this._streams[e][r].codecs}"`,n)});this.sorcerer.video.switchTo(e,!0,{reasonForSwitch:7}),this.sorcerer.on("queued",this._handleQueued.bind(this)),this.sorcerer.on("downloadabort",this._handleAborted.bind(this)),this.sorcerer.on("appendbufferend",this._handleAppendBufferEnd.bind(this)),this.sorcerer.on("downloadstart",this._handleDownloadStart.bind(this)),this.sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this.sorcerer.on("downloaderror",this._handleDownloadError.bind(this)),this.sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this.sorcerer.on("quotaexceedederror",this._handleQuotaExceededError.bind(this)),this.sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this.sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this.sorcerer.mediaSource.addEventListener("sourceended",()=>{this.fire(lR.PROGRESS)})})}_getStartingStreamIndex(){if(null!==this._preloadStreamIndex)return this._preloadStreamIndex;let e=this._streams[OD],t=this.sorcerer.video.activeStreamIndex>0?this.sorcerer.video.activeStreamIndex:0;this._restrictedStreamIndexes.length&&(e=this._restrictedStreamIndexes.map(e=>this._streams[OD][e]),t=this._restrictedStreamIndexes.includes(this.sorcerer.video.activeStreamIndex)?this._restrictedStreamIndexes.indexOf(this.sorcerer.video.activeStreamIndex):0);const r=this._brain.getCurrentSpeed();r&&(t=this._brain.getStreamFromSpeed(r,e));const n=e[t];return this._streams[OD].indexOf(n)}_sortVideoStreams(e){const t=e.slice(0);return t.sort(function(e,t){const r=e.width*e.height*e.avg_bitrate,n=t.width*t.height*t.avg_bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:r-n}),t}_sortAudioStreams(e){const t=e.slice(0);return t.sort(function(e,t){return e.avg_bitrate*e.channels-t.avg_bitrate*t.channels}),t}_useRangeRequests(e,t){return!!this._streams[t][e].segments[0].range}_getRangeForSegment(e,t,r){return"init"===t?this._streams[r][e].init_segment_range:this._streams[r][e].segments[t].range}_getSegmentPriority(e,t,r=OD){return"init"===t?0:this._streams[r][e].segments[t].start}_getSegmentUrl(e,t,r=OD,n=!1){if("init"===t&&!this._streams[r][e].init_segment_url)return function(e){return AR(e).buffer}(this._streams[r][e].init_segment);let i=this._baseUrl;const s=this._manifest.base_url&&-1!==this._manifest.base_url.indexOf("//");if(s&&(i=this._manifest.base_url),this._manifest.base_url&&!s&&(i+=this._manifest.base_url),this._streams[r][e].base_url&&(i+=this._streams[r][e].base_url),this._useRangeRequests(e,r))return i;if("init"===t)return i+=this._streams[r][e].init_segment_url,i;const a=this._streams[r][e].segments[t];a.url&&(i+=a.url);const o="akfire_interconnect_quic"===this._telecineVideo.currentFile.metadata.cdn,c=-1===i.indexOf("?")?"?":"&";return n&&this.CMCDLogger&&o&&(i+=`${c}${this.CMCDLogger.getLogAsQueryParam(a,r)}`),i}_key(e,t,r){return`${e}:${t}:${r}`}_isFinalSegment(e,t,r){return t===this._streams[r][e].segments.length-1}_getCurrentlyLoadingStreamsForSegment(e,t){const r=[],n=this._streamsForSegment[e];if(!n)return r;for(let i=0;i<n.length;i++)this._waitingOnSet.has(this._key(n[i],e,t))&&r.push(n[i]);return r}getCurrentStream(e="video"){return this._getCurrentStream(0,e)}_getCurrentStream(e=0,t=OD){return void 0!==this.sorcerer&&(e=this.sorcerer[t].activeStreamIndex),this._streams[t][e]}_getStreamIndexToLoadAndSwitchReason(e){let t=this._streams[OD];const r=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null;if(t=this._brain.filterStreams(t,this._video.clientWidth,this._video.clientHeight,r),0===t.length)return Promise.resolve({index:!1,reasonForSwitch:null});if(this._switching[OD])return Promise.resolve({index:!1,reasonForSwitch:null});const n=t[t.length-1];if(n.id!==this._lastTargetStreamId){this._lastTargetStreamId=n.id;const e={index:this._streams[OD].indexOf(n),streams:this._streams[OD]};this.fire(pR.STREAM_TARGET_CHANGE,e)}const i=this._getCurrentStream();return this._brain.shouldPowerUp(t,i,e).then(e=>!1===e.index?this._brain.shouldPowerDown(t,i).then(e=>!1===e.index?{index:e.index,reasonForSwitch:e.reasonForSwitch}:{index:this._streams[OD].indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch}):{index:this._streams[OD].indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch})}_loadSegmentsForType(e=OD){return this.sorcerer.allowSegmentRequests?this._getStreamIndexToLoadAndSwitchReason(!1).then(t=>{let{index:r,reasonForSwitch:n}=t,i={reasonForSwitch:n};e===LD&&(!1===r&&(r=this.sorcerer[OD].activeStreamIndex),r=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,r),this.sorcerer[LD].activeStreamIndex===r&&(r=!1));let s=!1;!1!==r&&(s=r>this.sorcerer[e].activeStreamIndex,this._switching[e]=!0,this.sorcerer[e].switchTo(r,!0,i).then(()=>{this._switching[e]=!1}).catch(console.error));let a=s;const o="auto"===this._preload&&!this._startedPlaying,c=this._brain.getSegmentsToLoad(a,e,this._getCurrentStream(),o),u=this.sorcerer[e].activeStreamIndex;for(let t=0;t<c.length;t++){const r=this._getSegmentUrl(u,c[t],e,!0),n=this._getCurrentlyLoadingStreamsForSegment(c[t],e);if(n.length>1)continue;if(1===n.length&&u<=n[0])continue;const i=this._isFinalSegment(u,c[t],e),s={stream:u,segment:c[t],type:e},a=this.sorcerer[e].streams[u];let o=r;this._useRangeRequests(u,e)&&(o={url:o,byteRange:this._getRangeForSegment(u,c[t],e)});const l=this._getSegmentPriority(u,c[t],e),h=e===OD;let d=null;0===u&&e===OD&&(d=16e3);let f=null;try{f=this._streams[e][u].segments[c[t]].size}catch(e){}a.addSegment(o,{identifier:s,isFinalSegment:i,priority:l,includeWithBandwidthChecks:h,timeout:d,size:f}).catch(e=>{})}}).catch(e=>{throw e}):Promise.resolve()}_loadPreloadSegments(){for(const e in this._streams){if(0===this._streams[e].length)continue;let t=0;const r=this._brain.getSegmentsToLoad(!1,e,this._getCurrentStream());r.length>0&&(t=r[0]);let n=this._preloadSegmentStreamIndex;e===LD&&(n=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,this._preloadSegmentStreamIndex));const i=this._key(n,t,e);if(this._waitingOnSet.has(i))continue;const s=this._getSegmentUrl(n,t,e),a=this._isFinalSegment(n,t,e),o=this.sorcerer[e].streams[n],c={stream:n,segment:t,type:e},u=!0;let l=s;this._useRangeRequests(n,e)&&(l={url:l,byteRange:this._getRangeForSegment(n,t,e)}),o.addSegment(l,{identifier:c,isFinalSegment:a,loadOnly:u,priority:0}).catch(e=>{})}}_loadSegments(){const e=this._video.webkitCurrentPlaybackTargetIsWireless,t="closed"===this.sorcerer.readyState;return e||t?Promise.resolve():this._onReady&&this._onReady.then(()=>{const e=[];for(const t in this._streams)this._streams[t].length>0&&e.push(this._loadSegmentsForType(t));return Promise.all(e)})}_handleQueued(e){this._waitingOnSet.add(this._key(e.stream,e.segment,e.type)),this._streamsForSegment[e.segment]||(this._streamsForSegment[e.segment]=[]),-1===this._streamsForSegment[e.segment].indexOf(e.stream)&&this._streamsForSegment[e.segment].push(e.stream)}_clearWaitingOn(e){(this._streamsForSegment[e.segment]||[]).forEach(t=>{this._waitingOnSet.delete(this._key(t,e.segment,e.type))})}_handleAborted(e){this._streamsForSegment[e.segment]&&this._clearWaitingOn(e)}_handleAppendBufferEnd(e){this.fire(pR.APPEND_BUFFER_END,{identifier:e}),this.preloadStreamIndex=null,this._restartLoadSegmentsIntervalWithBackoff(),this._checkSwitchUp&&e.stream===this._lastStreamIndex&&(this._checkSwitchUp=!1,this._clearBufferAtTime=this._streams[OD][e.stream].segments[e.segment].start),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e);const t=this._brain.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream());null!==this._timeToSeekTo&&this._resolveSeek&&t&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null),this._gapJumper&&this._gapJumper.onSegmentAppended()}_handleDownloadStart(e){this.fire(pR.DOWNLOAD_START,{identifier:e})}_handleDownloadEnd(e,t){this.fire(pR.DOWNLOAD_END,{identifier:e,data:t})}_handleDownloadError(e,t){this._clearWaitingOn(e);let r=pR.DOWNLOAD_ERROR;410===t&&(r=pR.MEDIA_URL_EXPIRED),502===t&&this.video.metadata.drm&&(r=pR.DRM_FAILURE),this.fire(r,{identifier:e,status:t})}_handleDownloadTimeout(e,t){this.fire(pR.DOWNLOAD_TIMEOUT,{identifier:e,data:t}),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e),e.type===OD?this._switching[OD]=!1:e.type===LD&&(this._switching[LD]=!1)}_handleQuotaExceededError(e){this.fire(pR.QUOTA_EXCEEDED_ERROR,{buffered:e})}_handleStreamChangeStart(e,t){const r={previousStreamIndex:this._manifest.video.indexOf(this._streams[OD][e]),index:this._manifest.video.indexOf(this._streams[OD][t]),streams:this._manifest.video};this.fire(pR.STREAM_CHANGE_START,r)}_handleStreamChange(e,t){if(!this._manifest?.video)return;e>this._lastStreamIndex&&this.currentTime>0&&(this._checkSwitchUp=!0),this._lastStreamIndex=e;const r={index:this._manifest.video.indexOf(this._streams[OD][e]),streams:this._manifest.video,metadata:t};this.fire(pR.STREAM_CHANGE,r)}_initDrm(e=[],t=[],r={}){const n=this._telecineVideo.drmHandler;if(!n)return;const i=function(e,t){const r={audio:e.map(e=>`${e.mime_type};codecs="${e.codecs}"`),video:[]};for(let e=0;e<t.length;e++){const[n,i]=t[e].codecs.split(",");r.video[e]=`${t[e].mime_type};codecs="${n}"`,i&&r.audio.push(`audio/mp4;codecs="${i}"`)}return r}(t,e);n.init(this,i,r).catch(e=>(e===XR&&(this._drmSetupError=e,this.fire(pR.NO_SUPPORTED_CDM)),Promise.reject(e))),n.setFallbackCallback(()=>{this.paused||(this._video.pause(),this.once(pR.CURRENT_FILE_CHANGE,()=>{this.play()}))})}_setupCMCDLogger(){this._options.enableCMCD&&(this.CMCDLogger=new SD(this,this._options.sessionMetadata))}_loadMediaManifest(){return import("./media-manifest.module.js")}}class MD{constructor(e){this._scanner=e,this._currentTime=0,this._latencyInterval=setInterval(this._onLatencyInterval.bind(this),500)}get latency(){return this._latency}get liveSyncPosition(){const e=this._estimateLiveEdge(),t=this._scanner.presentationDelay,r=this._scanner.getCurrentStream();return null===e||null===t||null===r?0:e-t-this.edgeStalled}get edgeStalled(){const e=this._scanner.getCurrentStream();if(!e)return 0;const t=3*(this._scanner.lowLatencyMode&&e.partTargetDuration||e.targetDuration);return Math.max(e.age-t,0)}destroy(){clearInterval(this._latencyInterval)}_onLatencyInterval(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return;this._currentTime=e.currentTime;const r=this._computeLatency();null!==r&&(this._latency=r,this._scanner.fire(_R.LATENCY_UPDATED,r),this._scanner.lowLatencyMode&&(Gb.browser.ie||Gb.browser.safari||null!==this._scanner.presentationDelay&&(e.playbackRate=1)))}_estimateLiveEdge(){const e=this._scanner.getCurrentStream();return e?e.edge+e.age:null}_computeLatency(){const e=this._estimateLiveEdge();return null===e||0===this._currentTime?null:e-this._currentTime}_getForwardBufferLength(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return 0;const r=e.buffered.length;return r?e.buffered.end(r-1):t.edge-this._currentTime}}const ND=[1,2,5];class xD extends cD{get displayName(){return"Live"}constructor(e,t={}){super(e,t),this._UPSHIFT_BANDWIDTH_THRESHOLD=.4,this._DOWNSHIFT_BANDWIDTH_THRESHOLD=.6,this.consecutiveStreamIndex={},this.isNewPlayback=!0}optimalStream(e,t){if(this.isNewPlayback){const e=this.scanner.sorcerer?.getResponseSpeeds().length;e>=2&&(this.isNewPlayback=!1)}if(1===e.length)return{index:0,reasonForSwitch:6};if(this.isNewPlayback){let t=0,r=0,n=this.scanner.videoElement.clientHeight,i=[];for(let s=0;s<e.length;s++){let a=e[s].height;i.push(a),a<n&&a>r&&(t=s,r=e[s].height)}return t=Math.max(0,t-1),{index:t,reasonForSwitch:4}}const r=this.getCurrentSpeed();let n=t,i=t;for(let t=0;t<e.length;t++)r*this._UPSHIFT_BANDWIDTH_THRESHOLD>e[t].bandwidth&&(n=t),r*this._DOWNSHIFT_BANDWIDTH_THRESHOLD>e[t].bandwidth&&(i=t);const s=t<n?n:i;this._clearConsecutiveStreamIndexes(s),this.consecutiveStreamIndex[s]++;const a=this.scanner.lowLatencyMode?.5:1.5,o=this.scanner.segmentLength*a,c=this.scanner.videoElement,u=c.buffered,l=this._options.mediaSourceScanner?.droppedFrameSwitchPercent;return u&&0!==u.length?u.end(u.length-1)-c.currentTime<o?{index:0!==t?t-1:0,reasonForSwitch:1}:t>0&&!isNaN(l)&&this.hasTooManyDroppedFrames(t,this.scanner.getCurrentStream(),l)?(this.blacklist(t),this.scanner.fire(pR.DROPPED_FRAME_PERCENT_EXCEEDED),{index:t-1,reasonForSwitch:2}):this.consecutiveStreamIndex[s]>2&&s!==t?{index:s,reasonForSwitch:3}:{index:t,reasonForSwitch:null}:{index:0,reasonForSwitch:5}}getCurrentSpeed(){return this.scanner.sorcerer?.getCurrentSpeed({type:"average",howMany:5,weights:ND})}_clearConsecutiveStreamIndexes(e){this.consecutiveStreamIndex[e]||(this.consecutiveStreamIndex[e]=0);for(const t in this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(t)&&parseInt(t,10)!==e&&(this.consecutiveStreamIndex[t]=0)}getAvailabilityStart(e,t){return this._getSegmentAvailabilityStart(e,t.edge)}getAvailabilityEnd(e,t){return this._getSegmentAvailabilityEnd(e,t.edge)}canPlayFromTimeInStream(e,t){return!!t&&this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration)}getSegmentsToLoad(e,t,r){const{currentTime:n,liveTailTime:i,sorcerer:s,bufferTarget:a,atLiveEdge:o}=this.scanner,c=s[t]?.sourceBuffer?.buffered,u=c?.length?c.start(c.length-1):0,l=eS(Math.max(n,u),c);if(!e&&l>=a)return[];const h=Math.max(n,i),d=o?r.edge:h,f=this._getSegmentAvailabilityStart(d,r.edge),p=this._getSegmentAvailabilityEnd(d,r.edge),_=this.scanner.lowLatencyMode&&r.parts?.length,v=[...r.segments,...r.parts??[]],m=(_?r.parts:v).filter(t=>!!t.uri&&(e||!this.scanner.isSegmentAdded(t))&&!(t.end<f||t.start>p));return _&&m.forEach((e,t)=>{for(;e=e.dependentOn;)m.includes(e)||this.scanner.isStreamSegmentAdded(e)||m.splice(t,0,e)}),s[t].activeStreamIndex,m}_getSegmentAvailabilityStart(e,t){const r=t-this._getPresentationDelay();return Math.max(0,Math.min(e,r))}_getSegmentAvailabilityEnd(e,t){const r=e+this.scanner.bufferTarget;return Math.min(r,t)}_getPresentationDelay(){return this.scanner.presentationDelay||this.scanner.manifest.presentationDelay}}const UD=["disabled","hidden","showing"],FD=["subtitles","captions","descriptions","chapters","metadata"],VD=["ar","fa","he","iw","ku","ps","sd","ur","yi"],jD=new WeakMap,BD=new WeakMap;class TelecineTextTrack extends nw{constructor({kind:e,src:t=null,label:r="",language:n="",id:i=oS(),provenance:s=""},a){if(super(),-1===FD.indexOf(e))throw NR(12,"SYNTAX_ERR","Syntax Error");Object.defineProperties(this,{kind:{value:e,enumerable:!0},label:{value:r,enumerable:!0},language:{value:n,enumerable:!0},id:{value:`${i}`,enumerable:!0},rtl:{value:-1!==VD.indexOf(n.substr(0,2)),enumerable:!0},provenance:{value:s,enumerable:!0}}),this.video=a,this.src=t,this._modeHasBeenSet=!1,jD.set(this,"disabled")}dispatchEvent(e){this.fire(e,{target:this})}get mode(){return jD.get(this)}set mode(e){if(UD.indexOf(e)>-1){if(this._modeHasBeenSet=!0,jD.get(this)===e)return;jD.set(this,e),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,e),this.dispatchEvent("modechange")}}get src(){return BD.get(this)}set src(e){BD.set(this,e),this.video.fire(pR.TEXT_SRC_UPDATE,this)}get cues(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}get activeCues(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}get trackElement(){return document.getElementById(`telecine-track-${this.id}`)}}function HD(e){var t=/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/.exec(e);if(!t)return-1;var r=parseInt(t[4],10)/1e3;return r+=parseInt(t[3],10),t[2]&&(r+=60*parseInt(t[2],10)),t[1]&&(r+=60*parseInt(t[1],10)*60),r}function XD(e){var t=0,r=e.split(/(?:(?:\r\n|\n){2,})/),n=[],i=null;do{0===t&&/^\uFEFF?WEBVTT(?: .*)?/.test(r[t])&&t++,(i=/^(?:(.*)(?:\r\n|\n))?([\d:,.]+) --> ([\d:,.]+)(.*)?(?:\r\n|\n)([\s\S]*)/.exec(r[t]))&&n.push({startTime:HD(i[2]),endTime:HD(i[3]),text:i[5]}),t++}while(t<r.length);return n}const WD=Gb.browser.ie||Gb.browser.edge?.5:.2,qD=8e3;class GD extends JR{static get displayName(){return"HLSLiveScanner"}static get supportsMse(){return!0}static get supportsLive(){return!0}static supported(e){const t=wb(e);return void 0!==t&&t.isTypeSupported}static get supportedVideoTypes(){return[ab.hlsLive]}constructor(e,t={}){super(e,t),this._playInitiated=!1,this._captionsVisible=!1,this._captionsLoading=!1,this._atLiveEdge=!0,this._atLiveTail=!1,this._STREAM_SWITCH_CHECK_INTERVAL=2e3,this._DOWN_SHIFT_CHECK_INTERVAL=1e4,this.reset(),this.defaultPresentationDelay=t.presentationDelay??(t.lowLatencyMode?3:12),this.defaultBufferTarget=t.lowLatencyMode?3:12,this.bufferTarget=this.defaultBufferTarget,this.presentationDelay=this.defaultPresentationDelay,this.lowLatencyMode=t.lowLatencyMode??!1,this.disableDeltaUpdates=t.disableDeltaUpdates??!1,this._preloadStreamIndex=null,Object.defineProperty(this,"eventIsLowLatency",{value:t.lowLatencyMode??!1,writable:!1}),Object.defineProperty(this,"eventHasDVREnabled",{value:t.dvrEnabled??!1,writable:!1}),this._timeoutTest=this._options.tests?.llhls_timeout?.group,window.addEventListener("online",()=>{this.play()})}deactivate(){super.deactivate(),this.reset()}reset(){this._sorcerer?.destroy(),this._manifestLoader?.stop(),this._latencyController?.destroy(),this._videoReady=Zb(),this._sorcerer=null,this._streams={},this._streams.video=[],this._streams.audio=[],this._lastStreamIndex=0,this._isOnline=!1,this._hasLiveEventEnded=!1,this._timeSinceLastStreamSwitchCheck=0,this._timeSinceLastDownShift=Number.NEGATIVE_INFINITY,this._lastStallCurrentTime=-1,this._timeToSeekTo=null,this._resolveSeek=null,this._abr=new xD(this,this._options),this._latencyController=new MD(this),this._restrictedStreamIndexes=[],this._preloadStreamIndex=null,this._switching={},this._segmentsAdded={},this._captionsAddedToTextTrack={},this._captionsAddedToTranscript={},this._fetchedCues={}}endLive(){this._isOnline=!1,this._hasLiveEventEnded=!0,this.eventHasDVREnabled&&!this.atLiveEdge||(this._manifestLoader?.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._sorcerer.endOfStream()),this.eventHasDVREnabled||super.deactivate(),this.fire(lR.ENDED))}_signalOnline(){this._isOnline||(this._isOnline=!0,this.fire(_R.STREAM_ONLINE))}_signalOffline(){this._isOnline&&(this._isOnline=!1,this.fire(_R.STREAM_OFFLINE))}_setConnection(e){e?this._signalOnline():this._signalOffline()}async _loadManifest(e){if(this._hasLiveEventEnded)return;this._manifestLoader&&(this._manifestLoader.stop(),this._manifestLoader.off());let t=[this._loadMediaManifest()];this.video.metadata.p2pReady&&t.push(this.video.metadata.p2pReady);const[r]=await Promise.allSettled(t),{M3U8Loader:n,PLAYLIST_UPDATE:i,PLAYLIST_ERROR:s,convertTsCodecs:a}=r.value;this._manifestLoader=new n({disableDeltaUpdates:this.disableDeltaUpdates}),this._manifestLoader.lowLatencyMode=this.lowLatencyMode,this._manifestLoader.dvrEnabled=this.eventHasDVREnabled,this._manifestLoader.on(i,this._onPlaylistUpdate.bind(this)),this._manifestLoader.on(s,e=>{this._signalOffline()});try{const t=this.video.metadata.playlistRefreshUrl;this._manifest=await this._manifestLoader.start(e,t),this._signalOnline()}catch(e){throw this._signalOffline(),this.endLive(),e}this._streams.video=KD(function(e){return e.filter(t=>t.codecs.split(".")[0]===e[0].codecs.split(".")[0])}(function(e){const t=e.slice(0);return t.sort(function(e,t){const r=e.width*e.height*e.avg_bitrate,n=t.width*t.height*t.avg_bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:r-n}),t}(this._manifest.video))),this._streams.audio=KD(eb(tb(this._streams.video,({audio:e})=>e)));const{index:o,reasonForSwitch:c}=this._getStream("video",!0);let u={reasonForSwitch:c};await this._manifestLoader.switchTo("video",o);let l,h=[];if(this._streams.audio.length){let{index:e}=this._getStream("audio",!0);l=e,h.push(this._manifestLoader.switchTo("audio",l))}if(this.manifest.captions&&this.manifest.captions.length>0){const{index:e}=this._getStream("subtitles",!0);h.push(this._manifestLoader.switchTo("subtitles",e))}await Promise.all(h),this._sorcerer?.destroy(),this._sorcerer=new sD(this._video,{fetcherRetryAbortErrors:!1,fetcherTimeout:qD,disableMMS:this._options.disableMMS}),this._sorcerer.initFrameDropper(),this._streams.video.forEach(e=>{this._sorcerer.addStream(a(IR(this._manifestLoader.activeStream("video").mimeType,e.codecs)),e.initSegment)}),this._streams.audio.forEach(e=>{this._sorcerer.addStream(a(IR(this._manifestLoader.activeStream("audio").mimeType,e.codecs)),e.initSegment)}),this.fire(pR.STREAMS_LOADED,this._streams),this.manifest.captions&&this.manifest.captions.length>0&&(this.manifest.captions.forEach(this._loadTextTrack.bind(this)),this.fire(pR.TEXT_TRACKS_AVAILABLE)),this._setUpMediaSorcererEvents(),this._sorcerer.video.switchTo(o,!1,u),this._streams.audio.length&&this._sorcerer.audio?.switchTo(l,!1)}async _refreshManifest(){try{await this._manifestLoader.update(),this._signalOnline()}catch(e){this._signalOffline()}}_setUpMediaSorcererEvents(){this._sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this._sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this._sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this._sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this._sorcerer.on("downloadabort",this._handleDownloadAbort.bind(this)),this._sorcerer.on("appendbufferend",this._handleBufferAppend.bind(this))}_handleDownloadEnd(e,t){if(e&&e.isInitSegmentRequest)return;const r=this._getCurrentStream();t.extraContext={liveAvail:{start:this._abr.getAvailabilityStart(this.currentTime,r),end:this._abr.getAvailabilityEnd(this.currentTime,r)}},this.fire(pR.DOWNLOAD_END,{identifier:e,data:t})}_handleDownloadTimeout(e,t){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e),this._switching[e.type]=!1,this.fire(pR.DOWNLOAD_TIMEOUT,{identifier:e,data:t}))}_handleDownloadAbort(e){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e))}_handleStreamChangeStart(e,t){const r={previousStreamIndex:this._streams.video.indexOf(this._streams.video[e]),index:this._streams.video.indexOf(this._streams.video[t]),streams:this._streams.video};this.fire(pR.STREAM_CHANGE_START,r)}_handleStreamChange(e,t={}){this.fire(pR.STREAM_CHANGE,{index:e,streams:this._streams.video,metadata:t})}_firstBufferAheadIndex(e,t){for(let r=0;r<t?.length;r++)if(t.start(r)>e)return r}_handleBufferAppend(e){const{type:t,stream:r}=e,n=this.sorcerer[t].sourceBuffer.buffered,i=this._getSegmentById(e);if(i&&n.length&&(this._streams[t][r].playlist.timeOffset=n.end(n.length-1)-(i.end-i.timeOffset)),null===this._timeToSeekTo||!this._resolveSeek)return;const s=this._firstBufferAheadIndex(this.currentTime,n),a=n?.start(s)??0,o=eS(a,n);if(void 0!==s&&o>this.bufferTarget)return Number((a-this.currentTime).toFixed(3)),void(this.currentTime=a);this._timeToSeekTo<this.liveTailTime&&(this._timeToSeekTo=this.liveTailTime),this._abr.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream())&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null)}_key({type:e,segment:t,part:r}){return`${e}_${t}_${r}`}_getSegmentById({type:e,stream:t,segment:r,part:n}){const i=this._streams[e][t].getSegmentBySN(r);return i?.getPart(n)||i}_clearSegment(e){if(e.part>0){const t={...e,part:e.part-1};this._clearSegment(t)}const t=this._key(e);delete this._segmentsAdded[t]}isSegmentAdded(e){return!!this._segmentsAdded[this._key(e)]}isStreamSegmentAdded(e){const t=this._key(e),r=this._sorcerer[e.type].activeStreamIndex;return!!this._segmentsAdded[t]&&this._segmentsAdded[t].stream===r}async _onPlaylistUpdate(e,t){const{type:r}=e;if(this.eventHasDVREnabled&&this._sorcerer?.setLiveSeekableRange(this.liveTailTime,this.liveEdgeTime),this.fire(pR.STREAM_UPDATED,e),"subtitles"===r)return void((this._captionsVisible||this._captionsLoading)&&this.manifest.captions?.length>0&&this._addTextTrackCue());t||this._loadSegmentsForType(r);const n=this._hasNewSegments(r)||!this._atDurationEnd();this._setConnection(n),this._checkForPlaybackGap(),(this.lowLatencyMode||this.video.metadata.p2pReady)&&this._checkForPlaybackStall()}_loadTextTrack({label:e,language:t},r){if(!this._captionsTrack){const n=new TelecineTextTrack({label:e,id:r,kind:"captions",language:t},this._telecineVideo);this._telecineVideo.textTracks=SR([n]),this._captionsTrack=this.addTextTrack(n)}}_getSegmentIdentifier(e){return`${e.type}_${e.mediaSequenceNumber}`}_getVideoTimeOffset(){return this._getCurrentStream("video").playlist.timeOffset}_shouldAddSegmentCuesToTextTrack(e){const t=this._getSegmentIdentifier(e),r=this._captionsAddedToTextTrack[t],n=this._getVideoTimeOffset(),i=e.end+n>=this.currentTime&&e.start+n<=this.currentTime+this.bufferTarget;return this._captionsVisible&&!r&&i}_shouldAddSegmentCuesToTranscript(e){const t=this._getSegmentIdentifier(e),r=this._captionsAddedToTranscript[t],n=this._getVideoTimeOffset(),i=e.end+n>=this.liveEdgeTime-e.duration&&e.start+n<=this.liveEdgeTime+this.bufferTarget;return this._captionsLoading&&!r&&i}async _getSegmentCues(e){const t=this._getSegmentIdentifier(e);if(!this._fetchedCues[t]){const r=await yS(e.url).text(),n=XD(r),i=function(e){const t=e.match(/=MPEGTS:(\d+),/);return(t&&t[1]||0)/9e4}(r),s=n.map(e=>(e.startTime=i+e.startTime,e.endTime=i+e.endTime,new(window.VTTCue||window.TextTrackCue)(e.startTime,e.endTime,e.text)));this._fetchedCues[t]=s}return this._fetchedCues[t]}async _addTextTrackCue(){await this._videoReady,this.manifest.captions&&this.manifest.captions[0].segments.forEach(async e=>{const t=this._getSegmentIdentifier(e),r=this._shouldAddSegmentCuesToTextTrack(e),n=this._shouldAddSegmentCuesToTranscript(e);if(r||n){const i=await this._getSegmentCues(e);r&&(this._captionsAddedToTextTrack[t]=!0,i.forEach(e=>{this._captionsTrack.addCue(e)})),n&&(this._captionsAddedToTranscript[t]=!0,this.fire(pR.SEGMENT_CUES_LOADED,i))}})}_hasNewSegments(e){const t=this._getCurrentStream(e),r=3*(this.lowLatencyMode?3:1);return t.playlist?.misses<r}async _loadSegments(){await this._videoReady;const e=this._video.webkitCurrentPlaybackTargetIsWireless,t="closed"===this._sorcerer.readyState;if(!e&&!t)for(const e in this._streams)this._streams[e].length>0&&this._loadSegmentsForType(e)}async _loadSegmentsForType(e){if(await this._videoReady,!this._sorcerer.allowSegmentRequests)return;const{index:t,reasonForSwitch:r}=this._getStream(e);let n;if(t>=0&&t!==this.sorcerer[e].activeStreamIndex){n=t>this.sorcerer[e].activeStreamIndex,this._switching[e]=!0,await this._manifestLoader.switchTo(e,t);let i={reasonForSwitch:r};this.sorcerer[e].switchTo(t,!0,i).then(()=>{this._switching[e]=!1}).catch(console.error)}await ob(0);const i=this.lowLatencyMode&&void 0!==n,s=this._sorcerer[e].activeStreamIndex,a=this._getCurrentStream(e,s),o=this._abr.getSegmentsToLoad(i,e,a),c=this._getSegmentTimeoutMs();o.forEach(t=>{const r=this._key(t),n={type:e,stream:s,segment:t.segment,part:t.part},i="video"===e&&!t.hint;let o=c;if(t.hint&&this._playInitiated&&t.start>this.currentTime){const e=1e3*(t.start-this.currentTime);o=Math.min(qD,e+c)}const u=a.avg_bitrate/8*t.duration,l=this.sorcerer[e].streams[s],h=this._preventExpiredSegmentUsage(t);l.addSegment(h,{identifier:n,includeWithBandwidthChecks:i,priority:t.programDateTime,excludeConnectTime:this.lowLatencyMode,timeout:this._timeoutTest||this.lowLatencyMode?o:qD,size:this._timeoutTest||this.lowLatencyMode?u:void 0}).catch(e=>{e instanceof eP||e instanceof uS||this._clearSegment(n)}),this._segmentsAdded[r]=n})}_preventExpiredSegmentUsage(e){let t=e?.url;const r=this._manifestLoader?.baseUrl;return r&&t&&!t.startsWith(r)&&(t=`${r}${e.uri}`),t}_getStream(e,t=!1){let r;if(this._switching[e])return{index:-1,reasonForSwitch:null};if("subtitles"===e)return r=this._manifestLoader.activeStream("video"),{index:r.subtitles[r.currentRenditions.subtitles].index,reasonForSwitch:null};if("audio"===e)return r=this._manifestLoader.activeStream("video"),{index:r.audio[r.currentRenditions.audio].index,reasonForSwitch:null};if(!t&&sS(this._timeSinceLastStreamSwitchCheck)<this._STREAM_SWITCH_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:null};this._timeSinceLastStreamSwitchCheck=rS();const n=this.video?.metadata?.percentShown,i=this._abr.filterStreams(this._streams.video,this._video.clientWidth,this._video.clientHeight,n);if(0===i.length)return{index:this._lastStreamIndex,reasonForSwitch:null};const{index:s,reasonForSwitch:a}=this._abr.optimalStream(i,this._lastStreamIndex),o=i[s],c=this._streams.video.indexOf(o);if(c>=0&&(t||c!==this._lastStreamIndex)){if(c>this._lastStreamIndex&&sS(this._timeSinceLastDownShift)<this._DOWN_SHIFT_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:a};c<this._lastStreamIndex&&(this._timeSinceLastDownShift=rS());const e={index:c,streams:this._streams.video};return this.fire(pR.STREAM_TARGET_CHANGE,e),this._lastStreamIndex=c,{index:c,reasonForSwitch:a}}return{index:this._lastStreamIndex,reasonForSwitch:a}}getCurrentStream(e="video"){return this._getCurrentStream(e)}_getCurrentStream(e="video",t=0){return void 0!==this._sorcerer&&null!==this._sorcerer&&(t=this._sorcerer[e].activeStreamIndex),this._streams[e][t]}_checkForPlaybackStall(){if(this._video.currentTime===this._lastStallCurrentTime&&rS()-this._lastStallCheckTime>=1e3&&this._shouldBeMakingProgress()){const e=`Jumping forward 0.1s because of stall at time of ${this._video.currentTime}`;this.fire(_R.STALL_JUMP,{msg:e}),this._video.currentTime+=.1}this._lastStallCurrentTime=this._video.currentTime,this._lastStallCheckTime=rS()}_shouldBeMakingProgress(){return this._video.readyState!==this._video.HAVE_NOTHING&&!!this._video.buffered.length&&!this._video.paused&&this._hasContentFor(this._video.buffered,this._video.currentTime)}_hasContentFor(e,t){for(let r=0;r<e.length;r++)if(!(t<e.start(r)-.1||t>e.end(r)-.5))return!0;return!1}_checkForPlaybackGap(){const e=this.buffered;if(!e.length)return;const t=e.length,r=this._video.currentTime;let n,i,s,a;try{n=function(e,t){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;let r;for(let n=0;n<e.length;n++)if(e.start(n)>t&&(0===n||e.end(n-1)-t<=.5)){r=n;break}return r>=0?r:null}(e,r)}catch(e){throw DOMException,e}if(null===n)return;if(this._video.readyState===this._video.HAVE_NOTHING)return;if(this._video.paused)return;if(t<=n)return;try{i=e.start(n),s=e.end(t-1)}catch(e){throw DOMException,e}const o=i-r,c=s-i,u=this.lowLatencyMode?1:2;if(c>0&&c<=this.segmentLength*u)return a=`Preventing jump too close to buffered end time. Would have jumped to: ${i}. Last buffered end time ${s}.`,void this.fire(_R.BUFFER_GAP_JUMP_PREVENT,{msg:a});0===n?(a=`Jumping forward ${o} seconds because of gap before start time of ${i}`,this.fire(_R.BUFFER_GAP_JUMP,{msg:a})):(a=`Jumping forward ${o} seconds because of gap starting at ${e.end(n-1)} and ending at ${i}`,this.fire(_R.BUFFER_GAP_JUMP,{msg:a})),this._video.currentTime=i+.1}_atDurationEnd(){const e=this.buffered;return!!(e&&e.length&&this._video.currentTime+WD>e.end(e.length-1))}async setVideoSrc(e){if(await this._startPreload(this._preload),await this._loadManifest(e),this.sorcerer.isInstanceofManagedMediaSource(this.sorcerer.mediaSource)){const e=document.createElement("source");e.type="video/mp4",e.src=URL.createObjectURL(this.sorcerer.mediaSource),this._video.appendChild(e);let{src:t,mime:r}=this._telecineVideo.externalDisplayFiles.AirPlay;const n=document.createElement("source");n.type=r,n.src=await mb(t),this._video.appendChild(n)}else this._video.src=URL.createObjectURL(this.sorcerer.mediaSource);this._videoReady.resolve()}get preload(){return this._preload}set preload(e){this._preload!==e&&"none"!==e&&this._preloadReady.resolve(),this._preload=e}async _startPreload(e){return this._preloadReady=Zb(),"none"===e&&this.paused||this._preloadReady.resolve(),this._preloadReady}get latency(){return this._latencyController?.latency}get lowLatencyMode(){return this._lowLatencyMode}set lowLatencyMode(e){this._lowLatencyMode=e,this._manifestLoader&&(this._manifestLoader.lowLatencyMode=e)}get downloadSpeed(){return this._abr.getCurrentSpeed()}getBitrateAtTime(e,t="video",r="average"){if(!this._sorcerer)return 0;const n=this._sorcerer.streamIndexAtTime(e,t),i=this._streams[t][n];return i?i["average"===r?"avg_bitrate":"bitrate"]??i.bitrate:0}onprogress(){this._checkForPlaybackGap()}ondurationchange(){this._checkForPlaybackGap()}ontimeupdate(){if(!this._sorcerer)return;if(super.ontimeupdate(),null!==this._timeToSeekTo)return;this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1),this.fire(pR.DROPPED_FRAMES,this._sorcerer.getDroppedFrameTotal());const e=this._getCurrentStream();if(e){const t={speed:this._abr.getCurrentSpeed(),bitrate:e.avg_bitrate,speeds:this._sorcerer.getResponseSpeeds()};this.fire(pR.BANDWIDTH,t)}!this._isOnline&&this._atDurationEnd()&&this.fire(_R.STREAM_OFFLINE),!this.lowLatencyMode&&sS(this._timeSinceLastStreamSwitchCheck)>this._STREAM_SWITCH_CHECK_INTERVAL&&this._loadSegments()}get restrictedStreamIndexes(){return this._restrictedStreamIndexes}set restrictedStreamIndexes(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._abr.lock(this._restrictedStreamIndexes))}get preloadStreamIndex(){return this._preloadStreamIndex}set preloadStreamIndex(e){this._preloadStreamIndex=e;const t=null!==e?[this._preloadStreamIndex]:this._restrictedStreamIndexes;this._abr.lock(t)}get videoWidth(){return this._stream?this._stream.width:this._video.videoWidth}get videoHeight(){return this._stream?this._stream.height:this._video.videoHeight}get currentTime(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime}set currentTime(e){this._video.readyState<=this._video.HAVE_NOTHING||(this.eventHasDVREnabled&&this._playInitiated?this._shouldSnapToLiveEdge(e)?(this.atLiveEdge=!0,this.seekToTime(this.liveEdgeTime)):(this.atLiveEdge=!1,this.seekToTime(Math.max(e,this.liveTailTime))):this._video.currentTime=e)}get liveEdgeTime(){return this._latencyController.liveSyncPosition}get atLiveEdge(){return this._atLiveEdge}set atLiveEdge(e){this.atLiveEdge!==e&&this.eventHasDVREnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1),this.lowLatencyMode=!!this.eventIsLowLatency&&e,this.bufferTarget=e?this.defaultBufferTarget:18,e&&(this.presentationDelay=this.defaultPresentationDelay))}get atLiveTail(){return this._atLiveTail}set atLiveTail(e){this.atLiveTail!==e&&this.eventHasDVREnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}get liveTailTime(){const e=this._getCurrentStream()?.segments?.[0]?.start??0;return Math.max(e,0)}get ended(){return this._hasLiveEventEnded}get isLowerProfileAvailable(){return this._sorcerer?this._sorcerer.video.activeStreamIndex>0:null}get sorcerer(){return this._sorcerer}get segmentLength(){return this.lowLatencyMode&&this._manifestLoader?.activeStream("video")?.partTargetDuration||this._manifestLoader?.activeStream("video")?.targetDuration}_shouldSnapToLiveEdge(e){return e>=this.liveEdgeTime-1*this.segmentLength}_hasDriftedBehindLiveEdge(e){return e>=this.liveEdgeTime-2*this.segmentLength}_isNearLiveTail(e){return e<=this.liveTailTime+2*this.segmentLength}_getSeekReadyPromiseForTime(e=this._timeToSeekTo){return new Promise(t=>{this._abr.canPlayFromTimeInStream(e,this._getCurrentStream())?t(e):this._resolveSeek=t}).then(e=>(this._timeToSeekTo=null,this._seekInProgressPromise=null,this._video.currentTime=e,new Promise((e,t)=>{this._lastSeekReject=t;const r=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",r)};this._video.addEventListener("seeked",r)})))}seekToTime(e){if(!this.eventHasDVREnabled||e===this.currentTime)return Promise.resolve();let t;if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,!this._abr.canPlayFromTimeInStream(e,this._getCurrentStream()))try{this._segmentsAdded={};for(const e in this._streams)if(this._streams[e].length>0){const t=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[t].abort()}t=this._sorcerer.removeBuffer()}catch(e){}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._videoReady,t]).then(()=>(this._loadSegments(),this._seekInProgressPromise)).catch(e=>{})}onpause(){super.onpause(),this.eventHasDVREnabled?this.atLiveEdge=!1:(this._manifestLoader?.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._segmentsAdded={},this._sorcerer.removeBuffer().catch(()=>{})))}onplay(){this.eventHasDVREnabled||this._playInitiated&&this._refreshManifest()}pause(){this.eventHasDVREnabled&&(this.atLiveEdge=!1),super.pause()}play(){return super.play(async()=>{if(this._preloadReady.resolve(),null!==this._timeToSeekTo)return Promise.resolve(this._seekInProgressPromise);if(this._playInitiated&&!this.eventHasDVREnabled){this._segmentsAdded={};try{await this._sorcerer.removeBuffer()}catch(e){}await this._refreshManifest()}await this._videoReady,this._loadSegments(),await this._bufferAvailable();const e=Math.max(this._latencyController.liveSyncPosition,this._video.buffered.start(0));return this._atLiveEdge?this.currentTime=e:this.currentTime=this._video.currentTime,this._playInitiated=!0,Promise.resolve()})}_bufferAvailable(){return new Promise(e=>{const t=()=>{this.buffered.length&&(this._sorcerer.off("appendbufferend",t),this.preloadStreamIndex=null,e())};this._sorcerer.on("appendbufferend",t),t()})}_getSegmentTimeoutMs(){return this._abr.getSegmentRelativeTimeout(this._streams.video,this._getCurrentStream("video"),1e3*this.segmentLength)}_loadMediaManifest(){return import("./media-manifest.module.js")}setCaptionsShouldDisplay(e){this._captionsVisible=e}setCaptionsShouldLoad(e){this._captionsLoading=e}}function KD(e){return e.forEach((e,t)=>{e.index=t}),e}function YD(e,t){return e.bitrate-t.bitrate}const zD=(e,t)=>({audio:e.map((t,r)=>({...t,avg_bitrate:t.bitrate,codec:t.audioCodec,codecs:t.audioCodec,id:t.attrs.URI,index:e.length-r,isDefault:t.default,label:t.name,language:t.attrs.LANGUAGE,segments:[],type:t.attrs.TYPE??"audio",uri:t.attrs.URI})).sort(YD),video:t.map((e,r)=>({...e,avg_bitrate:e.bitrate,bitrate:e.bitrate,codec:e.videoCodec,codecs:e.videoCodec,framerate:parseInt(e.attrs["FRAME-RATE"]),height:e.height,id:r,index:t.length-r,label:e.name||`${e.height}p`,segments:[],width:e.width})).sort(YD)});function $D(e){const t={},r=e.split("\r\n").map(e=>e?.trim()).filter(Boolean);for(const e of r){const[r,n]=e.split(": ");t[r]=n}return t}function JD(e){return e.characteristics?.includes("public.machine-generated")?"PROVENANCE_AI_GENERATED":e.characteristics?.includes("com.vimeo.provenance.user-uploaded-machine-generated")?"PROVENANCE_USER_UPLOADED_AI_GENERATED":"PROVENANCE_USER_UPLOADED"}function QD(e){let t="translation";return e.default?t="main":e.characteristics?.includes("public.accessibility.describes-video")?t="descriptions":e.characteristics?.includes("public.auxiliary-content")&&(t="commentary"),t}function ZD(e,t){return Array.from(e).indexOf(t)}class eO extends nw{static get displayName(){return"HlsJsScanner"}static get supportsMse(){return!0}static get supportsLive(){return!0}static get hlsJsVersion(){return window.Hls?.version}static supported(e){return window.Hls?.isSupported()}static get supportedVideoTypes(){return[ab.hlsLive]}static get supportsAudioTracksFromScanner(){return!0}constructor(e,t){super(),ew(this,"_airPlayAvailable",void 0),ew(this,"_airPlayVideoElement",void 0),ew(this,"_brain",void 0),ew(this,"_captionsLoading",void 0),ew(this,"_captionsTrack",void 0),ew(this,"_captionsVisible",void 0),ew(this,"_currentFile",void 0),ew(this,"_customLoader",void 0),ew(this,"_debugMode",void 0),ew(this,"_eventHandlers",void 0),ew(this,"_eventStartTimeOffset",void 0),ew(this,"_externalDisplayActivated",void 0),ew(this,"_files",void 0),ew(this,"_hls",void 0),ew(this,"_hlsConfig",void 0),ew(this,"_hlsEventHandlers",void 0),ew(this,"_listenerAirPlay",void 0),ew(this,"_listenerCaptionsCue",void 0),ew(this,"_listenerWebKitFullscreenEnter",void 0),ew(this,"_listenerWebKitFullscreenExit",void 0),ew(this,"_options",void 0),ew(this,"_originalVideo",void 0),ew(this,"_playerInViewTracker",void 0),ew(this,"_pollingTimeoutId",void 0),ew(this,"_preload",void 0),ew(this,"_streamOnline",void 0),ew(this,"_hasLiveEventEnded",void 0),ew(this,"_streams",void 0),ew(this,"_telecineVideo",void 0),ew(this,"_totalFrames",void 0),ew(this,"_video",void 0),ew(this,"_videoWrapper",void 0),ew(this,"_AirPlayListenerAvailability",void 0),ew(this,"_AirPlayListenerLoadedMetadata",void 0),ew(this,"_AirPlayListenerTarget",void 0),ew(this,"hlsJsError",(e,t)=>{this.fire(pR.HLS_JS_ERROR,t),this._hasLiveEventEnded?this.updateStreamStatus(_R.STREAM_ENDED):t.fatal&&this._handleFatalError(t.type)}),ew(this,"handleManifestLoaded",(e,t)=>{this._streams=zD(t.audioTracks,t.levels),this.fire(pR.STREAMS_LOADED,this._streams),this.updateStreamStatus(_R.STREAM_ONLINE),this._loadAirPlayMetadata().catch(e=>{})}),ew(this,"handleLevelLoaded",(e,t)=>{let r="";-1===this._hls.currentLevel&&this._onStreamChange(t),0===this._eventStartTimeOffset&&this._setEventStartTimeOffset();const n=this._options.lowLatencyMode?9:3,i=t.details.misses<n;this._streamOnline&&!i&&this.updateStreamStatus(_R.STREAM_OFFLINE),!this._streamOnline&&i&&this.updateStreamStatus(_R.STREAM_ONLINE),t.details.live||this._hasLiveEventEnded||this.handleLiveEventEnded()}),ew(this,"handleLevelSwitched",(e,t)=>{this._onStreamChange(t)}),ew(this,"_onStreamChange",e=>{const t=this._streams.video.findIndex(t=>t.bitrate===this._hls.levels[e.level].bitrate);this.fire(pR.STREAM_CHANGE,{index:t,streams:this._streams.video,metadata:null})}),ew(this,"handleFPSDrop",(e,{currentDropped:t,currentDecoded:r,totalDroppedFrames:n})=>{this._totalFrames=this._totalFrames+t+r,this.fire(pR.DROPPED_FRAMES,{dropped:n,total:this._totalFrames})}),ew(this,"handleNonNativeTextTracksFound",(e,t)=>{t.tracks.forEach((e,t)=>this.loadTextTrack(e.label,e.subtitleTrack?.lang,t)),this.fire(pR.TEXT_TRACKS_AVAILABLE)}),ew(this,"handleCuesParsed",(e,t)=>{t.cues&&(this._video.textTracks.length>0&&t.cues.forEach(e=>{this._video.textTracks[0].cues.getCueById(e.id)||this._video.textTracks[0].addCue(e)}),(this._captionsVisible||this._captionsLoading)&&this.fire(pR.SEGMENT_CUES_LOADED,t.cues))}),ew(this,"handleFragmentLoaded",(e,t)=>{const{frag:r}=t;if(!r)return;const n=this.getCurrentStream("video");n&&this.fire(pR.BANDWIDTH,{speed:this._hls?.bandwidthEstimate||0,bitrate:n.avg_bitrate||0});const i=t.networkDetails?.getAllResponseHeaders?.();this.fire(pR.DOWNLOAD_END,(({frag:e,liveEdge:t,liveTail:r,headers:n})=>({identifier:{type:"main"===e.type?"video":e.type,stream:e.level,segment:e.sn},data:{request:{data:{url:e.url,duration:e.stats?.loading.end-e.stats?.loading.start}},response:{headers:n?$D(n):{},arrayBuffer:()=>({byteLength:e.byteLength})},extraContext:{liveAvail:{start:r,end:t}}}}))({frag:r,liveEdge:this.liveEdgeTime,liveTail:this.liveTailTime,headers:i}))}),ew(this,"handleAudioTracksUpdated",(e,t)=>{this.fire(pR.AUDIO_TRACK_CHANGED)}),ew(this,"handleBufferAppended",(e,t)=>{const r="initSegment"===t?.frag?.sn;"video"!==t.type||r||null===this.preloadStreamIndex||(this.preloadStreamIndex=null)}),this._videoWrapper=e,this._options=t,this._video=e.querySelector("video"),this._airPlayAvailable=!1,this._airPlayVideoElement=null,this._captionsLoading=!1,this._captionsTrack=null,this._captionsVisible=!1,this._currentFile=null,this._customLoader=null,this._debugMode=this._options.hlsJsDebugMode??null,this._eventHandlers={},this._eventStartTimeOffset=0,this._externalDisplayActivated=!1,this._files=[],this._hls=null,this._hlsEventHandlers={},this._listenerAirPlay=null,this._listenerCaptionsCue=null,this._listenerWebKitFullscreenEnter=null,this._listenerWebKitFullscreenExit=null,this._originalVideo=this._video,this._playerInViewTracker=null,this._streamOnline=!1,this._hasLiveEventEnded=!1,this._telecineVideo=null,this._totalFrames=0,this._streams={video:[],audio:[]},this._video||(this._video=document.createElement("video"),this._video.preload="none",this._videoWrapper.appendChild(this._video)),this._updatePlayRequestVideo(),this.reactivate()}deactivate(){this._detachEventProxies(this._video),this._detachHlsJsEvents(),this._cleanUpAirPlay(),this._detachAirPlayEvents(),this._cleanUpInViewTracking(),this._hls&&(this._hls.destroy(),this._hls=null)}reactivate(){this._initHlsJs(),this._initVideoEventHandlers(),this._attachEventProxies(this._video),this._attachHlsJsEvents(),this._setUpAirPlay(),this._attachAirPlayEvents(),this._setUpInViewTracking(),this._video.style.display=""}isInView(){return this._playerInViewTracker?.isInView??!0}_cleanUpAirPlay(){this._airPlayVideoElement&&(this._airPlayVideoElement.removeEventListener(lR.LOADED_METADATA,this._AirPlayListenerLoadedMetadata),this._airPlayVideoElement.removeEventListener(yR,this._AirPlayListenerAvailability),this._airPlayVideoElement.removeEventListener(ER,this._AirPlayListenerTarget),this._airPlayVideoElement=null)}_setUpAirPlay(){const e="AirPlay";this._airPlayVideoElement=document.createElement("video"),this._airPlayVideoElement.playsInline=!0,this._AirPlayListenerLoadedMetadata=e=>{this.fire(lR.LOADED_METADATA,e)},this._AirPlayListenerAvailability=t=>{switch(t.availability){case"available":this._airPlayAvailable||(this._airPlayAvailable=!0,this.fire(fR.AIRPLAY_AVAILABLE),this.fire(dR.AVAILABLE,{type:e}));break;case"not-available":this._airPlayAvailable&&(this._airPlayAvailable=!1,this.fire(fR.AIRPLAY_UNAVAILABLE),this.fire(dR.UNAVAILABLE,{type:e}))}},this._AirPlayListenerTarget=t=>{t.target.webkitCurrentPlaybackTargetIsWireless?(this.onexternaldisplayactivated(),this.fire(fR.AIRPLAY_ACTIVATED),this.fire(dR.ACTIVATED,{type:e})):(this.onexternaldisplaydeactivated(),this.fire(fR.AIRPLAY_DEACTIVATED),this.fire(dR.DEACTIVATED,{type:e}))},this._airPlayVideoElement.addEventListener(lR.LOADED_METADATA,this._AirPlayListenerLoadedMetadata),this._airPlayVideoElement.addEventListener(yR,this._AirPlayListenerAvailability),this._airPlayVideoElement.addEventListener(ER,this._AirPlayListenerTarget)}_attachAirPlayEvents(){this._listenerAirPlay=()=>{this._video.webkitCurrentPlaybackTargetIsWireless?this._hls.stopLoad():this._hls.startLoad()},this._video.addEventListener(ER,this._listenerAirPlay)}_detachAirPlayEvents(){this._video.removeEventListener(ER,this._listenerAirPlay),this._listenerAirPlay=null}_initHlsJs(){const e=window.Hls;if(!e)return;this._brain=function(){let e=null,t=[],r=[],n=null;return{lock:e=>{r=e||[],s()},createAugmentedController:({baseABRController:r})=>function({baseABRController:r}){return class extends r{constructor(t){super(t),t&&(e=t)}get nextAutoLevel(){if(1===t.length)return t[0];const n=Object.getOwnPropertyDescriptor(r.prototype,"nextAutoLevel").get.call(this);if(0===t.length||t.includes(n))return n;const i=e.levels[n]?.bitrate||0,s=t.map(t=>e.levels[t]?.bitrate||0),a=Math.min(...s),o=Math.max(...s);return i<a?t[s.indexOf(a)]:i>o?t[s.indexOf(o)]:n}set nextAutoLevel(e){Object.getOwnPropertyDescriptor(r.prototype,"nextAutoLevel").set.call(this,e)}}}({baseABRController:r}),setPreloadStreamIndex:e=>{if(n=e,null!==e){const r=i([e]);t=r.length?[r[0]]:[]}else s()},getPreloadStreamIndex:()=>n,getWhitelist:()=>r};function i(t){if(!e||!(e?.levels||[]).length||!t?.length)return[];const r=zD(e.audioTracks||[],e.levels).video.filter((e,r)=>t.includes(r));return((e,t)=>e.map(e=>t.findIndex(t=>t.bitrate===e.bitrate)))(r,e.levels)}function s(){t=i(r)}}();const t=this._brain.createAugmentedController({baseABRController:e.DefaultConfig.abrController});this._customLoader=function(){let e=null,t=null;return{setPlaylistRefreshUrl(e){t=e},createCustomLoader:({baseLoader:r})=>function({baseLoader:r}){return class extends r{load(r,n,i){const s=function(e){return!!e&&e-12e4<Date.now()}(vb(e??r.url)),a="type"in r&&"level"===r.type;s&&a&&async function(){try{if(!t)return;const r=await yS(t).json(),n=await mb(r.url.hls);e=function(e){return e.split("/").slice(0,-2).join("/")}(n)}catch(e){}}(),r.url=function(e,t){if(!t)return e;const r=e.split("/"),n=t.split("/");return t+"/"+r.slice(n.length).join("/")}(r.url,e),super.load(r,n,i)}}}({baseLoader:r})}}();const r=this._customLoader.createCustomLoader({baseLoader:e.DefaultConfig.loader});this._hlsConfig={debug:"debug"===this._debugMode,liveDurationInfinity:!0,lowLatencyMode:this._options.lowLatencyMode??!0,capLevelToPlayerSize:!0,capLevelOnFPSDrop:!0,renderTextTracksNatively:!1,liveSyncMode:this._options.dvrEnabled?"buffered":"edge",loader:r,abrController:t,backBufferLength:30,audioPreference:void 0,enableCEA708Captions:!1},this._hls=new e(this._hlsConfig),this._hls.attachMedia(this._video),this._hls.subtitleDisplay=!1,this._video.webkitCurrentPlaybackTargetIsWireless&&this._hls.stopLoad(),"window"!==this._debugMode&&"debug"!==this._debugMode||(window._hls=this._hls)}_synchronizeTextTracksState(e,t){const r=ZD(e.textTracks,t);"showing"===t.mode&&-1===this._hls.subtitleTrack&&(this._hls.subtitleTrack=r),"disabled"===t.mode&&-1!==this._hls.subtitleTrack&&(this._captionsTrack.mode="hidden"),"disabled"===t.mode&&this._telecineVideo.textTracks[r].dispatchEvent("cuechange")}_handleNativeFullscreenEnter(){if(this._captionsTrack){this._hls.subtitleDisplay=!0;const e=()=>{cb(this._video)&&(this._synchronizeTextTracksState(this._video,this._captionsTrack),this._pollingTimeoutId=setTimeout(e,250))};e()}}_handleNativeFullscreenExit(){if(this._captionsTrack){const e=ZD(this._video.textTracks,this._captionsTrack);this._telecineVideo.textTracks[e].mode="hidden",this._hls.subtitleDisplay=!1}clearTimeout(this._pollingTimeoutId),this._pollingTimeoutId=null}_cleanUpInViewTracking(){this._playerInViewTracker?.cleanup()}_setUpInViewTracking(){this._cleanUpInViewTracking(),this._playerInViewTracker=Jb(this._video)}_updatePlayRequestVideo(){this._options?.playRequest&&(this._options.playRequest.video=this._video)}_setEventStartTimeOffset(){if(!this._hls?.latestLevelDetails)return;const{startSN:e,targetduration:t,age:r}=this._hls.latestLevelDetails;this._eventStartTimeOffset=e*t+r}_getAirPlayFile(){const e="AirPlay";if(this._telecineVideo.externalDisplayFiles?.[e])return this._telecineVideo.externalDisplayFiles[e];const t=this.constructor.prototype.supportedVideoTypes,r=this._telecineVideo.files.filter(e=>-1!==t.indexOf(e.mime)).sort((e,r)=>e.mime===r.mime?e.priority-r.priority:t.indexOf(e.mime)-t.indexOf(r.mime));if(!r.length)throw new Error("No files available for AirPlay.");return r[0]}async _loadAirPlayMetadata(){return this._airPlayVideoElement.readyState>=this._airPlayVideoElement.HAVE_METADATA?Promise.resolve():new Promise(async(e,t)=>{this._airPlayVideoElement.addEventListener(lR.LOADED_METADATA,()=>e(),{once:!0});try{let{src:e,mime:t}=this._getAirPlayFile();const r=document.createElement("source");r.type=t,r.src=await mb(e),this._airPlayVideoElement.appendChild(r),this._airPlayVideoElement.load()}catch(e){t(e)}})}_initVideoEventHandlers(){void 0!==this._video.webkitPresentationMode&&this._video.addEventListener(lR.WEBKIT_PRESENTATION_MODE_CHANGED,()=>{this.fire(this.pictureInPictureActive?lR.ENTER_PICTURE_IN_PICTURE:lR.LEAVE_PICTURE_IN_PICTURE)})}_attachEventProxies(e){Object.values(lR).forEach(t=>{const r=e=>this._onVideoEvent(t,e);e.addEventListener(t,r),this._eventHandlers[t]=r}),this._listenerWebKitFullscreenEnter=()=>{this._handleNativeFullscreenEnter()},this._listenerWebKitFullscreenExit=()=>{this._handleNativeFullscreenExit()},this._video.addEventListener(lR.WEBKIT_BEGIN_FULLSCREEN,this._listenerWebKitFullscreenEnter),this._video.addEventListener(lR.WEBKIT_END_FULLSCREEN,this._listenerWebKitFullscreenExit)}_detachEventProxies(e){Object.entries(this._eventHandlers).forEach(([t,r])=>{e.removeEventListener(t,r)}),this._eventHandlers={},this._video.removeEventListener(lR.WEBKIT_BEGIN_FULLSCREEN,this._listenerWebKitFullscreenEnter),this._video.removeEventListener(lR.WEBKIT_END_FULLSCREEN,this._listenerWebKitFullscreenExit),clearTimeout(this._pollingTimeoutId),this._pollingTimeoutId=null}_onVideoEvent(e,t){this.fire(e,t)}get preload(){return this._preload}set preload(e){this._preload=e}get currentTime(){return this._video?this._video.currentTime+this._eventStartTimeOffset:0}set currentTime(e){this._isNearLiveEdge(e)&&(e=this.liveEdgeTime),this._video.currentTime=Math.max(e-this._eventStartTimeOffset,0)}get paused(){return this._video.paused}get ended(){return this._video.ended}get videoWidth(){return this._video.videoWidth}get videoHeight(){return this._video.videoHeight}get duration(){return this._video.duration}get buffered(){return this._video.buffered}get playbackRate(){return this._video.playbackRate}set playbackRate(e){this._video.playbackRate=e}set muted(e){this._video.muted=e}get muted(){return this._video.muted}get volume(){return Tb(this._video.volume)}set volume(e){this._video.volume=Eb(e)}get played(){return this._video.played}get audioTracks(){const{audioTrack:e,audioTracks:t}=this._hls;return t?.length?function(e,t){if(!e.length)return[];const r=e.find(e=>e.default),n=r?r.id:e[0].id,i=-1!==t;return e.map(e=>{const r=i?e.id===t:e.id===n;return{id:`${e.id}`,language:e.lang,label:e.name,kind:QD(e),provenance:JD(e),enabled:r}})}(t,e):[]}get autoPictureInPicture(){return this._video.autoPictureInPicture}set autoPictureInPicture(e){this._video.autoPictureInPicture=e}get disablePictureInPicture(){return this._video.disablePictureInPicture}set disablePictureInPicture(e){this._video.disablePictureInPicture=e}async requestPictureInPicture(){this._video.readyState<this._video.HAVE_METADATA&&await this._initPreload();try{return this._video.requestPictureInPicture()??this._video.webkitSetPresentationMode("picture-in-picture")}catch(e){throw new Error("Picture-in-picture is not supported by this browser",e)}}play(){return this._options.dvrEnabled||(this.currentTime=this.liveEdgeTime),this._video.play()}pause(){this._video.pause()}set currentFile(e){this._currentFile=e,this.setVideoSrc(e.src)}get currentFile(){return this._currentFile}get video(){return this._telecineVideo}set video(e){this._telecineVideo!==e&&(this._captionsTrack&&this._captionsTrack.removeEventListener("cuechange",this._listenerCaptionsCue),this._telecineVideo=e,this._files=e.files.filter(e=>-1!==eO.supportedVideoTypes.indexOf(e.mime)),this._customLoader.setPlaylistRefreshUrl(e.metadata.playlistRefreshUrl),this._updateCurrentFile())}async setVideoSrc(e){try{const t=await mb(e);this.fire(pR.CURRENT_FILE_CHANGE,this._currentFile),this._telecineVideo.metadata.p2pReady&&await this._telecineVideo.metadata.p2pReady,this._hls.loadSource(t),this._video.webkitCurrentPlaybackTargetIsWireless&&this._hls.stopLoad()}catch(e){this._handleFatalError(`error setting video src: ${e}`)}}getCurrentStream(e="video"){let t=this._hls?.currentLevel;return"audio"===e?(t=this._hls?.audioTrack,this._streams.audio?.[t]||null):this._streams.video?.[t]||null}_pickFile(){if(this._files.length<1)return null;const e=this._files.slice(0).sort((e,t)=>e.priority-t.priority);return e[0]}_updateCurrentFile(){const e=this._pickFile();e?this.currentFile=e:this._handleFatalError("all files failed")}_initPreload(){return new Promise(e=>{this.once(lR.LOADED_METADATA,e)})}get externalDisplayAvailable(){return!0}get externalDisplayActive(){return this._externalDisplayActivated}get latency(){return this._hls?.latency||0}get lowLatencyMode(){return this._hls?.lowLatencyMode??!1}set lowLatencyMode(e){this._hls&&(this._hls.lowLatencyMode=e)}get presentationDelay(){return this._hls?.targetLatency||0}get videoElement(){return this._video}get manifest(){const{audio:e,video:t}=this._streams;return{audio:e.toReversed(),video:t.toReversed()}}get atLiveEdge(){return this._isNearLiveEdge(this.currentTime)}get liveEdgeTime(){return(this._hls?.liveSyncPosition||0)+this._eventStartTimeOffset}get atLiveTail(){return this._isNearLiveTail(this.currentTime)}get liveTailTime(){if(this._hls?.latestLevelDetails){const e=this._hls.latestLevelDetails.fragments[0];return(e?.start||0)+this._eventStartTimeOffset}return this._eventStartTimeOffset}_isNearLiveEdge(e){return e>=this.liveEdgeTime-3}_isNearLiveTail(e){return e<=this.liveTailTime+3}get pictureInPictureActive(){return"picture-in-picture"===this._video.webkitPresentationMode||!!document.pictureInPictureElement}async exitPictureInPicture(){return"picture-in-picture"===this._video.webkitPresentationMode?this._video.webkitSetPresentationMode("inline"):document.exitPictureInPicture()}get restrictedStreamIndexes(){return this._brain?.getWhitelist()}set restrictedStreamIndexes(e){this._brain?.lock(e)}get preloadStreamIndex(){return this._brain?.getPreloadStreamIndex()}set preloadStreamIndex(e){this._brain?.setPreloadStreamIndex(e)}getBitrateAtTime(e,t="video",r="average"){const n=this._hls?.currentLevel;if(-1===n||void 0===n)return 0;const i="average"===r?"averageBitrate":"bitrate";return"video"===t?this._hls.levels[n]?.[i]:this._hls.audioTracks[this._hls.audioTrack].bitrate}getHlsJs(){return this._hls}endLive(){}takeSnapshot(){OR(this._video,this._videoWrapper)}removeSnapshot(){LR(this._videoWrapper)}swapVideo(e,t){const r=e.paused;e.pause(),this._detachEventProxies(e),e.parentElement.replaceChild(t,e),this._updatePlayRequestVideo(),this._attachEventProxies(t),this._video=t,t.currentTime=e.currentTime,r||t.play()}onexternaldisplayactivated(){this._externalDisplayActivated||(this._video!==this._airPlayVideoElement&&(this._originalVideo=this._video,this.swapVideo(this._video,this._airPlayVideoElement)),this._externalDisplayActivated=!0)}onexternaldisplaydeactivated(){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(this._airPlayVideoElement,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)}showExternalDisplayPicker(){this._airPlayVideoElement.webkitShowPlaybackTargetPicker(),this._loadAirPlayMetadata().then(()=>this._airPlayVideoElement.webkitShowPlaybackTargetPicker()).catch(e=>{})}addTextTrack(e){return this._captionsTrack||this.loadTextTrack(e.label,e.language,e.id),this._captionsTrack}removeTextTrack(e){}getCuesForTrack(e){return this._video.textTracks[e.id].cues||[]}getActiveCuesForTrack(e){return this._video.textTracks[e.id]?.activeCues||[]}setModeForTrack(e,t){this._captionsTrack.mode=t;const r="disabled"===t&&!this._captionsLoading;this._hls.subtitleTrack=r?-1:parseInt(e.id)}loadTextTrack(e,t,r){if(!this._captionsTrack){const n=new TelecineTextTrack({label:e,id:`${r}`,kind:"captions",language:t},this._telecineVideo);this._telecineVideo.textTracks=SR([n]),this._captionsTrack=this._video.addTextTrack(n.kind,n.label,n.language),this._listenerCaptionsCue=()=>{n.dispatchEvent("cuechange")},this._captionsTrack.addEventListener("cuechange",this._listenerCaptionsCue)}}setCaptionsShouldDisplay(e){this._captionsVisible=e}setCaptionsShouldLoad(e){this._captionsLoading=e,this._hls.subtitleTrack=0}enableAudioTrack(e){if(!e)return null;const t=parseInt(e,10);if(isNaN(t)||!this._hls.audioTracks||t<0||t>=this._hls.audioTracks.length)return null;this._hls.audioTrack!==t&&(this._hls.audioTrack=t);const r=this.audioTracks;let n=null;for(let t=0;t<r.length;t++){const i=r[t].id===e;r[t].enabled=i,i&&(n=r[t])}return this.fire(pR.AUDIO_TRACK_CHANGED),n}getHLSJsInstance(){return this._hls}_handleFatalError(e){this.fire(pR.SCANNER_ERROR,{reason:`hls.js fatal error: ${e}`})}updateStreamStatus(e){this._streamOnline=e===_R.STREAM_ONLINE,this.fire(e)}handleLiveEventEnded(){this._hasLiveEventEnded=!0,this.atLiveEdge?this._video.addEventListener("ended",()=>this.updateStreamStatus(_R.STREAM_ENDED),{once:!0}):this.updateStreamStatus(_R.STREAM_OFFLINE)}_attachHlsJsEvents(){const e=window.Hls.Events,t={[e.ERROR]:this.hlsJsError,[e.MANIFEST_LOADED]:this.handleManifestLoaded,[e.LEVEL_LOADED]:this.handleLevelLoaded,[e.LEVEL_SWITCHED]:this.handleLevelSwitched,[e.FPS_DROP]:this.handleFPSDrop,[e.FRAG_LOADED]:this.handleFragmentLoaded,[e.NON_NATIVE_TEXT_TRACKS_FOUND]:this.handleNonNativeTextTracksFound,[e.CUES_PARSED]:this.handleCuesParsed,[e.BUFFER_APPENDED]:this.handleBufferAppended,[e.AUDIO_TRACKS_UPDATED]:this.handleAudioTracksUpdated};for(const e in t){const r=t[e];r&&(this._hls.on(e,r),this._hlsEventHandlers[e]=r)}}_detachHlsJsEvents(){if(!this._hls)return;const e=window.Hls.Events;Object.entries(this._hlsEventHandlers).forEach(([t,r])=>{this._hls.off(e[t],r)}),this._hlsEventHandlers={}}}const tO=document.createElement("video");class rO extends JR{static get displayName(){return"NativeHLSLiveScanner"}static get supportsMse(){return!1}static get supportsLive(){return!0}static supported(){return rO.supportedVideoTypes.length>0}static get supportedVideoTypes(){const e=[];return"function"!=typeof tO.canPlayType||tO.canPlayType(ab.hlsLive).replace(/^no$/,"")&&e.push(ab.hlsLive),e}constructor(e,t={}){super(e,t),this._apiManifestUrl=null,this._playInitiated=!1,this._atLiveEdge=!0,this._atLiveTail=!1,this._secondsBehindPlaylistStart=0,this._playlistOffsetSet=!1,this.reset(),this.dvrEnabled=t.dvrEnabled??!1,this.getLiveEventStartTimeEpoch=t.getLiveEventStartTimeEpoch,window.addEventListener("online",()=>{this.play()})}deactivate(){super.deactivate(),this.reset()}reset(){this._manifestRefreshTimeout&&clearTimeout(this._manifestRefreshTimeout),this._onReady=null,this._isOnline=!1,this._hasLiveEventEnded=!1,this._hlsAvailabilityCheckTimeout=null,this._manifestRefreshTimeout=null,this._secondsBehindPlaylistStart=0,this._playlistOffsetSet=!1,this._abr=new xD(this,this._options),this._restrictedStreamIndexes=[]}endLive(){this._isOnline=!1,this._hasLiveEventEnded=!0,clearTimeout(this._manifestRefreshTimeout),this._video.pause(),function(e){setTimeout(e,0)}(()=>{super.deactivate(),this.fire(lR.ENDED)})}_setUpRefreshTimer(){const e=db(this.video.metadata.playlistRefreshUrl.split("?")[1]);e.expires&&(this._manifestRefreshTimeout=setTimeout(()=>{this._refreshLiveApiPlaylistUrl()},1e3*(e.expires-10)))}_refreshLiveApiPlaylistUrl(e=0){const t=this.video.metadata.playlistRefreshUrl;return yS(t).json().then(r=>{if(!("url"in r))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${r}`);return this._loadNativeHlsManifest(r.url.hls).then(()=>(this.play(),this._checkHlsAvailability(5e3),null)).catch(()=>this._refreshLiveApiPlaylistUrl(++e))}).catch(()=>{if(e>=3)throw new Error(`Manifest failed to load after ${e} attempts.`);return++e,this._refreshLiveApiPlaylistUrl(e)})}_setUpLiveEventListeners(){this.on(_R.STREAM_OFFLINE,()=>{this._isOnline=!1})}_setUpNativeHls(e){return this._setUpLiveEventListeners(),this._isOnline=!0,this.fire(_R.STREAM_ONLINE),this._checkHlsAvailability(5e3),Promise.resolve(e)}_loadNativeHlsManifest(e){return this._apiManifestUrl=e,/json=1/.test(e)?yS(e).json().then(e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from Live API manifest endpoint: ${this._apiManifestUrl} ${e}`);this._video.src=this._getUrlWithMinSecondsParam(e.url),this._setUpRefreshTimer()}).catch(e=>{const t=this.video.metadata.playlistRefreshUrl;return yS(t).json().then(e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${e}`);this._apiManifestUrl=e.url.ios,this._video.src=this._getUrlWithMinSecondsParam(e.url.ios),this._setUpRefreshTimer()})}):(this._video.src=this._getUrlWithMinSecondsParam(e),this._setUpRefreshTimer(),Promise.resolve())}_getUrlWithMinSecondsParam(e){if(this.dvrEnabled)return e;const t=new URL(e);return t.searchParams.set("min_seconds","30"),t.toString()}_loadTextTracks(){const e=this._video.textTracks;if(e?.length)for(let t=0;t<e.length;t++){const r=e[t];this._loadTextTrack(r)}}_loadTextTrack(e){if(e&&!this._captionsTrack){const{label:t,kind:r,language:n,id:i}=e,s=new TelecineTextTrack({label:t,kind:r,language:n,id:i},this._telecineVideo);this._telecineVideo.textTracks=SR([s]),this._addTextTrackListeners(s,e),this.fire(pR.TEXT_TRACKS_AVAILABLE),this._captionsTrack=e}}setModeForTrack(e,t){return this._captionsTrack&&this._captionsTrack.mode!==t&&(this._captionsTrack.mode=t),this}getActiveCuesForTrack(e){return this._captionsTrack&&"disabled"!==this._captionsTrack.mode?this._captionsTrack.activeCues:[]}addTextTrack(e){return this._captionsTrack||this._loadTextTracks(),this._captionsTrack}_checkHlsAvailability(e){"number"==typeof Gb.iOS&&Gb.iOS<9||this._hlsAvailabilityCheckTimeout||(this._hlsAvailabilityCheckTimeout=setTimeout(()=>{if(!this._isOnline)return;const e=new XMLHttpRequest;e.onload=()=>{410!==e.status?(200!==e.status&&this.fire(_R.STREAM_OFFLINE),e.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&this.fire(_R.STREAM_OFFLINE)):this._refreshLiveApiPlaylistUrl()},e.onerror=()=>{this.fire(_R.STREAM_OFFLINE)},/json=1/.test(this._apiManifestUrl)?yS(this._apiManifestUrl).json().then(t=>{"url"in t||this.fire(_R.STREAM_OFFLINE),e.open("GET",t.url),e.send()}).catch(()=>{e.open("GET",this._apiManifestUrl),e.send()}):(e.open("GET",this._apiManifestUrl),e.send())},e))}_shouldSnapToLiveEdge(e){return e>=this.liveEdgeTime-3}_hasDriftedBehindLiveEdge(e){return e>=this.liveEdgeTime-6}_isNearLiveTail(e){return e<=this.liveTailTime+6}setVideoSrc(e){this._onReady=this._setUpNativeHls(e).then(()=>(this._apiManifestUrl=e,this._loadNativeHlsManifest(e)))}ontimeupdate(){super.ontimeupdate(),this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1)}onplaying(){this._playInitiated=!0}oncanplay(){if(!this._playInitiated){const e=this._video.seekable.length;e>0&&(this._video.currentTime=this._video.seekable.end(e-1))}if(!this._playlistOffsetSet){this._playlistOffsetSet=!0;const e=this._video.getStartDate().getTime()/1e3;this._secondsBehindPlaylistStart=e-this.getLiveEventStartTimeEpoch()}this._loadTextTracks()}onprogress(){this._hlsAvailabilityCheckTimeout&&(clearTimeout(this._hlsAvailabilityCheckTimeout),this._hlsAvailabilityCheckTimeout=null)}onstalled(){this._checkHlsAvailability(1e4)}onerror(){return this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(yS(this._apiManifestUrl).then(()=>{super.onerror()}).catch(e=>{e instanceof hS?this.fire(lR.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")):super.onerror()}),!1):super.onerror()}onwaiting(){this._checkHlsAvailability(1e4)}get currentTime(){return this._secondsBehindPlaylistStart+this._video.currentTime}set currentTime(e){if(this.liveEdgeTime){const t=e>=this.liveEdgeTime-3;this.atLiveEdge=t}this._video.currentTime=e-this._secondsBehindPlaylistStart}get liveEdgeTime(){const e=this._video.seekable.length;return e>0?this._secondsBehindPlaylistStart+this._video.seekable.end(e-1):0}get atLiveEdge(){return this._atLiveEdge}set atLiveEdge(e){this.dvrEnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1))}get atLiveTail(){return this._atLiveTail}set atLiveTail(e){this.dvrEnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}get liveTailTime(){return this._video.seekable.length>0?this._secondsBehindPlaylistStart+this._video.seekable.start(0):0}get ended(){return this._hasLiveEventEnded}get supportsPlaybackRate(){return super.supportsPlaybackRate&&this.dvrEnabled}pause(){this.dvrEnabled&&(this.atLiveEdge=!1),super.pause()}play(){return super.play(()=>this._onReady)}}class nO{static get displayName(){return"Effect"}static get supported(){return!1}static get supportedScanners(){return[]}constructor(e,t={}){this._telecine=e,this._element=e._element,this._options=t}activate(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")}deactivate(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")}}const iO=new WeakMap,sO=new WeakMap;class TelecineFile{constructor({src:e,mime:t,id:r=oS(),priority:n=0,metadata:i={}},s){if(!e)throw new TypeError("Must provide a src for the file.");if(!t)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:t,enumerable:!0},id:{value:`${r}`,enumerable:!0},metadata:{value:i,enumerable:!0}}),this.video=s,this.priority=n,this.src=e}get priority(){return iO.get(this)}set priority(e){if(!("number"==typeof(e=parseInt(e,10))&&isFinite(e)&&Math.floor(e)===e&&e>=0))throw new TypeError("The file priority must be an integer greater than or equal to 0.");iO.set(this,e)}get src(){return sO.get(this)}set src(e){sO.set(this,e),this.video.fire(pR.FILE_SRC_UPDATE,this)}get restrictedStreamIndexes(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes}set restrictedStreamIndexes(e){if(!Array.isArray(e))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=e}}class aO extends nw{constructor({enabled:e=!1,id:t=oS(),kind:r="",label:n="",language:i="",provenance:s=""},a){super(),this._enabled=e,Object.defineProperties(this,{kind:{value:r,enumerable:!0},label:{value:n,enumerable:!0},language:{value:i,enumerable:!0},id:{value:`${t}`,enumerable:!0},provenance:{value:s,enumerable:!0}}),this.video=a}get enabled(){return this._enabled}get active(){return this._enabled}set enabled(e){this._enabled=e}dispatchEvent(e){this.fire(e,{target:this})}}const oO="default";class cO{constructor(){this._cdmList={},this._preferredKeySystems={},this._licenseTokenUrls={},this._licenseUrls={},this._certificateUrls={},this._keySessions={},this._keyChainState=oO,this._keyTypes={KEYCHAIN_DEFAULT:oO,KEYCHAIN_SD_FALLBACK:"sd-fallback"}}get state(){return this._keyChainState}set state(e){Object.values(this._keyTypes).indexOf(e)<0||(this._keyChainState=e)}get activeKeySession(){return this._keySessions[this._keyChainState]}get activeKeySystem(){return this._preferredKeySystems[this._keyChainState]}get keyTypes(){return this._keyTypes}get activeLicenseTokenUrl(){return this._licenseTokenUrls[this._keyChainState]}get activeLicenseUrl(){return this._licenseUrls[this._keyChainState]}getAllKeySessions(){return Object.values(this._keySessions)||[]}getCdms(e){return this._cdmList[e]}getKeySystem(e){return this._preferredKeySystems[e]}getAllPreferredKeySystems(){return this._preferredKeySystems}addCdms(e,t){this._cdmList[t]=e}addKeySession(e,t){this._keySessions[t]=e}addLicenseTokenUrl(e,t){this._licenseTokenUrls[t]=e}addLicenseUrl(e,t){this._licenseUrls[t]=e}addPreferredKeySystem(e,t){this._preferredKeySystems[t]=e}closeAllKeySessions(){for(let e in this._keySessions)this._keySessions[e]&&this._keySessions[e].sessionId&&this._keySessions[e].close()}}const uO="com.apple.fps.1_0",lO="com.microsoft.playready";class hO{constructor(e,t,r={}){this.logPrefix="DrmHandler 🔒:",this._hasFallbackAssets=!!e.fallback_asset,this._useHls=t,this._drmLaUrlParams=r,this._fallbackCallback=()=>null,this._currentTime=0,this._firstLaUrlRequest=!0,this._hasFallbackSourceUpdated=!1,this._encryptedEventName=null,this._boundGenerateRequest=this._generateRequest.bind(this),this._boundOnKeyStatus=this._onKeyStatus.bind(this),this._boundUpdateTimeRef=this.updateTimeRef.bind(this),this._keyChain=new cO,this._keyTypes=this._keyChain.keyTypes,this._keyChain.state=this._keyTypes.KEYCHAIN_DEFAULT,this.updateLAUrls(e)}async init(e,t={},r={}){if(this._video=e._video,this._scanner=e,!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys))return this._scanner.fire(pR.EME_UNSUPPORTED),Promise.reject("Encrypted Media Extensions are not supported!");if(r=this._initDataToArray(r),this._keyChain.state===this._keyTypes.KEYCHAIN_SD_FALLBACK)return this._scanner.once(lR.SEEKING,this._boundUpdateTimeRef),this._hasFallbackSourceUpdated=!0,await this.waitForPlayAttempt(),this.setUpKeySystem(t,r,this._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{this._scanner.currentTime=this._currentTime,this._scanner.play()});const n=this._keyChain.getCdms(this._keyTypes.KEYCHAIN_DEFAULT);if(!n)return Promise.reject("No CDMs set for keyType: "+this._keyTypes.KEYCHAIN_DEFAULT);const i=await DD(n,this._useHls,t),s=this.getPreferredMediaKeySystem(i);if(!s||!s.mediaKeys)return Promise.reject(XR);if(this._scanner.fire(pR.DRM_CDM_CHANGE,s.name),this._hasFallbackAssets){const e=s.name===n.widevine.id,t=(()=>{try{return window.location.origin!==window.parent.location.origin}catch(e){return!0}})(),r=e&&t&&!kD.some(e=>window.location.hostname.includes(e)),i=s.mediaKeys?.getStatusForPolicy?await s.mediaKeys.getStatusForPolicy({minHdcpVersion:"1.0"}):"usable";if(r||"output-restricted"===i)return this._fallBackToSD()}return await this.waitForPlayAttempt(),this.setUpKeySystem(t,r)}updateTimeRef(){this._currentTime=this._scanner.currentTime}updateLAUrls(e){this._keyChain.addCdms(e.cdms,this._keyTypes.KEYCHAIN_DEFAULT),e.fallback_asset&&this._keyChain.addCdms(e.fallback_cdms,this._keyTypes.KEYCHAIN_SD_FALLBACK)}async waitForPlayAttempt(){return new Promise(e=>{this._scanner.paused&&!this._scanner.isPlayRequestActive?(this._scanner.once(lR.PLAY,()=>e()),this._scanner.once(lR.SEEKING,()=>e())):e()})}_initDataToArray(e={}){if(void 0===e||void 0===e.inits)return e;const t=VI(e);for(const[r,n]of Object.entries(t.inits))for(const[t,r]of Object.entries(n)){if(void 0===r||void 0===r.initData)return e;r.initData=AR(r.initData)}return t}getPreferredMediaKeySystem(e){let t=e.find(e=>(e.name===uO||e.name===lO)&&null!==e.mediaKeys);return t||(t=e.find(e=>null!==e.mediaKeys)),t}setUpKeySystem(e,t,r=this._keyTypes.KEYCHAIN_DEFAULT){const n=this._keyChain.getCdms(r);return n?DD(n,this._useHls,e).then(async e=>{const i=this.getPreferredMediaKeySystem(e);if(!i||!i.mediaKeys)throw this._scanner.fire(pR.EME_UNSUPPORTED),new Error(XR);this._keyChain.addPreferredKeySystem(i,r);const s=this._keyChain.activeKeySystem&&function(e,t){let r=null;return Object.keys(e).forEach(n=>{t.name===e[n].id&&(r=e[n])}),r}(n,this._keyChain.activeKeySystem);if(this._scanner.fire(pR.DRM_CDM_CHANGE,i.name),!s)throw this._scanner.fire(pR.EME_UNSUPPORTED),new Error("No valid key system was found.");s.certificate&&await(async(e,t)=>{try{await t.setServerCertificate(AR(e))}catch(e){}})(s.certificate,i.mediaKeys),this._keyChain.addLicenseTokenUrl(s.license_url,r);const a=t&&t.inits&&t.inits[s.id];return a||this._addEncryptedHandler(s,r),this._setMediaKeys(r).then(()=>{const e=this._keyChain.state===r;return a&&e&&this._boundGenerateRequest(a.cenc,r)})}):Promise.reject("No CDMs set for keyType: "+r)}destroy(){this._keyChain&&this._keyChain.closeAllKeySessions(),this._video&&this._video.removeEventListener(this._encryptedEventName,this._boundGenerateRequest)}async _switchKeyChainState(e){this._keyChain.state=e,this._keyChain.activeKeySession?.addEventListener("message",e=>this._getLicense(e))}_addEncryptedHandler(e,t){this._encryptedEventName="encrypted",this._keyChain.addLicenseUrl(e.license_url,t),this._useHls&&(this._certificateUrl=e.certificate_url,this._encryptedEventName="webkitneedkey"),this._video.addEventListener(this._encryptedEventName,this._boundGenerateRequest)}_setMediaKeys(e){if(this._useHls)this._video.webkitSetMediaKeys(this._keyChain.activeKeySystem.mediaKeys);else{this._video.mediaKeys;const t=this._video.mediaKeys||this._keyChain.activeKeySystem.mediaKeys;if(this._keyChain.addKeySession(this._createSession(t),e),e===this._keyChain.state&&this._keyChain.activeKeySession.addEventListener("message",e=>this._getLicense(e)),!this._video.mediaKeys)return this._video.setMediaKeys(this._keyChain.activeKeySystem.mediaKeys)}return Promise.resolve()}_createSession(e,t,r){const n=t&&r?e.createSession(t,r):e.createSession();if(!n)throw new Error("Could not create media key session");return n}_generateRequest(e,t){return t=t||this._keyChain.state,this._keyChain.activeKeySystem.name===uO?(this._loadFairPlayCertificate(this._certificateUrl).then(r=>{this._contentId=function(e){const t=function(e){const t=new Uint16Array(e.buffer);return String.fromCharCode.apply(null,t)}(e),r=document.createElement("a");return r.href=t,r.hostname}(e.initData);const n=function(e,t,r){const n=new Uint8Array(function(e){const t=new ArrayBuffer(2*e.length),r=new Uint16Array(t);for(let t=0,n=e.length;t<n;t++)r[t]=e.charCodeAt(t);return r}(t).buffer);let i=0;const s=new ArrayBuffer(e.byteLength+4+n.byteLength+4+r.byteLength),a=new DataView(s);new Uint8Array(s,i,e.byteLength).set(e),i+=e.byteLength,a.setUint32(i,n.byteLength,!0),i+=4;const o=new Uint8Array(s,i,n.byteLength);return o.set(n),i+=o.byteLength,a.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(s,i,r.byteLength).set(r),new Uint8Array(s,0,s.byteLength)}(e.initData,this._contentId,r);return this._keyChain.addKeySession(this._createSession(this._keyChain.activeKeySystem.mediaKeys,"video/mp4",n),t),this._keyChain.activeKeySession.contentId=this._contentId,this._keyChain.activeKeySession.addEventListener("webkitkeymessage",e=>this._getLicense(e)),this._keyChain.activeKeySession.addEventListener("webkitkeyerror",e=>{this._hasFallbackAssets?this._fallBackToSD():this._scanner.fire(pR.DRM_OUTPUT_RESTRICTED)}),r}).catch(e=>{this._scanner.fire(e.error,e.payload)}),!0):!this._keyChain.activeKeySession.sessionId&&!this._activeKeySession&&(this._keyChain.activeKeySession.addEventListener("keystatuseschange",this._boundOnKeyStatus),this._activeKeySession=this._keyChain.activeKeySession.generateRequest(e.initDataType,e.initData).catch(()=>{this._scanner.fire(pR.DRM_FAILURE)}),!0)}_onKeyStatus(){let e=!1;const t=Array.from(this._keyChain.activeKeySession.keyStatuses.values());if(t.forEach((t,r)=>{"expired"===t&&(e=!0)}),t.length&&t.every(e=>"output-restricted"===e)){if(this._hasFallbackAssets)return void this._fallBackToSD();this._scanner.fire(pR.DRM_OUTPUT_RESTRICTED)}e&&this._keyChain.activeKeySession.close()}_getLicense(e){return this._getLicenseUrl(this._keyChain.activeLicenseTokenUrl).then(t=>new Promise((r,n)=>{this._keyChain.addLicenseUrl(t,this._keyChain.state),this._activeKeySession=null;const i=new XMLHttpRequest;i.keySession=e.target,i.open("POST",this._keyChain.activeLicenseUrl),i.responseType="arraybuffer";let s=e.message;if(this._keyChain.activeKeySystem.name===lO){const t=function(e){const t=e,r=String.fromCharCode.apply(null,new Uint16Array(t)),n=(new DOMParser).parseFromString(r,"application/xml"),i={},s=n.getElementsByTagName("HttpHeader");for(let e=0;e<s.length;++e){const t=s[e].querySelector("name"),r=s[e].querySelector("value");t&&r&&(i[t.textContent]=r.textContent)}return[i,AR(n.querySelector("Challenge").textContent)]}(e.message),r=t[0];Object.keys(r).forEach(e=>{i.setRequestHeader(e,r[e])}),s=t[1]}this._keyChain.activeKeySystem.name===uO&&(s=new Uint8Array(s),i.setRequestHeader("Content-type","application/octet-stream")),i.onload=()=>{if(403!==i.status)if(i.status>=400)n(new TelecineError(pR.DRM_FAILURE));else try{this._scanner.fire(pR.DRM_AUTH_SUCCESS);const e=new Uint8Array(i.response);i.keySession.update(e),r()}catch(e){n(new TelecineError(pR.DRM_FAILURE,`Error updating key session: ${e}`))}else n(new TelecineError(pR.DRM_AUTH_FAILURE))},i.onerror=n,i.send(s)}).catch(e=>{this._scanner.fire(e.name,{text:e.message||"License request failed."})}))}_getLicenseUrl(e){const t=((e,t)=>{const{atid:r,dnt:n,context:i,leadUUID:s,playerLocation:a,firstLog:o,playbackRoute:c,referrer:u}=t;return pb(e,{atid:r,context:i,referrer:u,dnt:1===n?n:void 0,first_log:o?"1":void 0,lead_uuid:s,player_location:a,playback_route:c},!0)})(e,{...this._drmLaUrlParams,firstLog:this._firstLaUrlRequest});return new Promise((e,r)=>{const n=new XMLHttpRequest;n.withCredentials=!0,n.open("GET",t),n.onload=()=>{if(n.status>=400)r(new TelecineError(pR.DRM_FAILURE));else try{try{const t=JSON.parse(n.response),{licenseAcquisitionUrl:r,token:i}=t;if(!r&&!i)throw new Error;e(`${r}?ExpressPlayToken=${i}`)}catch(t){e(n.response)}}catch(e){r(new TelecineError(pR.DRM_FAILURE,`Error retrieving License Acquisition URL (LA_URL): ${e}`))}},n.onerror=r,n.send(),this._firstLaUrlRequest=!1})}_loadFairPlayCertificate(e){return new Promise((t,r)=>{const n=new XMLHttpRequest;n.open("GET",e),n.responseType="arraybuffer",n.setRequestHeader("Pragma","no-cache"),n.setRequestHeader("Cache-Control","max-age=0"),n.onload=()=>{if(403!==n.status)if(n.status>=400)r({error:pR.DRM_FAILURE});else try{t(new Uint8Array(n.response))}catch(e){r(e)}else r({error:pR.DRM_AUTH_FAILURE})},n.onerror=r,n.send()})}_switchKeyChainToFallback(){return this._switchKeyChainState(this._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{this._fallbackCallback(),this._scanner.fire(pR.DRM_KEY_SWITCH,this._keyTypes.KEYCHAIN_SD_FALLBACK)}).catch(e=>{this._scanner.fire(pR.DRM_OUTPUT_RESTRICTED)})}_fallBackToSD(){this.updateTimeRef(),this._useHls?(this._keyChain?.closeAllKeySessions(),this._video?.removeEventListener(this._encryptedEventName,this._boundGenerateRequest),this._scanner.once(lR.SEEKING,this._boundUpdateTimeRef),this._hasFallbackSourceUpdated=!0,this._switchKeyChainToFallback(),this.waitForPlayAttempt().then(()=>{this.setUpKeySystem({},{},this._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{this._scanner.currentTime=this._currentTime,this._scanner.play()})})):this._switchKeyChainToFallback()}setFallbackCallback(e){this._fallbackCallback=()=>e()}get state(){return this._keyChain.state}get hasFallbackAssets(){return this._hasFallbackAssets}get hasFallbackSourceUpdated(){return this._hasFallbackSourceUpdated}set hasFallbackSourceUpdated(e){this._hasFallbackSourceUpdated=e}}const dO=document.createElement("video"),fO={settingPlaybackRate:(()=>{if(Gb.android&&TR&&"object"==typeof TR&&TR.major<52)return!1;const e=dO.playbackRate;dO.playbackRate=.5*e;const t=e!==dO.playbackRate;return dO.playbackRate=e,t})(),settingVolume:(()=>{if(Gb.android||Gb.iOS||Gb.iPadOS)return!1;const e=dO.volume;return dO.volume=.5*e,dO.volume!==e})(),textTracks:void 0!==dO.textTracks&&"undefined"!=typeof TextTrackList&&dO.textTracks instanceof TextTrackList},pO=new WeakMap;class TelecineVideo extends nw{constructor({files:e,id:t=oS(),title:r=null,subtitle:n=null,metadata:i={},textTracks:s=SR(),audioTracks:a=SR(),externalDisplayFiles:o={},chapters:c=[],duration:u}){if(super(),!e||!Array.isArray(e))throw new TypeError("Must provide files for the video.");const l=function(e=[]){return e.getFileById=bR,e}(e.map(e=>e instanceof TelecineFile?(e.video=this,e):new TelecineFile(e,this))),h=SR(s.map(e=>e instanceof TelecineTextTrack?(e.video=this,e):new TelecineTextTrack(e,this)));if(this._audioTracksFromConfig=a,Object.keys(o).forEach(e=>{!o[e]||o[e]instanceof TelecineFile||(o[e]=new TelecineFile(o[e],this))}),Object.defineProperties(this,{id:{value:`${t}`,enumerable:!0},title:{value:r,enumerable:!0},subtitle:{value:n,enumerable:!0},metadata:{value:i,enumerable:!0},files:{value:l,enumerable:!0},textTracks:{value:h,enumerable:!0,writable:!0},chapters:{value:c,enumerable:!0},duration:{value:u,enumerable:!0},externalDisplayFiles:{value:o,enumerable:!0}}),i.drm){const{drm:e,useHls:t,drmLaUrlParams:r}=i;this._drmHandler=new hO(e,t,r)}}get drmHandler(){return this._drmHandler||null}get currentFile(){return this.currentScanner.currentFile}set currentFile(e){this.currentScanner.currentFile=e}get currentScanner(){return pO.get(this)}set currentScanner(e){this.currentScanner&&fO.textTracks&&this.textTracks.forEach(e=>this.currentScanner.removeTextTrack(e)),fO.textTracks&&this.textTracks.forEach(t=>e.addTextTrack(t)),pO.set(this,e)}get audioTracks(){let e=[];return e=this.currentScanner.constructor.supportsAudioTracksFromScanner?Array.from(this.currentScanner.audioTracks):this._audioTracksFromConfig,SR(e.map(e=>e instanceof aO?(e.video=this,e):new aO(e,this)))}get enabledAudioTrack(){return this.audioTracks.find(e=>!!e.enabled)}deactivate(){this._drmHandler&&this._drmHandler.destroy(),this.textTracks.forEach(e=>this.currentScanner.removeTextTrack(e))}}class _O extends nw{constructor(e,t={}){super(),this._telecine=e,this._options=t,this._bufferInterval=null,this._lastBufferCheckVideoTime=this._options.embedTime?this._options.embedTime:0,this._isBuffering=!1,this._isSeeking=!1,this._userPlayState=!1,this.playInitiated=!1,this._isLiveStreamOnline=!1,this._checkInterval=250,this._boundEndBuffering=this._endBuffering.bind(this),this._boundOnPause=this._onPause.bind(this),this._boundOnSeeking=this._onSeeking.bind(this),this._boundOnSeeked=this._onSeeked.bind(this),this._boundOnLiveOnline=this._onLiveOnline.bind(this),this._boundOnLiveOffline=this._onLiveOffline.bind(this),this._toggleEvents(this._telecine.on),this._options.noInterval||this._setUpRebufferMonitor()}get userPlayState(){return this._userPlayState}set userPlayState(e){this._userPlayState=e,e||this._endBuffering()}destroy(){clearInterval(this._bufferInterval),this._toggleEvents(this._telecine.off),this._endBuffering()}_toggleEvents(e){e(lR.PAUSE,this._boundOnPause),e(lR.PLAYING,this._boundEndBuffering),e(lR.SEEKING,this._boundOnSeeking),e(lR.SEEKED,this._boundOnSeeked),e(_R.STREAM_ONLINE,this._boundOnLiveOnline),e(_R.STREAM_OFFLINE,this._boundOnLiveOffline)}_onPause(){this.userPlayState=!1}_endBuffering(){this._isBuffering&&(this._isBuffering=!1,this.fire(pR.BUFFER_ENDED))}_onSeeking(){this._isSeeking=!0}_onSeeked(){this._isSeeking=!1}_onLiveOnline(){this._isLiveStreamOnline=!0}_onLiveOffline(){this._isLiveStreamOnline=!1}_setUpRebufferMonitor(){clearInterval(this._bufferInterval),this._bufferInterval=setInterval(this.runIntervalCheck.bind(this),this._checkInterval)}runIntervalCheck(){if(!this._telecine.video)return;const e=this._telecine.video.currentScanner;if(!e)return;const t=this._telecine.isLive(),r=e.videoElement.currentTime,n=this._checkInterval/2/1e3;if(this.playInitiated&&(!this._isSeeking||t)&&(!this._telecine.paused||this.userPlayState)&&!this._isBuffering&&r<this._lastBufferCheckVideoTime+n){if(t&&!this._isLiveStreamOnline)return;const e=this._telecine.buffered;for(let t=0;t<e.length;t++)if(r>=e.start(t)&&r+.2<=e.end(t))return void(this._lastBufferCheckVideoTime=r);if(r+n>=this._telecine.duration)return;this._isBuffering=!0,this.fire(pR.BUFFER_STARTED)}(this.playInitiated&&this._isBuffering&&r>this._lastBufferCheckVideoTime+n||t&&!this._isLiveStreamOnline&&this._isBuffering)&&(this._isBuffering=!1,this.fire(pR.BUFFER_ENDED)),this._lastBufferCheckVideoTime=r}}function vO(){let e,t;function r(){if(!t)return Promise.reject();e.preload="";let r=e.play();return void 0===r&&(r=new Promise(t=>{e.addEventListener("playing",t)})),r}function n(){t&&(t.resolve(),t=null)}function i(e){t&&(t.reject(e),t=null)}return{set video(t){e=t},get video(){return e},get active(){return!!t},start:function(s=Promise.resolve.bind(Promise)){return t||(t=Zb()),e.currentSrc?document.createElement("video").load():e.load(),s().then(r).then(n).catch(i),t},cancel:function(){t&&(t.reject(new TelecineError(BR,"The play() request was interrupted by a call to pause()")),t=null)}}}class mO extends nw{constructor(e,t,r={}){super(),this._element=e,this._scanners=t,this._options=r,this._video=null,this._textTracks=SR(),this._properties={},this._currentScanner=new JR(e,r),this._options.playRequest=new vO,this._blacklistedScanners=[],this._activeEffects=[],this._previousScanner=null,this._switchingVideo=!1,this._snapshotDisplayed=!1}get element(){return this._element}get videoElement(){return this._currentScanner.videoElement}get hlsJsVersion(){return this._currentScanner.constructor.hlsJsVersion??null}get manifest(){return this._currentScanner.manifest||{video:[]}}get supportsAudioTracksFromScanner(){return this._currentScanner.constructor.supportsAudioTracksFromScanner}supportsEffect(e){return!!e.supported&&e.supportedScanners.some(e=>this.currentScannerName===e.displayName)}get activeEffects(){return this._activeEffects}getEffectByName(e){let t=null;return this._activeEffects.forEach(r=>{e===this._getEffectName(r)&&(t=r)}),t}activateEffect(e,t){const r=new e(this,t);return r.activate(),this._activeEffects.push(r),r}deactivateEffect(e){return this._activeEffects.some((t,r)=>t.constructor===e&&(t.deactivate(),this._activeEffects.splice(r,1),!0))}deactivateEffects(){this._activeEffects.forEach(e=>this.deactivateEffect(e.constructor))}play(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");this._rebufferMonitor.playInitiated||(this._rebufferMonitor.playInitiated=!0),this._rebufferMonitor.userPlayState=!0;const e=this._currentScanner.play();return this._properties.paused=!1,e}pause(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this._rebufferMonitor.userPlayState=!1,this._currentScanner.pause(),this._properties.paused=!0,this}isLive(){return this._currentScanner.constructor.supportsLive}endLive(){this._currentScanner.endLive()}get latency(){return this._currentScanner.latency}get downloadSpeed(){return this._currentScanner.downloadSpeed||0}getBitrateAtTime(e,t="video",r="average"){return this._currentScanner.constructor.supportsMse?"audio"===t&&this._currentScanner._streams[t].length<=1?0:this._currentScanner.getBitrateAtTime?.(e,t,r)||0:0}getCurrentStream(e="video"){return this._currentScanner.getCurrentStream?.(e)}showExternalDisplayPicker(e){this._currentScanner.showExternalDisplayPicker(e)}get pictureInPictureActive(){return this._currentScanner.pictureInPictureActive}requestPictureInPicture(){return this._currentScanner.requestPictureInPicture()}exitPictureInPicture(){return this._currentScanner.exitPictureInPicture()}get pictureInPictureEnabled(){return this._currentScanner.pictureInPictureEnabled}addChapter(e,t){this._currentScanner.addChapter(e,t)}removeChapter(e){this._currentScanner.removeChapter(e)}addCuePoint(e,t){return this._currentScanner.addCuePoint(e,t)}removeCuePoint(e){return this._currentScanner.removeCuePoint(e)}removeAllCuePoints(){return this._currentScanner.removeAllCuePoints()}enableAudioTrack(e){return this._currentScanner.enableAudioTrack(e)}addVideoEventListeners(){return this._currentScanner.addVideoEventListeners()}removeVideoEventListeners(){return this._currentScanner.removeVideoEventListeners()}get isLowerProfileAvailable(){return this._currentScanner.isLowerProfileAvailable}get buffered(){return this._currentScanner.buffered}get bufferTarget(){return this._currentScanner.bufferTarget}set bufferTarget(e){this._properties.bufferTarget=e,this._currentScanner.bufferTarget=e}get presentationDelay(){return this._currentScanner.presentationDelay}set presentationDelay(e){this._properties.presentationDelay=e,this._currentScanner.presentationDelay=e}get lowLatencyMode(){return this._currentScanner.lowLatencyMode}set lowLatencyMode(e){this._properties.lowLatencyMode=e,this._currentScanner.lowLatencyMode=e}get manifestLoadDurations(){return this._currentScanner.manifestLoadDurations?this._currentScanner.manifestLoadDurations:[]}get successfulSegments(){return this._currentScanner.successfulSegments?this._currentScanner.successfulSegments:[]}get failedSegments(){return this._currentScanner.failedSegments?this._currentScanner.failedSegments:[]}get cuePoints(){return this._currentScanner.cuePoints}get currentChapterID(){if(this._currentScanner&&this._currentScanner.chaptersTrack&&this._currentScanner.chaptersTrack.activeCues.length){const{activeCues:e}=this._currentScanner.chaptersTrack;return e[e.length-1].id}return null}get chapters(){return this._currentScanner.chaptersTrack?this._currentScanner.chaptersTrack.cues:[]}get chaptersTrack(){return this._currentScanner.chaptersTrack}get currentFile(){return this._currentScanner.currentFile}set currentFile(e){if("string"==typeof e&&(e=this._files.filter(t=>t.id===e)[0]),!e)throw new TelecineError("FileNotValid","The file is not valid.");this._currentScanner.currentFile=e}get currentScannerName(){return this._getScannerName(this._currentScanner)}get currentScanner(){return this._currentScanner}get currentTime(){return this._currentScanner.currentTime}set currentTime(e){this._properties.currentTime=e,this._currentScanner.currentTime=e}get liveEdgeTime(){const e=this._currentScanner.liveEdgeTime;return null==e?this._previousLiveEdgeTime:(this._previousLiveEdgeTime=e,e)}get atLiveEdge(){return this._currentScanner.atLiveEdge??this.isLive()}get liveTailTime(){const e=this._currentScanner.liveTailTime;return null==e?this._previousLiveTailTime:(this._previousLiveTailTime=e,e)}get atLiveTail(){return this._currentScanner.atLiveTail??!1}get disableRemotePlayback(){return this._properties.disableRemotePlayback}set disableRemotePlayback(e){this._properties.disableRemotePlayback=!!e,this._currentScanner.disableRemotePlayback=!!e}get duration(){return this._currentScanner.duration}get ended(){return this._currentScanner.ended}get externalDisplayAvailable(){return this._currentScanner.externalDisplayAvailable}get externalDisplayActive(){return this._currentScanner.externalDisplayActive}get loop(){return this._currentScanner.loop}set loop(e){this._properties.loop=e,this._currentScanner.loop=e}get muted(){return this._currentScanner.muted}set muted(e){this._properties.muted=!!e,this._currentScanner.muted=!!e}get playsinline(){return this._currentScanner.playsinline}set playsinline(e){this._properties.playsinline=!!e,this._currentScanner.playsinline=!!e}get paused(){return this._currentScanner.paused}get played(){return this._currentScanner.played}get seekable(){return this._currentScanner.seekable}get seeking(){return this._currentScanner.seeking}get defaultPlaybackRate(){return this._currentScanner.defaultPlaybackRate}set defaultPlaybackRate(e){this._properties.defaultPlaybackRate=e,this._currentScanner.defaultPlaybackRate=e}get playbackRate(){return this._currentScanner.playbackRate}set playbackRate(e){this._properties.playbackRate=e,this._currentScanner.playbackRate=e}get preload(){return this._currentScanner.preload}set preload(e){this._properties.preload=e,this._currentScanner.preload=e}get autoPictureInPicture(){return this._currentScanner.autoPictureInPicture}set autoPictureInPicture(e){this._properties.autoPictureInPicture=!!e,this._currentScanner.autoPictureInPicture=!!e}get disablePictureInPicture(){return this._currentScanner.disablePictureInPicture}set disablePictureInPicture(e){this._properties.disablePictureInPicture=!!e,this._currentScanner.disablePictureInPicture=!!e}get video(){return this._video}set video(e){this._video&&this._video.deactivate(),this._blacklistedScanners=[],this._setUpRebufferMonitor(),null===e?(this._video=null,this._resetScanner()):(this._video=new TelecineVideo(e),this._updateScanner())}get videoWidth(){return this._currentScanner.videoWidth}get videoHeight(){return this._currentScanner.videoHeight}get volume(){return this._currentScanner.volume}set volume(e){if(e<0||e>1)throw new TelecineError("IndexSizeError",`Failed to set the 'volume' property: The volume provided (${e}) is outside of the range [0, 1].`);this._properties.volume=e,this._currentScanner.volume=e}get audioTracks(){return this._currentScanner.audioTracks}get brainDebug(){return this._currentScanner.brainDebug}_findScanner({textTrackSupport:e=!1}={}){if(e&&!fO.textTracks)return null;const t=this._video.files.sort((e,t)=>e.priority-t.priority),r=this._scanners;for(const e in t){let n=t[e];for(const e in r){let t=r[e];if(t.supported(this._options.disableMMS)&&-1===this._blacklistedScanners.indexOf(this._getScannerName(t))&&t.supportedVideoTypes.some(e=>n.mime===e))return t}}return null}reactivate(){this._currentScanner?.reactivate&&this._currentScanner.reactivate(),this.play()}checkRebuffer(e,t){this._rebufferMonitor&&(this._rebufferMonitor.playInitiated=e,this._rebufferMonitor.userPlayState=t,this._rebufferMonitor.runIntervalCheck())}_initScanner(e,t){if(this._currentScanner.constructor===e&&this._currentScanner.video===t)return;const r=!this.isLive()&&this._currentScanner._preserveCurrentTime;this._switchingVideo?(this._previousScanner=this._currentScanner,this._previousScanner._switchingVideo=!0,this._snapshotDisplayed||(OR(this._previousScanner.videoElement,this._element),this._snapshotDisplayed=!0),this._previousScanner.deactivate()):this._currentScanner.deactivate();const n=new e(this._element,this._options);Object.keys(gR).forEach(e=>{const t=gR[e];n.on(t,e=>this._handleEvent(t,e,n))}),this._currentScanner=n,t.currentScanner=n,this._currentScanner.video=t;const i=Object.keys(this._properties);for(let e=0;e<i.length;e++){const t=i[e];"paused"!==t?("currentTime"!==t||r)&&(this._currentScanner[t]=this._properties[t]):!1===this._properties.paused&&this._currentScanner.play()}t.chapters?.length>0&&this._currentScanner.addChapters?.(t.chapters,t.duration),this.fire(pR.SCANNER_CHANGE,this.currentScannerName),this._currentScanner.on([lR.CAN_PLAY,lR.PLAYING],()=>{this._previousScanner&&(this._previousScanner._switchingVideo=!1,LR(this._element),this._previousScanner=null,this._snapshotDisplayed=!1)})}_updateScanner(){if(null===this._video)return;const e=this._findScanner({textTrackSupport:this._video.textTracks.length>0});e?this._initScanner(e,this._video):this._fireVideoError("FilesNotPlayable","None of the files could be played in this browser.")}_resetScanner(){this._currentScanner.deactivate(),this._currentScanner=new JR(this._element,this._options)}_handleEvent(e,t,r){if(r===this._currentScanner){switch(e){case lR.ERROR:return void(t instanceof TelecineError&&this.fire(lR.ERROR,t));case pR.SCANNER_ERROR:this._fireVideoError("ScannerError",`The current scanner can no longer be used because ${t.reason}`),this._blacklistedScanners.push(this.currentScannerName),this._updateScanner([]);break;case pR.FILE_ERROR:this._fireVideoError("FileError",`The current file can no longer be used because ${t.reason}`),this._currentScanner._switchToNextFile();break;case pR.DOWNLOAD_ERROR:this._fireVideoError("DownloadError",t),this._currentScanner._switchToNextFile();break;case pR.EME_UNSUPPORTED:this._fireVideoError(FR,{text:null,code:"emeunsupported"});break;case pR.DRM_FAILURE:case pR.DRM_AUTH_FAILURE:this._fireVideoError(FR,{text:t.text,code:t.code});break;case pR.DRM_OUTPUT_RESTRICTED:this._fireVideoError(FR,{text:null,code:"outputrestricted"});break;case pR.DRM_AUTH_SUCCESS:this.fire(pR.DRM_AUTH_SUCCESS);break;case pR.NO_SUPPORTED_CDM:this._rebufferMonitor.destroy();break;case lR.TIME_UPDATE:this._properties.currentTime=this._currentScanner.currentTime;break;case pR.MEDIA_URL_EXPIRED:this._fireVideoError("MediaUrlExpired",t);break;case pR.MEDIA_URL_BAD_REQUEST:this._fireVideoError(jR,t);break;case vR.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case lR.ENDED:const e=!this._options.dvrEnabled||this.atLiveEdge;this._properties.paused=e;break;case lR.WAITING:this.fire(lR.WAITING)}this._activeEffects.forEach(t=>{"function"==typeof t[`on${e}`]&&t[`on${e}`]()}),this.fire(e,t)}}_fireVideoError(e,t){this.fire(lR.ERROR,new TelecineError(e,t))}_getScannerName(e){return e.constructor.displayName??e.prototype.constructor.displayName}_setUpRebufferMonitor(){this._rebufferMonitor&&this._rebufferMonitor.destroy(),this._rebufferMonitor=new _O(this,this._options),this._rebufferMonitor.on(pR.BUFFER_STARTED,()=>{this.fire(pR.BUFFER_STARTED)}),this._rebufferMonitor.on(pR.BUFFER_ENDED,()=>{this.fire(pR.BUFFER_ENDED)})}_getEffectName(e){return e instanceof nO?e.constructor.displayName:e.prototype.constructor.displayName}_isLiveMse(){return this._currentScanner.constructor.supportsMse&&this._currentScanner.constructor.supportsLive}updateBufferTarget(){this._currentScanner&&this._currentScanner.getBufferTarget&&(this.bufferTarget=this._currentScanner.getBufferTarget())}setCaptionsShouldDisplay(e){this._isLiveMse()&&this._currentScanner.setCaptionsShouldDisplay(e)}setCaptionsShouldLoad(e){this._isLiveMse()&&this._currentScanner.setCaptionsShouldLoad(e)}getHlsJS(){return"function"==typeof this._currentScanner.getHLSJsInstance?this._currentScanner.getHLSJsInstance():null}}class gO extends nO{static get displayName(){return"CanvasEffect"}static get supported(){return!0}static get supportedScanners(){return[JR,CD]}constructor(e,t={}){super(e,t),this._activated=!1,this._video=this._telecine._currentScanner._video}activate(){this._activated=!0,this._canvas=document.createElement("canvas"),this._canvas.className="vp-canvas-effect",this._canvas.style.cssText="\n            position: absolute;\n            top:0;\n            left:0;\n            bottom:0;\n            right:0;\n        ",this._ctx=this._canvas.getContext("2d",{alpha:!1}),this._element.appendChild(this._canvas),this._startRendering()}deactivate(){this._canvas&&this._element.removeChild(this._canvas),this._stopRendering(),this._activated=!1}_startRendering(){this._requestFrame()}_requestFrame(){this._animationFrame=window.requestAnimationFrame(this._renderFrame.bind(this))}_renderFrame(){const e=this._video,t=this._canvas;t.width=e.clientWidth,t.height=e.clientHeight;const r=Math.floor(this._videoContentWidth()),n=Math.floor(this._videoContentHeight()),i=Math.floor((e.clientWidth-r)/2),s=Math.floor((e.clientHeight-n)/2);this._ctx.fillStyle="#000",this._ctx.fillRect(0,0,t.width,t.height),this._ctx.drawImage(e,i,s,r,n),this._requestFrame()}_videoRatio(){return this._video.videoHeight/this._video.videoWidth}_videoContentWidth(){return Math.min(this._video.clientHeight/this._videoRatio(),this._video.clientWidth)}_videoContentHeight(){return Math.min(this._video.clientWidth*this._videoRatio(),this._video.clientHeight)}_stopRendering(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)}}class yO{static get Equirect(){return"equirectangular"}static get HalfEquirect(){return"halfequirectangular"}}class EO{static get Mono(){return"mono"}static get TopBottom(){return"top-bottom"}static get LeftRight(){return"left-right"}}class TO{constructor(e,t,r){switch(this.isStereo=t!==EO.Mono,this._leftEye=null,this._rightEye=null,e){case yO.Equirect:this.createEquirectProjection(r,t);break;case yO.HalfEquirect:this.createHalfEquirectProjection(r,t);break;default:this.createEquirectProjection(r,EO.Mono)}}get left(){return this._leftEye}get right(){return this._rightEye}createEquirectProjection(e,t){this._createProjection(e,t,e=>this._createEquirectangularSphereMesh(e))}createHalfEquirectProjection(e,t){this._createProjection(e,t,e=>this._createHalfEquirectangularSphereMesh(e))}_createProjection(e,t,r){t!==EO.Mono?(this._leftEye=r(e),this._rightEye=r(e),this._leftEye.layers.set(1),this._rightEye.layers.set(2),t===EO.TopBottom&&(this._chopGeometryUvs(this._leftEye.geometry,.5,.5),this._chopGeometryUvs(this._rightEye.geometry,.5,0)),t===EO.LeftRight&&(this._chopGeometryUvs(this._leftEye.geometry,.5,0,0),this._chopGeometryUvs(this._rightEye.geometry,.5,.5,0))):this._leftEye=r(e)}_createHalfEquirectangularSphereMesh(e){const t=new THREE.SphereBufferGeometry(TO.SPHERE_RADIUS,TO.TESSELATION_WIDTH,TO.TESSELATION_HEIGHT,0,Math.PI,0,Math.PI);t.scale(-1,1,1);const r=new THREE.MeshBasicMaterial({map:e}),n=new THREE.Mesh(t,r);return n.rotation.y=Math.PI,n}_createEquirectangularSphereMesh(e,t,r,n){const i=new THREE.SphereBufferGeometry(t||TO.SPHERE_RADIUS,r||TO.TESSELATION_WIDTH,n||TO.TESSELATION_HEIGHT);i.scale(-1,1,1);const s=new THREE.MeshBasicMaterial({map:e});return new THREE.Mesh(i,s)}_chopGeometryUvs(e,t,r,n=1){for(let i=0;i<e.attributes.uv.array.length;i+=2)e.attributes.uv.array[i+n]*=t,e.attributes.uv.array[i+n]+=r}static get TESSELATION_WIDTH(){return 120}static get TESSELATION_HEIGHT(){return 80}static get SPHERE_RADIUS(){return 500}}class bO{constructor(e){this._renderer=e}get supported(){return Gb.webvr}get device(){return this._renderer&&this._renderer.vr.getDevice()?this._renderer.vr.getDevice():null}get isPresenting(){return!(!this._renderer||!this._renderer.vr.getDevice())&&this._renderer.vr.getDevice().isPresenting}hasVRHeadset(){return Gb.webvr?navigator.getVRDisplays().then(e=>e.length>0?(this._renderer.vr.setDevice(e[0]),e[0]):null):null}enter(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().requestPresent([{source:this._renderer.domElement}])}exit(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().exitPresent()}}class SO extends nO{static get displayName(){return"ThreeSixtyEffect"}static get supported(){try{const e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return this._telecine._currentScanner.fire(vR.SPATIAL_UNSUPPORTED),!1}}static get supportedScanners(){return[JR,CD]}set isUserInteracting(e){e!==this._isUserInteracting&&(this._isUserInteracting=e,e?this._options.isMobile||this._telecine.fire(vR.MOTION_START):this._options.isMobile||this._telecine.fire(vR.MOTION_END))}get isUserInteracting(){return this._isUserInteracting}constructor(e,t={}){super(e,t),this._activated=!1,this._camera=null,this._scene=null,this._renderer=null,this.isUserInteracting=!1,this._onMouseDownMouseX=0,this._onMouseDownMouseY=0,this._projection=t.projection;const r="halfequirectangular"===this._projection?90:0;this._coordinates={lat:0,long:r},this._previousCoordinates={lat:0,long:r},this._onMouseDownCoordinates={lat:0,long:r},this._previousCameraProps=this.cameraProps,this._phi=0,this._theta=0,this._rotation=0,this._video=this._telecine._currentScanner._video,this._videoRefreshLoop=null,this._gyroVector={x:0,y:0},this._offset={lat:0,long:0},this._writeSpeeds={videoFps:this._options.fps,motionRenderSpeed:60},this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps,this._motionTimeouts=[],this._movingAutomatically=!1,this._deviceMotionHasOccurred=!1,this._updateFromGyroscopePending=!1,this._keysPressed={up:!1,down:!1,left:!1,right:!1}}get currentCoordinates(){return this._coordinates}set currentCoordinates([e,t]){if(e>90||e<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(t<0||t>360)throw new RangeError("Longitude should be a float between 0 and 360.");this._updateViewpoint(e,t),this._update()}get cameraProps(){return{yaw:this._coordinates.long,pitch:this._coordinates.lat,roll:this.roll,fov:this.fieldOfView}}set cameraProps(e){e={...this.cameraProps,...e},this.fieldOfView=e.fov,this.roll=e.roll,this.currentCoordinates=[e.pitch,e.yaw]}get roll(){return 180*this._rotation/Math.PI}set roll(e){if(e<-180||e>180)throw new RangeError("Roll should be a float between -180 and 180.");this._rotation=THREE.Math.degToRad(e)}get isVRPresenting(){return this._webvr&&this._webvr.isPresenting}get fieldOfView(){return this._camera?this._camera.fov:this._options.fieldOfView}set fieldOfView(e){this._camera.fov=e,this._camera.updateProjectionMatrix(),this._renderer.render(this._scene,this._camera)}static frustumSurfaceArea(e,t,r){const n=2*TO.SPHERE_RADIUS*2*Math.sin(Math.PI/180*(e/2));return n*(n*t/r)/(4*Math.PI*Math.pow(TO.SPHERE_RADIUS,2))}activate(){return new Promise(e=>{if(window.THREE)return void e();const t=document.createElement("script");t.src=this._options.threeUrl,document.body.appendChild(t),t.onload=()=>{e()}}).then(()=>this._initialize())}_initialize(){this._activated=!0,this._camera=new THREE.PerspectiveCamera(this._options.fieldOfView,this._video.clientWidth/this._video.clientHeight,1,2*TO.SPHERE_RADIUS),this._camera.target=new THREE.Vector3(0,0,0),this._camera.layers.enable(1),this._initializeAutoMovement(this._options.directorTimeline),this._scene=new THREE.Scene,this._texture=new THREE.VideoTexture(this._video),this._texture.generateMipmaps=!1,this._texture.minFilter=THREE.NearestFilter,this._texture.maxFilter=THREE.NearestFilter,this._texture.format=THREE.RGBFormat,this._projector=new TO(this._projection,this._options.stereoMode,this._texture),this._projector.isStereo&&this._scene.add(this._projector.right),this._scene.add(this._projector.left),this._renderer=new THREE.WebGLRenderer,this._renderer.vr.enabled=!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._output=document.createElement("div"),this._renderer.domElement.style.margin="0 auto",this._output.appendChild(this._renderer.domElement),this._element.appendChild(this._output),this._hideOutput(),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),this._startRendering(),this._telecine._currentScanner.paused||this._showOutput(),this._webvr=new bO(this._renderer),this._webvr.supported&&this._webvr.hasVRHeadset().then(e=>{setTimeout(()=>{this._telecine.fire(vR.WEBVR_HARDWARE_AVAILABLE,this._webvr.device)},100)}).catch(e=>{})}get hasVRHeadset(){return this._webvr&&!!this._webvr.device}toggleVR(){if(this._webvr.isPresenting)this._webvr.exit().then(()=>{this.adjustRenderSize()}).catch(e=>{});else{if(this._telecine._currentScanner.paused)return;this._webvr.enter().then(()=>{this.adjustRenderSize()}).catch(e=>{})}}onplay(){this._activated&&(this._showOutput(),this.adjustRenderSize())}deactivate(){this._output&&this._element.removeChild(this._output),this._stopRendering(),this._activated=!1}snapToCenter(){this._motionTimeouts.forEach(e=>clearTimeout(e));let e=0;"halfequirectangular"===this._projection?e=90:this._coordinates.long>=180&&(e=360);const t=(e-this._coordinates.long)/11,r=(0-this._coordinates.lat)/11;this._rotation=0;for(let e=0;e<50;e++)this._motionTimeouts.push(setTimeout(()=>{0===e&&(this._movingAutomatically=!0,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)),49===e&&(this._movingAutomatically=!1,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps)),this._updateViewpoint(this._coordinates.lat+r/Math.pow(1.1,e),this._coordinates.long+t/Math.pow(1.1,e)),this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+r/Math.pow(1.1,e),this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+r/Math.pow(1.1,e)},e*this._maxTimeBetweenWrites))}isStereo(){return!!this._projector&&this._projector.isStereo}_initializeAutoMovement(e){e&&e[0]&&void 0!==e[0].p&&"undefined"!==e[0].y&&this._updateViewpoint(e[0].p,e[0].y)}_updateViewpoint(e,t){if(this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,e%=360,this._coordinates.lat=Math.max(-85,Math.min(85,e)),"halfequirectangular"===this._projection){const e=0,r=180;this._coordinates.long=Math.max(e,Math.min(r,t))}else t=(t%=360)>=0?t:360+t,this._coordinates.long=t}makeContact(e){this.isUserInteracting=!0,this._motionTimeouts.forEach(e=>clearTimeout(e)),this._movingAutomatically=!1,this._contactPoint={x:e.x,y:e.y},this._onMouseDownCoordinates.long=this._coordinates.long,this._onMouseDownCoordinates.lat=this._coordinates.lat,this._motionStart={long:this._coordinates.long,lat:this._coordinates.lat},this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)}move(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._motionStart.lat-.2*(this._contactPoint.y-e.y),r=.2*(this._contactPoint.x-e.x)+this._motionStart.long;this._updateViewpoint(t,r)}moveWheel(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._coordinates.lat-.1*e.y,r=this._coordinates.long+.1*e.x;this._updateViewpoint(t,r)}moveDevice(e,t,r,n){this._updateFromGyroscopePending=!0;const i=new THREE.Quaternion;let s=window.orientation;null===s&&(s=this._video.clientWidth>this._video.clientHeight?90:0),e=e?THREE.Math.degToRad(e):0,t=t?THREE.Math.degToRad(t):0,r=r?THREE.Math.degToRad(r):0;const a=s?THREE.Math.degToRad(s):0,o=new THREE.Vector3(0,0,1),c=new THREE.Euler,u=new THREE.Quaternion,l=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));c.set(t,e,-r,"YXZ"),i.setFromEuler(c),i.multiply(l),i.multiply(u.setFromAxisAngle(o,-a)),this._gyroVector=(new THREE.Euler).setFromQuaternion(i,"YXZ"),this._rotation=this._gyroVector.z,this.isUserInteracting||this._movingAutomatically||this._updateViewpoint(THREE.Math.radToDeg(this._gyroVector.x)-this._offset.lat,-THREE.Math.radToDeg(this._gyroVector.y)+this._offset.long),this._deviceMotionHasOccurred||(this.snapToCenter(),this._telecine.fire(vR.MOTION_START),this._deviceMotionHasOccurred=!0)}releaseContact(e){if(this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)-this._coordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long,this.isUserInteracting=!1,this._motionStart&&!e){const e=Math.hypot(this._coordinates.long-this._motionStart.long,this._coordinates.lat-this._motionStart.lat);this._moveDueToMomentum(e)}}abandonMotion(){this.isUserInteracting=!1,this._motionStart=null}keyPress(e){this._options.keyboardDisabled||(this._keyIsDown()||(this.isUserInteracting=!0,this._motionTimeouts&&this._motionTimeouts.forEach(e=>clearTimeout(e))),this._keysPressed[e]||(this._keysPressed[e]=!0))}keyUp(e){this._keysPressed[e]=!1,this._keyIsDown()||(this.isUserInteracting=!1,this._moveDueToMomentum(1/0))}_moveFromKeyPress(){Object.keys(this._keysPressed).forEach(e=>{if(this._keysPressed[e])switch(e){case"up":this._updateViewpoint(this._coordinates.lat+2,this._coordinates.long);break;case"down":this._updateViewpoint(this._coordinates.lat-2,this._coordinates.long);break;case"left":this._updateViewpoint(this._coordinates.lat,this._coordinates.long-2);break;case"right":this._updateViewpoint(this._coordinates.lat,this._coordinates.long+2)}})}_keyIsDown(){return Object.keys(this._keysPressed).map(e=>this._keysPressed[e]).some(e=>e)}_moveDueToMomentum(e){if(e>=20){const t={long:this._coordinates.long-this._previousCoordinates.long,lat:this._coordinates.lat-this._previousCoordinates.lat};e===1/0&&(t.long/=2,t.lat/=2);for(let e=1;e<50;e++)this._motionTimeouts.push(setTimeout(()=>{1===e&&(this._movingAutomatically=!0),49===e&&(this._movingAutomatically=!1,this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps);const r=2/Math.pow(e,1.5);this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+t.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+t.long,this._updateViewpoint(this._coordinates.lat+t.lat*r,this._coordinates.long+t.long*r)},e*this._maxTimeBetweenWrites))}}onseeked(){this._activated&&this._update()}onresize(){this.adjustRenderSize(),this.isUserInteracting=!1}_update(){if(!this.isVRPresenting){this._phi=THREE.Math.degToRad(90+this._coordinates.lat),this._theta=THREE.Math.degToRad(this._coordinates.long),this._camera.position.set(Math.sin(this._phi)*Math.cos(this._theta),Math.cos(this._phi),Math.sin(this._phi)*Math.sin(this._theta)),this._camera.lookAt(this._camera.target),this._camera.rotation.z+=this._rotation;const e=this.cameraProps;this._telecine.fire(vR.CAMERA_UPDATE,e),this._previousCameraProps.yaw===e.yaw&&this._previousCameraProps.pitch===e.pitch&&this._previousCameraProps.roll===e.roll&&this._previousCameraProps.fov===e.fov||(this._previousCameraProps=e,this._telecine.fire(vR.CAMERA_CHANGE,e))}this._renderer.render(this._scene,this._camera)}adjustRenderSize(){if(this.isVRPresenting)this._camera.aspect=this._video.clientWidth/this._video.clientHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(this._video.clientWidth,this._video.clientHeight);else{this._video.clientWidth>this._video.clientHeight?this._camera.aspect=Math.max(1,Math.min(2,this._video.clientWidth/this._video.clientHeight)):this._camera.aspect=Math.max(1/3,Math.min(3,this._video.clientWidth/this._video.clientHeight)),this._camera.updateProjectionMatrix();const e=wR(this._video.clientWidth,this._video.clientHeight,this._camera.aspect,1);this._renderer.setSize(e.width,e.height),this._output.style.paddingTop=`${e.top}px`}}_startRendering(){this._renderer.setAnimationLoop(()=>{this._keyIsDown()&&this._moveFromKeyPress(),this._update()})}_stopRendering(){this._renderer.setAnimationLoop(null)}_showOutput(){this._styleOutput({backgroundColor:"#000",display:"block"})}_hideOutput(){this._styleOutput({backgroundColor:"#000",display:"none"})}_styleOutput({backgroundColor:e,display:t}={}){this._output.style.cssText=`position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:${e};width:100%;height:100%;text-align:center;display:${t}`}}class AO extends nO{static get displayName(){return"AmbisonicEffect"}static get supported(){return void 0!==window.AudioContext}static get supportedScanners(){return[JR,CD]}constructor(e,t={}){super(e,t),this.connected=!1,this._context=null,this._source=null,this._mirror=null,this._rotator=null,this._decoder=null}activate(){return this._context=new AudioContext,new Promise((e,t)=>{if("undefined"!=typeof ambisonics)return void e();const r=document.createElement("script");r.src=this._options.ambisonicsUrl,document.body.appendChild(r),r.onload=()=>e(),r.onerror=()=>t()}).then(()=>this.toggleAmbisonics()).catch(()=>{this._telecine._currentScanner.fire(vR.AMBISONIC_UNSUPPORTED)})}deactivate(){this._disconnect(!0)}toggleAmbisonics(){(this._telecine.getCurrentStream("audio")?.ambisonic_order??0)<1?this._disconnect():this._connect()}_connect(){if(!this._context)return;const e=this._telecine.getCurrentStream("audio")?.ambisonic_order??0;if(this.connected||e<1)return;const t=this._telecine._currentScanner._video;this._source=this._context.createMediaElementSource(t),this._mirror=new ambisonics.sceneMirror(this._context,e),this._rotator=new ambisonics.sceneRotator(this._context,e),this._decoder=new ambisonics.binDecoder(this._context,e),this._source.connect(this._mirror.in),this._mirror.out.connect(this._rotator.in),this._rotator.out.connect(this._decoder.in),this._decoder.out.connect(this._context.destination),this._mirror.mirror(1),this.connected=!0}_disconnect(e=!1){this._source&&this._source.disconnect(),e&&this._context&&(this._context.close(),this._context=null),this._source=null,this._mirror=null,this._rotator=null,this._decoder=null,this.connected=!1}updateRotation(e,t,r){this._rotator&&(this._rotator.yaw!==e||this._rotator.pitch!==t||this._rotator.roll!==r)&&(this._rotator.yaw=e,this._rotator.pitch=t,this._rotator.roll=r,this._rotator.updateRotMtx())}}function wO(){return window.Hls?Promise.resolve():import("./hls-js.module.js").then(({default:e})=>e)}function IO(e){const t=1===e.request.flags?.legacy_live,r=e.video?.live_event,n=e.video?.ecdn,i=e.request.flags?.hls_js_ecdn,s=!n||1===i,a=Gb.mse;return!(t||!r||!s||!a)}const RO={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/vnd.mpeg.dash.mpd":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","application/x-mpegURL":"hlslive"},PO="pending",kO="active",DO="started",OO="ended",LO="started",CO="done",MO="error";var NO=/\s/,xO=/^\s+/;var UO=/^[-+]0x[0-9a-f]+$/i,FO=/^0b[01]+$/i,VO=/^0o[0-7]+$/i,jO=parseInt;function BO(e){if("number"==typeof e)return e;if(HS(e))return NaN;if(qS(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=qS(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&NO.test(e.charAt(t)););return t}(e)+1).replace(xO,""):e}(e);var r=FO.test(e);return r||VO.test(e)?jO(e.slice(2),r?2:8):UO.test(e)?NaN:+e}var HO=1/0;var XO=LS.isFinite,WO=Math.min,qO=function(){var e=Math.round;return function(t,r){if(t=BO(t),(r=null==r?0:WO(function(e){var t=function(e){return e?(e=BO(e))===HO||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(r),292))&&XO(t)){var n=(bA(t)+"e").split("e");return+((n=(bA(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}();function GO(e){return!isNaN(e)}function KO(e){return qO(e,3)}let YO=0;function zO(e="b"){return`${e}${++YO}`}zO(),zO();const $O=zO(),JO=zO(),QO=zO(),ZO=zO(),eL=zO(),tL=zO(),rL=Symbol("CONFIG_CHANGED"),nL=Symbol("TELECINE_READY"),iL=Symbol("TELECINE_VIDEO_INIT"),sL=Symbol("PLAY_INITIATED"),aL=Symbol("QUALITY_CHANGED"),oL=Symbol("CUE_CHANGED"),cL=Symbol("CAPTIONS_CHANGED"),uL=Symbol("SPATIAL_PLAYBACK_TOGGLED"),lL=Symbol("PICTURE_IN_PICTURE_AVAILABLE_SAFARI"),hL=Symbol("HLS_QUALITY_CHANGED"),dL=Symbol("REQUEST_COMPLETE_LIVE_SUBTITLES"),fL=Symbol("COMPLETE_LIVE_SUBTITLES_LOADED"),pL=Symbol("COMPLETE_LIVE_SUBTITLES_ERROR"),_L=Symbol("liveeventpending"),vL=Symbol("liveeventactive"),mL=Symbol("liveeventstarting"),gL=Symbol("liveeventstarted"),yL=Symbol("liveeventended"),EL=Symbol("livearchivestarted"),TL=Symbol("livearchivedone"),bL=Symbol("livearchiveerror"),SL=Symbol("livesettingsupdated"),AL=Symbol("lowlatencyfallback"),wL=Symbol("livestatssuccess"),IL=Symbol("livestatsfailure");var RL=Object.freeze({__proto__:null,EVENT_PENDING:_L,EVENT_ACTIVE:vL,EVENT_STARTING:mL,EVENT_STARTED:gL,EVENT_ENDED:yL,ARCHIVE_STARTED:EL,ARCHIVE_DONE:TL,ARCHIVE_ERROR:bL,SETTINGS_UPDATED:SL,LOW_LATENCY_FALLBACK:AL,LIVE_STATS_SUCCESS:wL,LIVE_STATS_FAILURE:IL});const PL={..._R,...RL};function kL(e){return e?.archive?.status===CO}function DL(e){return e?.status===PO}function OL(e){return e?.status===DO}function LL(e){return e?.status===OO}function CL(e,t){const r=e.request.files.hls?.default_cdn,{signature:n,timestamp:i,expires:s}=e.request;return`https://${e.player_url}/live/${e.video.id}${t}?signature=${n}&time=${i}&expires=${s}&cdn=${r}`}var ML=Object.prototype.hasOwnProperty;function NL(e){if(null==e)return!0;if(Fw(e)&&(kS(e)||"string"==typeof e||"function"==typeof e.splice||gw(e)||kw(e)||pw(e)))return!e.length;var t=yI(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Cw(e))return!Uw(e).length;for(var r in e)if(ML.call(e,r))return!1;return!0}function xL(e){const t=this;let r={};const n={get attributes(){return Object.assign({},t)},get previousAttributes(){return r},clear(){i();var e=t.attributes;for(var r in e)delete t[r]},set(e){for(var r in i(),e=VI(e))t[r]=e[r]},clone:()=>new xL(t.attributes),toJSON:()=>VI(t.attributes)};function i(){NL(t.attributes)||(r=VI(t.attributes))}return n.set(e),nb(t,n)}function UL(e,t){const r=new xL(cR(e,t));let n=!1;return ib(r,{reset:function(e){return r.clear(),function(e){n=!0,r.set(e),cR(r,t)}(e),r},isNewVideo:function(){const e=r.previousAttributes;return!n||e.video.id!==r.video.id||e.video.version.current!==r.video.version.current||!!e.video.live_event&&!kL(e.video.live_event)&&(!r.video.live_event||kL(r.video.live_event))}})}function FL(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=BO(r))==r?r:0),void 0!==t&&(t=(t=BO(t))==t?t:0),function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}(BO(e),t,r)}function VL(e=[],t=null,r=null){if(!t&&!r)return e;if(!e.length)return e;if(t===r&&-1!==e.indexOf(t))return[t];const n=parseFloat(t),i=parseFloat(r);if(n&&i&&i<n)return e;const s=e.filter(e=>{const t=parseFloat(e);return!(n&&t<n||i&&t>i)});return s.length?s:e}function jL(e=[],t=null){const r=VL(e,t,t);return 1===r.length?r[0]:null}function BL(e){return e.quality||e.metadata.quality}function HL(e,t,r=!1){return r?XL(e,t):function(e,t){e.embed.settings.audio_tracks||(t=null);const r=e.request.files,n=YL(r),i=eC(e),s=e.request.cookie.quality||i||function(e){const t=YL(e.request.files);let r=t.some(QL);Gb.mobileAndroid&&(r=!1);let n="720p";if(r){const e=t.map(BL);-1!==e.indexOf("1080p")&&-1===e.indexOf("720p")&&(n="1080p")}return e.request.cookie.hd||e.video.default_to_hd?n:"360p"}(e);let a=function({files:e=[],preference:t="360p",priorityOffset:r=0}){(e=Array.from(e)).sort(tC());const n=e.map(BL);if(t){-1===n.indexOf(t)&&(n.push(t),n.sort((e,t)=>ZL(t)-ZL(e)));const e=n.indexOf(t),r=n.splice(0,e);r.reverse(),n.push(...r)}return e.map(e=>({id:e.id,src:e.url,mime:e.mime,priority:n.indexOf(e.quality)+1+r,metadata:{profile:e.profile,cdn:e.cdn,origin:e.origin,quality:e.quality,fps:e.fps}}))}({files:n,preference:s,priorityOffset:3});return r.hls&&(a=a.concat(GL(e,!1,t)),e.request.drm&&Gb.browser.webKit)||r.dash&&(a=a.concat(KL(e,!1,t))),a}(e,t)}function XL(e,t){const r=e.request.files;let n=[];const i=e.request.drm&&Gb.browser.webKit;return(r.hls&&(Gb.iPhone||Gb.iPad)||i)&&(n=n.concat(GL(e,!0,t))),r.dash&&!i&&(n=n.concat(KL(e,!0,t))),n}function WL(e,t=!1,r=!1){let n=e.url;if("avc_url"in e&&(n=e.avc_url),t)return n;const i=Gb.dolbyVision,s=Gb.hdr&&Gb.hevc,a=Gb.hevc;return r||(i&&"hevc_dvh1_url"in e?n=e.hevc_dvh1_url:s&&"hevc_hdr_url"in e?n=e.hevc_hdr_url:a&&"hevc_sdr_url"in e&&(n=e.hevc_sdr_url)),Gb.av1&&"av1_url"in e&&(n=e.av1_url),n}function qL(e){return e.fallback_url}function GL(e,t=!1,r=null){const n=e.request.files,i=n.hls.default_cdn,s=e.request.drm,a=n.hls.cdns[i],o=a?.alternatives?.[r],c=o||a,u=t?qL(c):WL(c,s);return{id:`hls-${i}-${e.video.id}`,src:u,mime:ab.hls,priority:3,metadata:{cdn:i,origin:n.hls.cdns[i].origin,quality:"sd"}}}function KL(e,t=!1,r=null){const n=e.request.files;return NL(n.dash)?[]:Object.keys(n.dash.cdns).map(i=>{const s=n.dash.cdns[i],a=s?.alternatives?.[r],o=a||s,c=(Gb.browser.chrome||Gb.browser.firefox)&&e.request.drm,u=t?qL(o):WL(o,!1,c);return{id:`dash-${i}-${e.video.id}`,src:u,mime:e.request.drm?ab.dashMpd:ab.dash,priority:i===n.dash.default_cdn?1:2,metadata:{cdn:i,origin:n.dash.cdns[i].origin,quality:"sd"}}})}function YL(e){if(NL(e.progressive))return[];let t=e.progressive;return"progressive_avc"in e&&(t=e.progressive_avc),t.filter($L(t))}function zL(e){if("number"==typeof e)return e;const t=e.split("-");return 5===t.length?t[0]:parseInt(t[0],10)}function $L(e){const t=e.filter(JL).map(BL);return e=>-1===t.indexOf(BL(e))||JL(e)}function JL(e){let t=e.fps;return"metadata"in e&&(t=e.metadata.fps),t>30}function QL(e){return ZL(e)>=720}function ZL(e){return"string"!=typeof e&&(e=BL(e)),parseInt(e,10)}function eC(e){const t=YL(e.request.files).map(e=>e.quality);return e.embed.on_site?null:jL(t,e.embed.quality)}function tC(e="desc"){return(t,r)=>{const n=ZL(t),i=rC(t),s=ZL(r),a=rC(r);return"asc"===e?n-s||i-a:s-n||a-i}}function rC(e){return"object"!=typeof e?0:"fps"in e?e.fps:"metadata"in e&&"fps"in e.metadata?e.metadata.fps:0}function nC(e){const t=e.video.live_event,r=e.request.files;if(!NL(r.hls)){const n=r.hls.default_cdn,i=r.hls.cdns[n].hevc_url||t?.playback_urls?.[n]?.codecs?.hevc?.hls_noredirect,s=!!i&&Gb.hevc,a=s?i:r.hls.cdns[n].json_url||function(e,t){const r=t?"hevc":"avc",n=e.dvr,i=e.low_latency;return n?e.playback_urls?.["akamai-fmp4"]?.codecs?.[r]?.hls_noredirect:i?e.playback_urls?.["akamai-low-latency"]?.codecs?.[r]?.hls_noredirect:e.playback?.codecs?.[r]?.hls_noredirect?e.playback.codecs[r].hls_noredirect:e.playback?.hls_noredirect}(t,s),o=e.request.flags?.live_dash?2:1;return{id:`hls-${n}-${e.video.id}`,src:a,mime:ab.hlsLive,priority:o,metadata:{cdn:n,origin:r.hls.cdns[n].origin,quality:"sd",codec:s?"hevc":"avc"}}}return null}function iC(e,t){let r=[];if(t.video){const n=t.video.currentFile.mime;if(n===ab.hlsLive)return t.manifest.video.map(e=>({...e,quality:`${e.height}p`}));if([ab.dash,ab.dashMpd].includes(n)){const n=!!t.video.drmHandler,i=n&&"sd-fallback"===t.video.drmHandler.state;r=function(e,t=!1){if(!e)return[];let r=e.streams;"streams_avc"in e&&(r=e.streams_avc);const n=Gb.dolbyVision,i=Gb.hevc&&Gb.hdr,s=Gb.hevc;return n&&"streams_hevc_dvh1"in e?r=e.streams_hevc_dvh1:i&&"streams_hevc_hdr"in e?r=e.streams_hevc_hdr:s&&"streams_hevc_sdr"in e?r=e.streams_hevc_sdr:Gb.av1&&"streams_av1"in e&&(r=e.streams_av1),t&&"streams_fallback"in e&&(r=e.streams_fallback),r}(e.request.files.dash,i),!n&&t?.currentScanner?.manifestLoaded&&(r=function(e,t){const r=t.map(e=>e.id);return e.filter(e=>{const t=zL(e.id);return r.includes(e.id)||r.includes(t)})}(r,t.currentScanner.videoStreams))}else r=t.video.files.filter(e=>"progressive"===RO[e.mime])}return r.filter($L(r)).sort(tC())}function sC(e){let t=BL(e);const r={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(const e in r)t=t.replace(e,r[e]);return t}function aC(e){return Gb.spatialPlayback&&e.video.spatial?35:75}function oC(e){return e.request.text_tracks.map(e=>({id:e.id,src:e.url,kind:e.kind,label:e.label,language:e.lang,provenance:e.provenance}))}let cC={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},uC=cC;var lC={set:function(e){uC=Object.assign({},cC,e)},captureException:function(e,t){return uC.captureException(e,t)},captureMessage:function(e,t){return uC.captureMessage(e,t)},captureBreadcrumb:function(e,t,r="backbone",n="info"){return uC.captureBreadcrumb(e,t,r,n)}};function hC(e,t,r){let n=!1,i=!1,s=!1,a=!0,o="auto";function c(e){if(!a&&r.buffered&&r.buffered.length>0){e=e||r.currentTime;const i=function(e,t){var r=e.length-1;if(e.length>1)for(var n=0,i=e.length;n<i;n++)if(e.start(n)<=t&&e.end(n)>=t){r=n;break}return r}(r.buffered,e),a=r.buffered.end(i),o=a/r.duration,c=r.duration;if(t.fire(lR.PROGRESS,{loaded:a,duration:c,loadProgress:o}),s&&n&&a===r.duration)return void(n&&r.paused&&r.play().catch(lC.captureException))}}function u(t=[]){const n=iC(e,r).reverse().map(e=>e.quality),i=t.filter(e=>-1!==n.indexOf(e)).sort((e,t)=>n.indexOf(e)-n.indexOf(t));return i.map(e=>n.indexOf(e))}function l(e=[],t=null){if(e.includes("auto"))r.video.currentFile.restrictedStreamIndexes=[];else{const t=u(e);t.length&&(lC.captureBreadcrumb(`Switched to ${e[0]}`,{},"video"),r.video.currentFile.restrictedStreamIndexes=t)}if(t){const e=u([t]),n=e.length?e[0]:null;r._currentScanner.preloadStreamIndex=n}else r._currentScanner.preloadStreamIndex=null}function h(){if(e.embed.on_site)return;const t=iC(e,r).map(e=>e.quality),n=VL(t,e.embed.quality||e.embed.min_quality,e.embed.quality||e.embed.max_quality),i=jL(t,e.embed.initial_quality);l(n.length&&n.length!==t.length?n:["auto"],i)}return t.on(iL,function(){r.playsinline=e.embed.playsinline,r.muted=e.embed.muted,r.lowLatencyMode=e.video.live_event?.low_latency,r.disableRemotePlayback=!e.embed.settings.airplay&&!e.embed.settings.chromecast}),t.on(JO,function(){a=!0,r.paused||r.pause(),i=!1,n=!1,r.currentTime=0}),t.on(QO,function(){r.paused||r.pause(),r.video=null}),r.on(lR.PLAY,function(){a=!1,t.fire(lR.PLAY,r.currentTime)}),r.on(lR.PAUSE,function(){n=!1,t.fire(lR.PAUSE,r.currentTime,r.ended)}),r.on(lR.PLAYING,function(e){c()}),r.on(lR.TIME_UPDATE,function(){if(a)return;const{currentTime:e,liveEdgeTime:n,atLiveEdge:i,liveTailTime:s,atLiveTail:o,duration:c,playbackRate:u}=r,l=e/c;t.fire(lR.TIME_UPDATE,{currentTime:e,liveEdgeTime:n,atLiveEdge:i,liveTailTime:s,atLiveTail:o,duration:c,playbackRate:u,timeProgress:l})}),r.on(lR.ENDED,function(e){r.loop?r.play().catch(lC.captureException):(n=!1,t.fire(lR.ENDED,e))}),r.on(lR.LOADED_METADATA,function(t){const n=r.duration;if(isFinite(n)&&n>0){if(n<e.video.duration-1||n>e.video.duration+1)return;e.video.duration=n}e.video.video_width=r.videoWidth,e.video.video_height=r.videoHeight}),r.on(lR.DURATION_CHANGE,function(t){const n=r.duration;isFinite(n)&&(e.video.duration>0&&(n<e.video.duration-1||n>e.video.duration+1)||(e.video.duration=n))}),r.on(lR.PROGRESS,c),r.on(pR.BUFFER_STARTED,()=>{s=!0}),r.on(pR.BUFFER_ENDED,()=>{s=!1}),t.on($O,function(t){r.isLive()&&0===r.liveEdgeTime||(t=FL(t,KO(r.isLive()?r.liveTailTime:0),KO(r.isLive()?r.liveEdgeTime:r.duration||e.video.duration)),r.currentTime=t)}),r.on(lR.SEEKING,function(){const e=r.currentTime,n=r.duration,i=e/n;t.fire(lR.SEEKING,{currentTime:e,duration:n,timeProgress:i})}),r.on(lR.SEEKED,function(){c();const e=r.currentTime,n=r.duration,i=e/n;t.fire(lR.SEEKED,{currentTime:e,duration:n,timeProgress:i})}),r.on(pR.CURRENT_FILE_CHANGE,function(t){lC.captureBreadcrumb("Current file changed",{id:t.id,mime:t.mime,src:t.src,metadata:t.metadata},"video"),[ab.dash,ab.dashMpd].includes(t.mime)&&h(),[ab.hlsLive].includes(t.mime)?r.once(pR.STREAMS_LOADED,()=>{h()}):eC(e)}),r.on(lR.RESIZE,function(){r.video.currentFile.mime===ab.hls&&r.videoHeight&&t.fire(hL,{height:r.videoHeight})}),{play:function(){return n=!0,i||(t.fire(sL),i=!0),r.play()},pause:function(){n=!1,r.pause()},get quality(){return o},set quality(n){!function(n){const i=r.video.currentFile.mime;if([ab.dash,ab.dashMpd,ab.hlsLive].includes(i))l([n]);else{const t=iC(e,r).filter(e=>e.metadata.quality===n);t.length>0&&(a=!0,r.video.currentFile=t[0])}o=n,t.fire(aL,n)}(n)}}}function dC(e,t,r){let n=null;Gb.spatialPlayback&&(t.on(iL,function(){n&&(r.deactivateEffect(SO),n=null,t.fire(uL,n));const i=e.video.spatial;i&&(e.request.drm||r.supportsEffect(SO)&&(n=r.activateEffect(SO,{threeUrl:e.request.urls.three_js,fps:e.video.fps,fieldOfView:i.fov,directorTimeline:i.director_timeline,projection:i.projection,stereoMode:i.stereo_mode,initialView:i.initial_view,isMobile:Gb.android,dimensions:e.embed.on_site?{width:1080,height:540}:{width:640,height:360},keyboardDisabled:!e.embed.keyboard}),t.fire(uL,n)))}),r.on(vR.SPATIAL_UNSUPPORTED,function(){n&&(r.deactivateEffect(SO),n=null,t.fire(uL,n))}))}function fC(e,t,r){let n=null;t.on(iL,function(){n&&(r.deactivateEffect(gO),n=null),e.video.canvas&&(e.request.drm||r.supportsEffect(gO)&&(n=r.activateEffect(gO)))})}var pC=aR(function(e,t,r){iR(e,t,r)});const _C=5e3;class vC extends nw{constructor(e,t,r,n){super(),this._liveEventHasID=Zb(),this._liveEvent=VI(e),this._sessionUrl=e.session_url||e.sessionUrl,this._subtitleUrl=e.subtitleUrl,this._sessionRefreshUrl=t,this._subtitleRefreshUrl=n,this._appPollUrl=r,this._forcedPoll=!1,this._disabled=!1,this._dvrEnabled=e.dvr,this._setupPolling()}async requestCompleteLiveSubtitles(){try{const e=await yS({url:this._subtitleUrl,retry:3,retryStatus:e=>[410].includes(e)||ZT.retryStatus(e),hooks:{beforeRetry:[this._beforeSubtitleRetry.bind(this)]}}).json();if(!e?.url)throw new Error("No webvtt url was available to fetch");return XD(await yS(e.url).text())}catch(e){throw e}}async _beforeSubtitleRetry(e){e.url=await this._refreshSubtitleUrl()}async _refreshSubtitleUrl(){const e=await yS(this._subtitleRefreshUrl).json();return this._subtitleUrl=e.url,e.url}disable(){this._disabled=!0}forcePolling(){this.isForcePolling||(this._forcedPoll=!0,this._setupPolling())}unforcePolling(){this._forcedPoll=!1}endlistReceived(){this._liveEvent.status=OO,this.forcePolling()}get isForcePolling(){return this._forcedPoll}get liveEventIDReady(){return this._liveEventHasID}_setupPolling(){!1!==this._liveEvent.polling&&(this._liveEvent.id&&this._liveEventHasID.resolve(),this._shouldPollApp()?this._pollApp():this._shouldPoll()&&this._pollLiveApi())}_shouldPoll(){return!(LL(this._liveEvent)&&this._liveEvent.archive?.status!==LO||!this.isForcePolling&&OL(this._liveEvent))}_shouldPollApp(){return!this._sessionUrl||!(!DL(this._liveEvent)||null!==this._liveEvent.id)}async _refreshSessionUrl(){const e=await yS(this._sessionRefreshUrl).json();return this._sessionUrl=e.url,e.url}async _pollLiveApi(){if(this._disabled)return;let e,t={};Gb.browser.ie&&(t={Pragma:"no-cache","Cache-Control":"no-cache"});try{e=await yS({url:this._sessionUrl,retry:3,retryStatus:e=>[410].includes(e)||ZT.retryStatus(e),hooks:{beforeRetry:[this._beforeRetry.bind(this)]},headers:t}).json()}catch(e){throw new Error(`Hit max retries polling ${this._sessionUrl}`)}if(this._dvrEnabled&&(e.dvr=this._dvrEnabled),e.status!==this._liveEvent.status){if(LL(e)&&"provision_expire"===e.terminate_reason)return this._sessionUrl=null,this._liveEvent.id=null,void setTimeout(this._setupPolling.bind(this),_C);const t={[kO]:PL.EVENT_ACTIVE,[PO]:PL.EVENT_PENDING,[DO]:PL.EVENT_STARTED,[OO]:PL.EVENT_ENDED}[e.status];try{this.fire(t,e)}catch(e){throw new Error(`Error firing live event status change ${e}`)}}if(e.archive&&(!this._liveEvent.archive||e.archive.status!==this._liveEvent.archive.status)){const t={[LO]:PL.ARCHIVE_STARTED,[CO]:PL.ARCHIVE_DONE,[MO]:PL.ARCHIVE_ERROR}[e.archive.status];this.fire(t,e)}this._liveEvent=pC(this._liveEvent,e),this._shouldPoll()&&setTimeout(this._pollLiveApi.bind(this),_C)}async _beforeRetry(e){e.url=await this._refreshSessionUrl()}async _pollApp(){if(this._disabled)return;const e=await yS(this._appPollUrl).json();if(null!==e.ingest.session_id)return this._liveEventHasID.resolve(),this._liveEvent.id=e.ingest.session_id,await this._refreshSessionUrl(),void this._pollLiveApi();setTimeout(this._pollApp.bind(this),_C)}}function mC(e,t,r){let n,i,s,a=!1,o=0,c=0;function u(){i&&(i.disable(),i=null)}function l(){r.endLive()}function h(){i.isForcePolling||i.forcePolling()}return t.on(rL,function(){n&&!e.isNewVideo()||(n=!0,u(),e.video.live_event&&!kL(e.video.live_event)&&(function(r){i=new vC(r,function(e){return CL(e,"/session/refresh")}(e),function(e){return`https://${e.vimeo_url}/live_event/status?clip_id=${e.video.id}`}(e),function(e){return CL(e,"/subtitle/refresh")}(e)),i.on(PL.EVENT_ENDED,l),Object.keys(PL).forEach(e=>{const r=PL[e];i.on(r,e=>{t.fire(r,e)})}),t.on(dL,async()=>{try{const e=await(i?.requestCompleteLiveSubtitles());t.fire(fL,e)}catch(e){t.fire(pL)}})}(e.video.live_event),function(){o=0,c=0;let e=!1;r.once(lR.PLAYING,()=>e=!0);let n=rS();clearInterval(s),s=setInterval(()=>{r.paused||(o+=sS(n)/1e3),e&&a&&(c+=sS(n)/1e3),function(e){if(r.lowLatencyMode&&e>12&&r.latency>10&&a){const e="Rebuffer ratio > 12% and latency > 10s, fallback to normal HLS w/ target latency of 12s.";t.fire(PL.LOW_LATENCY_FALLBACK,{msg:e}),r.lowLatencyMode=!1,r.presentationDelay=12,r.bufferTarget=12}}(c/o*100),n=rS()},500)}()),e.video.ecdn&&async function(){await{hive:()=>{},kollective:()=>{}}[e.video.ecdn.ecdn_provider]()}())}),t.on(QO,function(){u()}),r.on(PL.STREAM_ONLINE,function(){i.isForcePolling&&i.unforcePolling()}),r.on(PL.STREAM_OFFLINE,h),r.on(PL.STREAM_ENDED,function(){i.endlistReceived(),h()}),r.on(pR.BUFFER_STARTED,function(){a=!0}),r.on(pR.BUFFER_ENDED,function(){a=!1}),{get p2pReady(){}}}function gC(e,t,r){let n,i,s=!1,a=!1,o=!1;const c=e.video.ecdn?.ecdn_provider;let u;async function l(){try{return i||(i=await async function(){try{return(await import("./hive.module.js").then(({default:e})=>e))(r,e)}catch(e){throw lC.captureException(e),new Error("Failed to create Hive Module",e)}}()),i?.setUp(a)}catch(e){return i?.stop(),null}}async function h(){return n||(n=await async function(){try{return(await import("./kollective.module.js").then(({default:e})=>e))(r)}catch(e){return lC.captureException(e),null}}()),n?.setUp(e)}function d(){try{n&&(n.destroy(),n=null),i&&(i.destroy(),i=null)}catch(e){}}return t.on(rL,function(){e.isNewVideo()&&(s=!1),!0!==e.preload||!1!==o||"kollective"!==c?s||(e.video.live_event?.status!==PO?(s=!0,d(),c&&(u={hive:l,kollective:h}[c]())):a=!0):o=!0}),t.on(QO,d),{get p2pReady(){return u}}}function yC(e,t,r){let n=null;function i(){r.deactivateEffect(AO),n=null}t.on(sL,function(){n&&i();const t=e.video.channel_layout?.startsWith("ambisonic");t&&r.supportsEffect(AO)&&(n=r.activateEffect(AO,{ambisonicsUrl:e.request.urls.ambisonics_js}))}),r.on(vR.CAMERA_UPDATE,function({yaw:e,pitch:t,roll:r}){n&&n.updateRotation(e,t,r)}),r.on(vR.AMBISONIC_UNSUPPORTED,function(){n&&i()}),r.on(pR.STREAM_CHANGE,function(){n&&n.toggleAmbisonics()})}function EC(e,t=[]){if(!e||"null"===e||0===t.length)return{track:null};const[r,n]=e.split("."),[i]=r.split(/[-_]/),s=r!==i,a=t.filter(e=>s&&e.language===r||e.language===i).sort((e,t)=>{const s=2*(e.language===i&&e.kind===n)+2*(e.language===r)+1*(e.kind===n);return 2*(t.language===i&&t.kind===n)+2*(t.language===r)+1*(t.kind===n)-s});return a.length>0?{track:a[0],exactMatch:a[0].language===r&&a[0].kind===n}:{track:null}}function TC(e){const t=e.split(/\n/g);let r=[],n=[];return t.forEach(e=>{let t=e.match(/<[a-zA-Z]+ ?.*?>/g)||[],i=e.match(/<\/[a-zA-Z]+ ?.*?>/g)||[];const s=n.map(({startTag:e})=>e);n=[],t=s.concat(t),t.forEach(e=>{let[t]=e.replace(/<|>/g,"").split(" ");const r=i.indexOf(`</${t}>`);-1!==r?i.splice(r,1):n.push({startTag:e,closeTag:`</${t}>`})});const a=n.map(({closeTag:e})=>e).reverse().join(""),o=`${s.join("")}${e}${a}`;r.push(o)}),r.join("<br>")}function bC(e){return e?e.split(/\n/g).join("↵"):e}function SC(e,t){let r;function n(){return t.pictureInPictureActive||cb(t.videoElement)?"showing":"hidden"}function i(){if(0!==t.video.textTracks.length){if(t.video.textTracks.forEach(e=>{e.on("cuechange",s),e.on("modechange",a)}),t.video.textTracks.language){const[r]=t.video.textTracks.language.split(/[-_]/),[n]=t.video.textTracks.language.split(/[-_]/);if(r!==n){const r=`${t.video.textTracks.language}.subtitles`,{track:n}=EC(r,t.video.textTracks);if(n)return void e.fire(ZO,r)}}e.fire(eL)}else e.fire(eL)}function s(t){const r=t.target,n=r.activeCues||[],i=[];let s;for(var a=0,o=n.length;a<o;a++)""!==n[a].text.replace(/^\s+|\s+$/gm,"")&&(s=document.createElement("span"),s.appendChild(n[a].getCueAsHTML()),i.push({html:TC(s.innerHTML),text:bC(n[a].text)}));e.fire(oL,r,i)}function a(r){const n=r.target;cb(t.videoElement)&&"showing"===n.mode&&e.fire(cL,n)}e.on(iL,i),e.on(ZO,function(i){if(r&&r.id===i)return;let s=t.video.textTracks.getTrackById(i),a=!0;s||({track:s,exactMatch:a}=EC(i,t.video.textTracks)),s!==r&&setTimeout(()=>{t.video&&t.video.textTracks.forEach(e=>{e.mode=e===s?n():"disabled"}),e.fire(cL,s,!a),r=s},0)}),e.on(eL,function(){setTimeout(()=>{t.video&&t.video.textTracks&&t.video.textTracks.forEach(e=>{e.mode="disabled"}),e.fire(oL),r&&(r=null,e.fire(cL,null))},0)}),e.on(pR.TEXT_TRACKS_AVAILABLE,i),e.on([lR.ENTER_PICTURE_IN_PICTURE,lR.LEAVE_PICTURE_IN_PICTURE],function(){!function(e){r&&r.mode!==e&&(r.mode=e)}(n())})}const AC="main";function wC(e,t){return Array.from(e).map(e=>({...e,enabled:e.id===t}))}function IC(e){return Array.from(e).find(e=>e.enabled)}function RC(e=[]){return Array.from(e).find(e=>e.kind===AC)}function PC(e){return e.split("-")[0]}function kC(e,t,r,n){const i=t.toLowerCase();return e.find(e=>{const t=n?PC(e.language).toLowerCase():e.language.toLowerCase(),s=n?t===PC(i):t===i,a=!r||r===e.kind;return s&&a})}function DC(e,t={},r=!1){if(!e?.length)return null;t=function(e={}){let{language:t="",kind:r=""}=e;if(!t)return e;let n=t.split(/[.,]/);return t=n[0].trim(),r=r||n[1]?.trim()||"",{...e,language:t,kind:r}}(t);const n=t?.id,i=t?.language,s=t?.kind;if((i===AC||s===AC)&&!r)return RC(e);if(n){const t=e.find(e=>e.id===n);if(t)return t}if(s&&i){const t=kC(e,i,s,!1)||kC(e,i,s,!0);if(t)return t}if(i&&!r){const t=kC(e,i,void 0,!1)||kC(e,i,void 0,!0);if(t)return t}return null}function OC(e,t){let r="translation";return"1"===e.id?r="main":e.label.includes("(Audio description)")?r="descriptions":e.label.includes("(Commentary)")&&(r="commentary"),e.language===t.language&&r===t.kind}function LC({audioTracks:e,config:t}){if(!e?.length)return null;const r=t.embed?.audio_track,n=t.request?.cookie?.audio_language,i=t.request?.cookie?.audio_kind,s=t.request?.lang,a=!0;if(r){const t=DC(e,{language:r});if(t)return t}if(n||i){let t=DC(e,{language:n,kind:i||"main"},a);if(t)return t;if(t=DC(e,{language:n,kind:"translation"},a),t)return t}if(s){let t=DC(e,{language:s,kind:"main"},a);if(t)return t;if(t=DC(e,{language:s,kind:"translation"},a),t)return t}return RC(e)||null}function CC(e,t,r,n=[]){let i,s,a,o,c,u;function l(){const t=e.video.live_event,r=t?.dvr;if(DL(t)||function(e){return e?.status===kO}(t)||LL(t)&&!kL(t))return void(i.video=null);if(OL(t)&&i.video&&!e.isNewVideo())return;let n=e.request.audio_tracks||[];const s=LC({audioTracks:n,config:e}),a=s?.id;n=wC(n,a);const o="sd-fallback"===i.video?.drmHandler?.state,u=OL(t)?function(e){const t=[],r=nC(e);r&&t.push(r);const n=function(e){const t=e.video.live_event,r=e.request.files;if(NL(r.dash))return null;const n=r.dash.default_cdn,i=r.dash.cdns[n].url||t.playback?.dash_noredirect,s=e.request.flags?.live_dash?2:1;return{id:`dash-${n}-${e.video.id}`,src:i,mime:ab.dashMpd,priority:s,metadata:{cdn:n,origin:r.dash.cdns[n].origin,quality:"sd"}}}(e);return n&&t.push(n),t}(e):HL(e,a,o),l=oC(e);if(i.video&&!e.isNewVideo()&&!c&&(!r||kL(t)))return i.video.drmHandler?.updateLAUrls(e.request.drm),void h(u,l);d({files:u,textTracks:l,audioTracks:n,switchingVideo:r,startTime:r&&i.currentTime})}function h(e,t){e.forEach(e=>{const t=i.video.files.getFileById(e.id);t&&t.src!==e.src&&(t.src=e.src)}),t.forEach(e=>{const t=i.video.textTracks.getTrackById(e.id);t&&t.src!==e.src&&(t.src=e.src)})}function d({files:n,textTracks:s,audioTracks:c=[],switchingVideo:l=!1,startTime:h}){const d=e.video.live_event,f=r.getBoundingClientRect(),p=OL(d)?nC(e):function(e){const t=e.request.files;if(!NL(t.hls)){const e=t.hls.default_cdn,r=t.hls.cdns[e],n=r.captions||r.url;return n?{src:n,mime:ab.hls,metadata:{cdn:e,origin:r.origin,quality:"sd"}}:null}return null}(e);u||(u=i.played?.length>0);const _=!i.paused||i._rebufferMonitor?._isBuffering;i._switchingVideo=l,i.video={id:e.video.id,title:e.video.title,subtitle:`from ${e.video.owner.name}`,files:n,textTracks:s,audioTracks:c,chapters:IA(e,"embed.chapters",[]),duration:e.video.duration,externalDisplayFiles:{AirPlay:p},metadata:{playlistRefreshUrl:CL(e,`/playlist/refresh/${p?.metadata.codec}`),useHls:e.request.drm&&Gb.browser.webKit,drm:e.request.drm,drmLaUrlParams:e.request.drm&&{atid:e.request.atid,leadUUID:e.user.lead?.id,playbackRoute:e.request.flags?.ott?"player_embed_ott":"player_embed",playerLocation:e.embed.on_site?"onsite":"embed",dnt:e.request.flags?.dnt??e.embed.dnt,embedContext:e.embed.context,referrer:e.request.referrer},p2pReady:e.video.ecdn&&(a.p2pReady??o.p2pReady),percentShown:SO.frustumSurfaceArea(e.video.spatial.fov,f.width,f.height)}},l?i.checkRebuffer(u,_):t.fire(iL),"number"==typeof h&&(i.currentTime=h),i.updateBufferTarget()}return function(){const t=[CD,eO,GD,rO,JR],n=e.video.ecdn&&!e.request.flags?.ecdn_delta_updates;i=new mO(r,t,{externalDisplays:[AirPlayExternalDisplay],mediaSourceScanner:{droppedFrameSwitchPercent:aC(e)},tests:e.request.ab_tests,fileCodecs:e.request.file_codecs,presentationDelay:e.video.presentation_delay,lowLatencyMode:e.video.live_event?.low_latency,dvrEnabled:e.video.live_event?.dvr,disableDeltaUpdates:n,getLiveEventStartTimeEpoch:()=>function(e){return e?.started_on?new Date(e.started_on).getTime()/1e3:e?.ingest?.start_time}(e.video.live_event),sessionMetadata:{clipId:e.video.id,sessionId:e.request.session},disableMMS:!!e.request.flags?.disable_mms||!Gb.iOS,enableCMCD:e.request.flags?.cmcd,hlsJsDebugMode:e.request.flags?.hls_js_debug})}(),Object.values(lR).filter(e=>![lR.TIME_UPDATE,lR.PROGRESS,lR.SUSPEND,lR.ERROR].includes(e)).forEach(e=>{i.on(e,(t="")=>{lC.captureBreadcrumb(e,t,"video event")})}),i.on(pR.STREAMS_LOADED,function(t){t.video.forEach(t=>{const r=function(e,t){return t.find(t=>zL(t.id)===String(e)||zL(t.id)===zL(e))}(t.id,iC(e,i));r?(t.profile=r.profile,t.quality=r.quality,t.fps=r.fps):(t.profile=null,t.quality=`${t.height}p`,t.fps=t.framerate)})}),i.on(pR.STREAM_CHANGE,function({index:e,streams:r,metadata:n}){const s=r[e];lC.captureBreadcrumb("Stream changed",s,"video"),i.updateBufferTarget(),t.fire(pR.STREAM_CHANGE,s,e,r,n)}),i.on(pR.STREAM_TARGET_CHANGE,function({index:e,streams:r}){const n=r[e];i.updateBufferTarget(),t.fire(pR.STREAM_TARGET_CHANGE,n,e,r)}),i.on(pR.DRM_KEY_SWITCH,function(){if(!e.request.drm.fallback_asset)return;const t=oC(e),r=IC(i.video.audioTracks)?.id;h(XL(e,r),t)}),function(e,t){[dR.ACTIVATED,dR.AVAILABLE,dR.DEACTIVATED,dR.UNAVAILABLE,_R.STREAM_OFFLINE,_R.STREAM_ONLINE,_R.BUFFER_GAP_JUMP,_R.BUFFER_GAP_JUMP_PREVENT,_R.STALL_JUMP,_R.LATENCY_UPDATED,mR.MEDIASESSION_PAUSE,mR.MEDIASESSION_PLAY,mR.MEDIASESSION_SEEK_BACKWARD,mR.MEDIASESSION_SEEK_FORWARD,mR.MEDIASESSION_SEEK_TO,pR.AUDIO_TRACK_CHANGED,pR.AV_DURATION_MISMATCH,pR.BANDWIDTH,pR.BUFFER_ENDED,pR.BUFFER_OCCUPANCY,pR.BUFFER_STARTED,pR.CHAPTER_CUES_UPDATED,pR.CUE_POINT,pR.NO_SUPPORTED_CDM,pR.CURRENT_FILE_CHANGE,pR.DOWNLOAD_END,pR.DOWNLOAD_TIMEOUT,pR.DRM_AUTH_SUCCESS,pR.DRM_CDM_CHANGE,pR.DRM_KEY_SWITCH,pR.DROPPED_FRAMES,pR.MANIFEST_LOADED,pR.MANIFEST_TIMEOUT,pR.QUOTA_EXCEEDED_ERROR,pR.SCANNER_CHANGE,pR.STREAM_CHANGE_START,pR.STREAM_BUFFER_END,pR.STREAM_BUFFER_START,pR.STREAMS_LOADED,pR.AVAILABLE_STREAMS_CHANGED,pR.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,pR.TEXT_TRACKS_AVAILABLE,pR.DROPPED_FRAME_PERCENT_EXCEEDED,pR.LOAD_SEGMENT_FAILED,pR.SEGMENT_CUES_LOADED,pR.HLS_JS_ERROR,vR.CAMERA_UPDATE,vR.CAMERA_CHANGE,vR.MOTION_END,vR.MOTION_START,vR.SPATIAL_UNSUPPORTED,vR.WEBVR_ENTER,vR.WEBVR_EXIT,vR.WEBVR_HARDWARE_AVAILABLE,lR.DURATION_CHANGE,lR.ERROR,lR.LOAD_START,lR.LOADED_DATA,lR.LOADED_METADATA,lR.PLAYING,lR.RATE_CHANGE,lR.RESIZE,lR.STALLED,lR.VOLUME_CHANGE,lR.WAITING,lR.ENTER_PICTURE_IN_PICTURE,lR.LEAVE_PICTURE_IN_PICTURE,lR.WEBKIT_BEGIN_FULLSCREEN,lR.WEBKIT_END_FULLSCREEN].forEach(r=>{e(r,(...e)=>{t(r,...e)})})}(i.on,t.fire),t.fire(nL),new SC(t,i),new dC(e,t,i),new fC(e,t,i),new yC(e,t,i),a=new mC(e,t,i),s=new hC(e,t,i),o=new gC(e,t,i),t.on(rL,l),t.on(tL,function(r){if(!e.embed?.settings?.audio_tracks)return;if(i.supportsAudioTracksFromScanner)return void i.enableAudioTrack(r?.id);const n=function(e,t={}){if(!e?.length)return[];const r=DC(e,t);if(r)return wC(e,r.id);const n=RC(e);return wC(e,n?.id)}(e.request.audio_tracks,r),s=IC(n),a="sd-fallback"===i.video?.drmHandler?.state;d({files:HL(e,s?.id,a),textTracks:i.video.textTracks,audioTracks:n,switchingVideo:!0,startTime:i.currentTime}),t.fire(pR.AUDIO_TRACK_CHANGED)}),t.on(lR.LOADED_DATA,function(){i.supportsAudioTracksFromScanner&&i.audioTracks?.length&&(e?.request?.audio_tracks?.length?function(){const t=LC({audioTracks:e.request.audio_tracks||[],config:e}),r=function(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(OC(n,t))return n}return null}(i.audioTracks,t);r&&i.enableAudioTrack(r.id)}():function(){const t=LC({audioTracks:Array.from(i.audioTracks||[]),config:e});i.enableAudioTrack(t.id)}())}),Gb.browser.safari&&window.addEventListener("pageshow",e=>{e.persisted&&(c=!0,l())}),sb({telecine:i},s)}function MC(e,t,r){this.constructorName="BackboneError",this.message=e,this.name=t,this.source=r}MC.prototype=new Error;var NC={embed:{},request:{cookie:{},files:{},flags:{},urls:{},text_tracks:[],file_codecs:{}},video:{owner:{},thumbnail_url:"",version:{}},user:{}};function xC(e,t,r=[]){let n;const i=new nw;let s,a,o=null,c=new UL(t,NC);function u(e,t){return i.fire(rL,e,t),e}const l={play:()=>s.play(),pause:()=>s.pause(),get currentTime(){return a.currentTime>.1?KO(a.currentTime):0},set currentTime(e){if(e=parseFloat(e),isNaN(e)||e<0)throw new MC("Seconds must be a positive number less than the duration of the video.","RangeError","setCurrentTime");i.fire($O,e)},get liveEdgeTime(){return a.liveEdgeTime},get atLiveEdge(){return a.atLiveEdge},get liveTailTime(){return a.liveTailTime},get atLiveTail(){return a.atLiveTail},get duration(){return KO(c.video.duration)},get enabledTextTrack(){return o},loadVideo(e){const t=VI(c);return c.reset(e),c=u(c,t),this},reactivate(){return a?.reactivate&&a.reactivate(),this},unload(){return i.fire(JO),this},destroy(){return i.fire(QO),this},on(e,t){return i.on(e,t),this},once(e,t){return i.once(e,t),this},off(e,t){return i.off(e,t),this},get events(){return i},hasTextTrack(e){let t,r,n=this.textTracks;if(GO(e))r=n.getTrackById(e);else{let r=e.split(".")[0];t=n.some(e=>e.language.toLowerCase()===r.toLowerCase())}return!(!r&&!t)},enableTextTrack(e,t=null){let r,n,s=this.textTracks;if(GO(e))o=s.getTrackById(e);else{if([r,n=t]=e.split("."),!this.hasTextTrack(e))throw new MC(`There are no tracks for “${r.toUpperCase()}”.`,"InvalidTrackLanguageError","enableTextTrack");o=EC(n?`${r}.${n}`:r,s).track}if(!o||n&&o.kind!==n)throw new MC(`There are no ${n} tracks for “${r.toUpperCase()}”.`,"InvalidTrackError","enableTextTrack");a.setCaptionsShouldDisplay(!0),i.fire(ZO,o.id)},disableTextTrack(){o=null,a.setCaptionsShouldDisplay(!1),i.fire(eL)},enableAudioTrack(e){i.fire(tL,e)},get qualities(){return function(e){const t=e.representations.map(t=>{const r=BL(t);return{id:r,label:sC(t),active:e.quality===r}}),r=e.video?.currentFile.mime;return[ab.dash,ab.dashMpd,ab.hlsLive,ab.hls].includes(r)&&t.unshift({id:"auto",label:"Auto",active:!e.quality||"auto"===e.quality}),t}(this)},get quality(){return s.quality},set quality(e){s.quality=e},get playbackRate(){return a?a.playbackRate:1},set playbackRate(e){a.playbackRate=e,a.defaultPlaybackRate=e},get textTracks(){return a.video?a.video.textTracks:[]},get representations(){return iC(c,a)},get volume(){return a?a.volume:KO(c.request.cookie.volume)},set volume(e){if(e=parseFloat(e),isNaN(e)||e<0||e>1)throw new MC("Volume should be a number between 0 and 1.","RangeError","setVolume");a.volume=e},get videoId(){return c.video.id},get videoWidth(){return a.videoWidth||c.video.width},get videoHeight(){return a.videoHeight||c.video.height},get readyState(){return a.videoElement.readyState},get telecine(){return a},get audioTracks(){return a?.video?.audioTracks||[]},get enabledAudioTrack(){return a?.video?.enabledAudioTrack},requestCompleteLiveSubtitles(){i.fire(dL)},get hasAudio(){return!!a?.video?.audioTracks?.length||!!a.manifest?.audio?.length}};return c=u(c),s=new CC(c,i,e,r),a=s.telecine,n=Object.create(a),sb(n,l)}function UC(e){return"string"==typeof e||!kS(e)&&BS(e)&&"[object String]"==jS(e)}function FC(e){return Math.round(parseInt(e,16)/255*100)/100}function VC(...e){if(1===e.length&&e[0]instanceof VC){var t=e[0];return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this}if(1===e.length){if("string"==typeof e[0]&&e[0].indexOf("rgb")>=0)return this.rgba=function(e){var t=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([\d.]+))?\)/.exec(e);if(!t)throw new Error("Invalid rgb value");return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(t[5])||1}}(e[0]),this;if(!function(e){return"string"==typeof(e=e.replace("#",""))&&[3,4,6,8].includes(e.length)&&!isNaN(parseInt(e,16))}(`${e[0]}`))throw new Error("Invalid hex value");const{hex:t,alpha:r}=function(e){let t=1;return 4===(e=e.replace("#","")).length&&(t=FC(e.slice(3)+e.slice(3)),e=e.slice(0,3)),8===e.length&&(t=FC(e.slice(6,8)),e=e.slice(0,6)),{hex:e,alpha:t}}(`${e[0]}`);return this.hex=t,this.alpha=r,this}if(3===e.length||4===e.length){for(var r=0;r<3;r++)if(isNaN(parseInt(e[r],10))||parseInt(e[r],10)<0||parseInt(e[r],10)>255)throw new Error("Invalid rgb value");if(e[3]&&parseFloat(e[3])<0||parseFloat(e[3])>1)throw new Error("Invalid alpha value");return this.rgba={red:e[0],green:e[1],blue:e[2],alpha:parseFloat(e[3])||1},this}throw new Error("Invalid color")}function jC(){let e=0,t=null,r=0,n=!1;function i(){return e/1e3}return{trackBufferStart:function(e,i){t=rS(),r++,n=!0,e(i)},trackBufferEnd:function(r,i={}){if(!n)return;const s=sS(t);e+=s,i.buffer_duration=s/1e3,n=!1,r(i)},trackVideoExit:function(r){n&&!r&&(e+=sS(t))},resetLastBufferTime:function(){t=null},getBufferRatio:function(e){const t=i()/e*100;return isNaN(t)?0:Math.round(100*t)/100},getBufferCount:function(){return r},getTotalBufferDuration:i,isVideoBuffering:function(){return n}}}VC.prototype={get complement(){var e=this.clone();return e.rgb={red:255-this.red,green:255-this.green,blue:255-this.blue},e},get hex(){return VC.rgbToHex(this.red,this.green,this.blue)},get hexWithAlpha(){const e=("0"+Math.round(255*this.alpha).toString(16)).slice(-2);return VC.rgbToHex(this.red,this.green,this.blue)+e},set hex(e){return this.rgba=VC.hexToRgb(e),this},get hsl(){return"hsl("+this.hue+","+this.saturation+"%,"+Math.round(this.lightness)+"%)"},set hsl(e){this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness;var t=VC.hslToRgb(e.hue,e.saturation,e.lightness);return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this},get luminance(){function e(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*e(this.red/255)+.7152*e(this.green/255)+.0722*e(this.blue/255)},get rgb(){return"rgb("+this.red+","+this.green+","+this.blue+")"},set rgb(e){return this.rgba=e,this},get rgba(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},set rgba(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha||1;var t=VC.rgbToHsl(e.red,e.green,e.blue);return this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this},get yiq(){return(299*this.red+587*this.green+114*this.blue)/1e3},clone:function(){return new VC(this)},lighten:function(e,t,r){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness+e},t&&r)for(var n=r.contrast(this).ratio;n<t&&(this.lighten(5),n=r.contrast(this).ratio,!(this.lightness>=100)););return this},darken:function(e,t,r){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness-e},t&&r)for(var n=r.contrast(this).ratio;n<t&&(this.darken(5),n=r.contrast(this).ratio,!(this.lightness<=0)););return this},overlayOn:function(e){if(this.alpha>=1)return this;var t=this.clone();return t.rgba={red:t.red*this.alpha+e.red*e.alpha*(1-this.alpha),green:t.green*this.alpha+e.green*e.alpha*(1-this.alpha),blue:t.blue*this.alpha+e.blue*e.alpha*(1-this.alpha),alpha:t.alpha+e.alpha*(1-this.alpha)},t},contrast:function(e){var t=this.alpha;if(t>=1){e.alpha<1&&(e=e.overlayOn(this));var r=this.luminance+.05,n=e.luminance+.05,i=r/n;return n>r&&(i=1/i),{ratio:i=Math.round(10*i)/10,error:0,min:i,max:i}}var s=this.overlayOn(VC.white).contrast(e).ratio,a=this.overlayOn(VC.black).contrast(e).ratio,o=Math.max(s,a),c={red:Math.min(Math.max(0,(e.red-this.red*t)/(1-t)),255),green:Math.min(Math.max(0,(e.green-this.green*t)/(1-t)),255),blue:Math.min(Math.max(0,(e.blue-this.blue*t)/(1-t)),255)},u=this.clone();u.rgb=c;var l=this.overlayOn(u).contrast(e).ratio;return{ratio:Math.round((l+o)/2*10)/10,error:Math.round((o-l)/2*10)/10,min:l,max:o,closest:u,farthest:a===o?VC.white:VC.black}},wcagAACompliant:function(e){return this.contrast(e).ratio>=4.5},wcagAAACompliant:function(e){return this.contrast(e).ratio>=7},yiqContrastColor:function(){return this.yiq>=120?new VC(0,0,0):new VC(255,255,255)}},VC.hexToRgb=function(e){var t;return 3===(e=String(e)).length||4===e.length?(t=/^#?([A-Fa-f0-9])([A-Fa-f0-9])([A-Fa-f0-9])$/i.exec(e))&&(t[1]+=t[1],t[2]+=t[2],t[3]+=t[3]):t=/^#?([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})$/i.exec(e),t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null},VC.rgbToHex=function(e,t,r){return"#"+((1<<24)+(Math.round(e)<<16)+(Math.round(t)<<8)+Math.round(r)).toString(16).slice(1)},VC.rgbToHsl=function(e,t,r){e/=255,t/=255,r/=255;var n,i=Math.max(e,t,r),s=Math.min(e,t,r),a=(i+s)/2,o=a;if(i===s)return{hue:0,saturation:0,lightness:100*o};var c=i-s;return n=o>.5?c/(2-i-s):c/(i+s),i===e?a=(t-r)/c+(t<r?6:0):i===t?a=(r-e)/c+2:i===r&&(a=(e-t)/c+4),a/=6,{hue:Math.round(360*a),saturation:Math.round(100*n),lightness:Math.round(100*o)}},VC.hslToRgb=function(e,t,r){function n(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+6*(2/3-r)*(t-e):e}if(e/=360,r/=100,0==(t/=100))return{red:Math.floor(255*r),green:Math.floor(255*r),blue:Math.floor(255*r)};var i=r<.5?r*(1+t):r+t-t*r,s=2*r-i;return{red:Math.floor(255*n(s,i,e+1/3)),green:Math.floor(255*n(s,i,e)),blue:Math.floor(255*n(s,i,e-1/3))}},VC.hslToHex=function(e,t,r){var n=VC.hslToRgb(e,t,r);return VC.rgbToHex(n.red,n.green,n.blue)},VC.white=new VC("fff"),VC.black=new VC("000");const BC={VIDEO_BUFFER_END:"video-buffer-end",VIDEO_BUFFER_START:"video-buffer-start",VIDEO_ENDED:"video-ended",VIDEO_EXIT:"video-exit",VIDEO_LOAD_FAILURE:"video-load-failure",VIDEO_MINUTE_WATCHED:"video-minute-watched",VIDEO_PAUSED:"video-paused",VIDEO_PLAYED:"video-played",VIDEO_PLAYBACK_ERROR:"video-playback-error",VIDEO_READY:"video-ready",VIDEO_START_ATTEMPT:"video-start-attempt",VIDEO_START_FAILURE:"video-start-failure",VIDEO_START_TIME:"video-start-time",VIDEO_SEEK:"video-seek",VIDEO_SEEKED:"video-seeked",CHUNK_DOWNLOADED:"chunk-downloaded"};function HC(e){function t(e,t,r=!0,n="POST"){return new Promise((i,s)=>{"POST"===n&&navigator.sendBeacon?i({status:navigator.sendBeacon(e,t)}):yS({url:e,body:t,method:n,async:r,headers:{"Content-Type":"text/plain; charset=UTF-8"}}).then(e=>{i({response:e,status:e.status})}).catch(s)})}return{log:function(r,n=!0,i=!0){i&&(r.event_time=r.event_time||rS());const s=[r];return t(e,JSON.stringify(s),n)},logRequestPromiseWithUrl:t}}var XC=function(){return LS.Date.now()},WC=Math.max,qC=Math.min;function GC(e,t,r){var n,i,s,a,o,c,u=0,l=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var r=n,s=i;return n=i=void 0,u=t,a=e.apply(s,r)}function p(e){var r=e-c;return void 0===c||r>=t||r<0||h&&e-u>=s}function _(){var e=XC();if(p(e))return v(e);o=setTimeout(_,function(e){var r=t-(e-c);return h?qC(r,s-(e-u)):r}(e))}function v(e){return o=void 0,d&&n?f(e):(n=i=void 0,a)}function m(){var e=XC(),r=p(e);if(n=arguments,i=this,c=e,r){if(void 0===o)return function(e){return u=e,o=setTimeout(_,t),l?f(e):a}(c);if(h)return clearTimeout(o),o=setTimeout(_,t),f(c)}return void 0===o&&(o=setTimeout(_,t)),a}return t=BO(t)||0,qS(r)&&(l=!!r.leading,s=(h="maxWait"in r)?WC(BO(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d),m.cancel=function(){void 0!==o&&clearTimeout(o),u=0,n=c=i=o=void 0},m.flush=function(){return void 0===o?a:v(XC())},m}const KC="playing";function YC(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;var r=Math.pow(10,t);return Math.round(e*r)/r}function zC(e,t){let r,n,i,s,a,o,c,u,l,h,d,f,p,_,v=0;function m(){r=0,n=0,i=0,s=0,a=0,o=null,c=0,u=!1,l=!1,h=null,d=!1,f=function(e){let t=0,r=0,n=0,i=0,s=!1,a=-1,o=null,c=null,u=null,l={satisfied:0,tolerable:0,frustrated:0},h=null;function d(){const t=e.getBoundingClientRect(),r=e.videoWidth,n=e.videoHeight;if(0===r&&0===n)return;const i="satisfied";let s=i;if(t.width>r&&t.height>n&&(r/t.width<.4?s=i:r/t.width<1?s="tolerable":r/t.width>1&&(s="frustrated")),c){const e=sS(c);l[u]+=e}u=s,c=rS()}function f(){return s?0:1}function p(){return-1===a?null:a>8e3||-1===a?0:a>2e3?.5:1}function _(){return h?(i=n/sS(h),t>=4||i>=.12?0:t<4&&0!==t?i<.12?.5:0:1):null}function v(){if(-1===a)return null;d();const e=Object.keys(l).reduce((e,t)=>l[e]>l[t]?e:t);switch(e){case"satisfied":return 1;case"tolerable":return.5;case"frustrated":return 0}return null}return e.addEventListener(KC,()=>{-1===a&&(o=rS())}),e.addEventListener("progress",()=>{-1===a&&(h=rS(),a=sS(o)),d()}),{startupTimeScore:p,rebufferScore:_,failureScore:f,videoQualityScore:v,overallScore:function(){return Math.min(f(),p(),_(),v())},trackBufferStart:function(){-1!==a&&(t++,r=rS())},trackBufferEnd:function(){-1!==a&&(n+=sS(r))},onError:function(e){e.final&&(s=!0)}}}(e),p=jC(),_={bufferTracker:p,videoBufferCheck:()=>{setInterval(()=>{let t=e.currentTime;l&&!d&&!e.paused&&!_.bufferTracker.isVideoBuffering()&&t<a+.125&&_.bufferTracker.trackBufferStart(T),l&&!e.paused&&_.bufferTracker.isVideoBuffering()&&t>a+.125&&(_.bufferTracker.trackBufferEnd(b),_.bufferTracker.resetLastBufferTime()),a=t},250)},addEventData:e=>null,playbackSessionTimer:()=>{let t=rS();setInterval(()=>{(!e.paused&&u||d||_.bufferTracker.isVideoBuffering())&&(c+=sS(t)/1e3),t=rS()},500)},customMinuteTracker:{shouldCount:()=>!1,onCount:()=>{}}}}function g(e,r={}){0===v&&(r=Object.assign(r,_.addEventData(e)),t(e,r))}const y=GC(()=>{o=rS(),g(BC.VIDEO_SEEK)},500,{leading:!0,trailing:!1}),E=GC(e=>{g(BC.VIDEO_SEEKED,{seek_duration:e}),o=null},500);function T(e={}){f.trackBufferStart(),g(BC.VIDEO_BUFFER_START,e)}function b(e={}){f.trackBufferEnd(),g(BC.VIDEO_BUFFER_END,e)}return m(),g(BC.VIDEO_READY),function(){let t=Math.ceil(59*Math.random());setInterval(()=>{function a(e,r){return 0===e?r===t:r>=60}!e.paused&&u&&(r++,_.customMinuteTracker?.shouldCount?.()&&n++,a(i,r)&&(r=0,i++,g(BC.VIDEO_MINUTE_WATCHED)),a(s,n)&&_.customMinuteTracker?.shouldCount?.()&&(n=0,s++,_.customMinuteTracker?.onCount?.(s)))},1e3)}(),window.addEventListener("pagehide",t=>{_.bufferTracker.trackVideoExit(e.paused);const r={startup:f.startupTimeScore(),rebuffer:f.rebufferScore(),failure:f.failureScore(),quality:f.videoQualityScore(),overall:f.overallScore()};h&&g(BC.VIDEO_EXIT,{vxs:r})},!1),e.addEventListener(KC,()=>{u=!0,d||l&&g(BC.VIDEO_PLAYED)}),e.addEventListener("timeupdate",()=>{if(l)return;let e={startup_duration:h?YC(sS(h)/1e3,2):null};g(BC.VIDEO_START_TIME,e),l=!0}),e.addEventListener("pause",()=>{u=!1,g(BC.VIDEO_PAUSED)}),e.addEventListener("seeking",()=>{d||(d=!0,u=!1,y())}),e.addEventListener("seeked",()=>{d=!1,e.paused||(u=!0),E(sS(o)/1e3)}),e.addEventListener("ended",()=>{g(BC.VIDEO_ENDED)}),e.addEventListener("waiting",()=>{u=!1}),e.addEventListener("canplay",()=>{d||_.bufferTracker.isVideoBuffering()&&!u&&(_.bufferTracker.trackBufferEnd(b),_.bufferTracker.resetLastBufferTime())}),{globalProperties:function(){return{autoplay:e.autoplay,buffer_count:_.bufferTracker.getBufferCount(),total_buffer_duration:_.bufferTracker.getTotalBufferDuration(),buffer_ratio:_.bufferTracker.getBufferRatio(c),client_time:rS(),is_buffering:_.bufferTracker.isVideoBuffering(),looping:e.loop,minutes_watched:i,muted:e.muted,network_state:e.networkState,playback_rate:e.playbackRate,player_width:e.getBoundingClientRect().width,player_height:e.getBoundingClientRect().height,session_playback_duration:YC(c,2),video_time:e.currentTime,video_height:e.videoHeight,video_width:e.videoWidth,volume:YC(e.volume,2)}},logStartRequest:function(){h=rS(),g(BC.VIDEO_START_ATTEMPT)},customizeHooks:function(e){_=Object.assign(_,e)},initHooks:function(){_.videoBufferCheck(),_.playbackSessionTimer()},logBufferStart:T,logBufferEnd:b,setDisplayContext:function(e){v=e},handleExternalError:function(e,t){u=!1,f.onError(t),g(l?BC.VIDEO_PLAYBACK_ERROR:l?BC.VIDEO_START_FAILURE:BC.VIDEO_LOAD_FAILURE,e)},reset:m}}function $C(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return qS(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),GC(e,t,{leading:n,maxWait:t,trailing:i})}var JC,QC=0,ZC=0,eM={},tM={};function rM(e,t,r){return"_root"==t?r:e!==r?function(e){return JC||(JC=e.matches?e.matches:e.webkitMatchesSelector?e.webkitMatchesSelector:e.mozMatchesSelector?e.mozMatchesSelector:e.msMatchesSelector?e.msMatchesSelector:e.oMatchesSelector?e.oMatchesSelector:aM.matchesSelector)}(e).call(e,t)?e:e.parentNode?(QC++,rM(e.parentNode,t,r)):void 0:void 0}function nM(e,t,r,n){eM[e.id]||(eM[e.id]={}),eM[e.id][t]||(eM[e.id][t]={}),eM[e.id][t][r]||(eM[e.id][t][r]=[]),eM[e.id][t][r].push(n)}function iM(e,t,r,n){if(eM[e.id])if(t)if(n||r)if(n){if(eM[e.id][t][r])for(var i=0;i<eM[e.id][t][r].length;i++)if(eM[e.id][t][r][i]===n){eM[e.id][t][r].splice(i,1);break}}else delete eM[e.id][t][r];else eM[e.id][t]={};else for(var s in eM[e.id])eM[e.id].hasOwnProperty(s)&&(eM[e.id][s]={})}function sM(e,t,r,n){if(this.element){e instanceof Array||(e=[e]),r||"function"!=typeof t||(r=t,t="_root");var i,s=this.id;for(i=0;i<e.length;i++)n?iM(this,e[i],t,r):(eM[s]&&eM[s][e[i]]||aM.addEvent(this,e[i],a(e[i])),nM(this,e[i],t,r));return this}function a(e){return function(t){!function(e,t,r){if(eM[e][r]){var n,i,s=t.target||t.srcElement,a={},o=0,c=0;for(n in QC=0,eM[e][r])eM[e][r].hasOwnProperty(n)&&(i=rM(s,n,tM[e].element))&&aM.matchesEvent(r,tM[e].element,i,"_root"==n,t)&&(QC++,eM[e][r][n].match=i,a[QC]=eM[e][r][n]);for(t.stopPropagation=function(){t.cancelBubble=!0},o=0;o<=QC;o++)if(a[o])for(c=0;c<a[o].length;c++){if(!1===a[o][c].call(a[o].match,t))return void aM.cancel(t);if(t.cancelBubble)return}}}(s,t,e)}}}function aM(e,t){if(!(this instanceof aM)){for(var r in tM)if(tM[r].element===e)return tM[r];return ZC++,tM[ZC]=new aM(e,ZC),tM[ZC]}this.element=e,this.id=t}aM.prototype.on=function(e,t,r){return sM.call(this,e,t,r)},aM.prototype.off=function(e,t,r){return sM.call(this,e,t,r,!0)},aM.matchesSelector=function(){},aM.cancel=function(e){e.preventDefault(),e.stopPropagation()},aM.addEvent=function(e,t,r){var n="blur"==t||"focus"==t,i=Gb.passiveEvents?{capture:n,passive:!1}:n;e.element.addEventListener(t,r,i)},aM.matchesEvent=function(){return!0};const oM=aM.addEvent,cM=void 0===window.PointerEvent&&void 0!==window.MSPointerEvent,uM={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointerover:"MSPointerOver",pointerout:"MSPointerOut"},lM="onmspointerenter"in document,hM="onmspointerleave"in document;aM.addEvent=function(e,t,r){cM&&uM[t]&&(t=uM[t]),"transitionend"===t&&(oM(e,"webkitTransitionEnd",r),oM(e,"otransitionend",r)),"mouseenter"===t&&(t="mouseover"),"mouseleave"===t&&(t="mouseout"),"MSPointerEnter"!==t||lM||(t="MSPointerOver"),"MSPointerLeave"!==t||hM||(t="MSPointerOut"),oM(e,t,r)},aM.matchesEvent=function(e,t,r,n,i){return!("mouseenter"===e||"mouseleave"===e||!lM&&"MSPointerEnter"===e||!hM&&"MSPointerLeave"===e)||function(e,t,r,n){return!n.relatedTarget||(!r||e===t)&&t!==n.relatedTarget&&!t.contains(n.relatedTarget)}(t,r,n,i)};const dM={SETUP_DONE:"SETUP_DONE",NOT_SETUP:"NOT_SETUP"};class fM{constructor(){this.version="1.2.36",this.remotePlayer=null,this.remotePlayerController=null,this.CastContextEventType=null,this.RemotePlayerEventType=null,this.CastState=dM,this.SessionState=null,this.PlayerState=null,this.currentLoadRequestId=null,this.currentLoadingMediaPromise=null}get isGCastApiAvailable(){return!!("undefined"!=typeof cast&&cast&&cast.framework&&cast.framework.VERSION)}get castState(){return this.castContext?this.castContext.getCastState():this.isGCastApiAvailable?this.CastState.SETUP_DONE:this.CastState.NOT_SETUP}get versionGCastApi(){return this.isGCastApiAvailable?cast.framework.VERSION:null}get castContext(){return this.isGCastApiAvailable?cast.framework.CastContext.getInstance():null}get currentSession(){return this.castContext?this.castContext.getCurrentSession():null}get currentSessionObj(){const e=this.currentSession;return e?e.getSessionObj():null}get isInitialized(){return!(!this.isGCastApiAvailable||!this.remotePlayerController)}get isSessionEstablished(){const e=this.currentSessionObj;return!!e&&e.status===chrome.cast.SessionStatus.CONNECTED}get isCastConnected(){return this.castState===this.CastState.CONNECTED}init({receiverApplicationId:e="",resumeSavedSession:t=!0,language:r=null,autoJoinPolicy:n="TAB_AND_ORIGIN_SCOPED"}={}){if(!this.isGCastApiAvailable)throw new Error("CAF is not available. Call setup() first.");if("string"!=typeof e||""===e.trim())throw new Error("Parameter 'receiverApplicationId' must be valid.");switch(n){case chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.PAGE_SCOPED:break;default:n=chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED}return this.CastContextEventType=cast.framework.CastContextEventType,this.RemotePlayerEventType=cast.framework.RemotePlayerEventType,this.CastState=Object.assign(this.CastState,cast.framework.CastState),this.SessionState=cast.framework.SessionState,this.PlayerState=chrome.cast.media.PlayerState,cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:e.trim(),resumeSavedSession:t,language:r,autoJoinPolicy:n}),this.isInitialized?this.remotePlayerController:this.initRemotePlayer()}initRemotePlayer(){if(!this.isGCastApiAvailable)throw new ReferenceError("CAF is not available. Call setup() first.");return this.remotePlayer=new cast.framework.RemotePlayer,this.remotePlayerController=new cast.framework.RemotePlayerController(this.remotePlayer),this.remotePlayerController}setup({loadLibrary:e=!0}={}){return new Promise((t,r)=>{if(this.isGCastApiAvailable)return this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,void t(!0);window.__onGCastApiAvailable=(e,n)=>{let i;n?(i=new Error(n),r(i)):chrome.cast?(this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,t(e)):(i=new ReferenceError("Cast is not available on this browser."),r(i))};try{if(!1===e)throw new ReferenceError("Cast is not available. Make sure the library has been loaded.");this.loadLibrary()||t(!1)}catch(e){const t=new Error(e);r(t)}})}loadLibrary(){if(this.isGCastApiAvailable)return!0;if(null!==window.chrome&&void 0!==window.chrome&&"Google Inc."===window.navigator.vendor){let e="//www.gstatic.com/cv/js/sender/v1/cast_sender.js";if(!(document.querySelectorAll('script[src^="'+e+'"]').length>0)){e+="?loadCastFramework=1";const t=document.createElement("script");return t.src=e,t.async=!0,t.defer=!0,document.head.appendChild(t),!0}}return!1}loadMedia({contentId:e,contentType:t,currentTime:r=0,duration:n=0,requestCustomData:i=null,mediaCustomData:s=null,autoRequest:a=!1,tracks:o=[],ottCastOptions:c}){return e?this.isSessionEstablished?this.loadMediaOnSession(this.currentSession,{contentId:e,contentType:t,currentTime:r,duration:n,requestCustomData:i,mediaCustomData:s,tracks:o,ottCastOptions:c}):!0!==a?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then(a=>this.loadMediaOnSession(a,{contentId:e,contentType:t,currentTime:r,duration:n,requestCustomData:i,mediaCustomData:s,tracks:o,ottCastOptions:c})):Promise.reject(new TypeError("Option 'contentId' must be valid."))}loadMediaOnSession(e,{contentId:t,contentType:r,currentTime:n=0,duration:i,requestCustomData:s=null,mediaCustomData:a=null,tracks:o=[],ottCastOptions:c}){if(e&&e instanceof cast.framework.CastSession){const u=e.getSessionState();if(u!==this.SessionState.SESSION_STARTING&&u!==this.SessionState.SESSION_STARTED&&u!==this.SessionState.SESSION_RESUMED)return Promise.reject(new ReferenceError("Session must be established."));const l=this.createLoadRequest(t,r,n,i,s,a,o,c);return null!==this.currentLoadRequestId&&this.currentLoadRequestId===l.requestId||(this.currentLoadRequestId=l.requestId,this.currentLoadingMediaPromise=e.loadMedia(l).finally(()=>{this.currentLoadRequestId=null,this.currentLoadingMediaPromise=null})),this.currentLoadingMediaPromise}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))}requestSession(){return this.isSessionEstablished?Promise.resolve(this.currentSession):this.castContext?this.castContext.requestSession().then(()=>this.currentSession):Promise.reject(new Error("CastContext is not available. Call setup() first."))}sendMessage({namespace:e,data:t={},autoRequest:r=!1}){return this.isSessionEstablished?this.sendMessageOnSession(this.currentSession,{namespace:e,data:t}):!0!==r?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then(r=>this.sendMessageOnSession(r,{namespace:e,data:t}))}sendMessageOnSession(e,{namespace:t,data:r={}}){if(e||!(e instanceof cast.framework.CastSession)){const n=e.getSessionState();return n!==this.SessionState.SESSION_STARTING&&n!==this.SessionState.SESSION_STARTED&&n!==this.SessionState.SESSION_RESUMED?Promise.reject(new ReferenceError("Session must be established.")):e.sendMessage(t,r)}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))}createCastButton(e){const t=document.createElement("button","google-cast-button");return e&&e.style&&(null===e.style["--disconnected-color"]&&(e.style["--disconnected-color"]="#00ADEF"),null===e.style["--connected-color"]&&(e.style["--connected-color"]="#E5E500")),e&&Object.keys(e).forEach(r=>{if("string"==typeof e[r])t.setAttribute(r,e[r]);else if("style"===r&&"object"==typeof e[r]){let n="";Object.keys(e[r]).forEach(t=>{n+=t+":"+e[r][t]+";"}),t.setAttribute(r,n)}}),t}createLoadRequest(e,t,r,n,i,s,a,o){const c=o?new chrome.cast.media.MediaInfo(o.contentId):new chrome.cast.media.MediaInfo(e.toString(),t);c.customData=s,c.duration=n;const u={subtitles:chrome.cast.media.TextTrackType.SUBTITLES,captions:chrome.cast.media.TextTrackType.CAPTIONS};c.tracks=a.map(e=>{const t=new chrome.cast.media.Track(e.id,chrome.cast.media.TrackType.TEXT);return t.trackContentId=e.url,t.trackContentType="text/vtt",t.subtype=u[e.kind],t.name=e.label,t.language=e.lang,t});const l=new chrome.cast.media.LoadRequest(c);return l.customData=o?o.customData:i,l.currentTime=r||0,o&&(l.credentials=o.credentials,l.credentialsType=o.credentialsType),l}}function pM(e,t){return null==e||e!=e?t:e}function _M(e,t,r){this.constructorName="MessageApiError",this.message=e,this.name=t,this.source=r}function vM(e){return e}function mM(e){if(!e||""===e)return{};if("object"==typeof e)return e;try{return JSON.parse(e)}catch(e){return{}}}function gM(e){}_M.prototype=new Error;let yM={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},EM=yM;var TM={set:function(e){EM=Object.assign({},yM,e)},captureException:function(e,t){return EM.captureException(e,t)},captureMessage:function(e,t){return EM.captureMessage(e,t)},captureBreadcrumb:function(e,t,r="backbone",n="info"){return EM.captureBreadcrumb(e,t,r,n)}};function bM(e={hidePrivateMethods:!0}){const t={},r={},n={parseMessage:mM,buildMessage:vM,logError:gM};let i,s,a={};const o={get methods(){return t},extendMethods(...e){sb(t,...e)},get listeners(){return a},set listeners(e){a=e},emit(e,...t){if(function(...e){if(r){let t,n;if(r.global&&r.global.length)for(t=0;t<r.global.length;t++)if(n=r.global[t],!n.apply(n,e))return!1;let i=e[0];if(r.event&&r.event[i]&&r.event[i].length)for(t=0;t<r.event[i].length;t++)if(n=r.event[i][t],!n.apply(n,e))return!1}return!0}(e,...t)){const r=function(e,...t){const r={event:e};return t&&void 0!==t[0]&&(r.data=t[0]),r}(e,...t);u(r)}},emitMethodEvent(e,t){u({method:e,value:t})},filter(e,t){t||"function"!=typeof e||(t=e,e=null),e?function(e,t){r.event=r.event||{},r.event[e]=r.event[e]||[],r.event[e].push(t)}(e,t):function(e){r.global=r.global||[],r.global.push(e)}(t)},hooks:(...e)=>sb(n,...e),configureClient(e,t){i=e,s=t},tearDown(){window.removeEventListener("message",c)}};function c(r){if(i!==r.source)return;let s=n.parseMessage(r.data),{method:a,value:o,id:c}=s;if(!(void 0===a||"string"!=typeof a||e.hidePrivateMethods&&a.indexOf("_")>-1))try{let e,i=function(e,t){if(!e)return null;let r=Object.getOwnPropertyDescriptor(t,e);if(r&&"function"==typeof r.value)return r.value;if(r&&"function"==typeof r.get)return r.get;const n=e.substr(0,3),i=e.substr(3,1).toLowerCase()+e.substr(4);return r=Object.getOwnPropertyDescriptor(t,i),"get"===n&&r&&"function"==typeof r.get?r.get:"set"===n&&r&&"function"==typeof r.set?r.set:null}(a,t);if(!i)throw new _M(`“${r}” is not a valid method. Valid methods are: ${function(e){return Object.keys(e).reduce((t,r)=>{if(r.indexOf("_")>-1)return t;const n=Object.getOwnPropertyDescriptor(e,r);return"function"==typeof n.value?(t.push(r),t):("function"==typeof n.get&&t.push("get"+r.charAt(0).toUpperCase()+r.slice(1)),"function"==typeof n.set&&t.push("set"+r.charAt(0).toUpperCase()+r.slice(1)),t)},[]).sort()}(t).join(", ")}.`,"TypeError",a);TM.captureBreadcrumb("API message received",s,"api"),e=Array.isArray(o)?o:null==o?[]:[o],Promise.resolve(i.call(r,...e,c)).then(e=>{u({method:a,value:null==e?o:e})}).catch(n.logError)}catch(e){n.logError(e)}}function u(e){if(s&&function(e=window.parent){return!(!window.postMessage||!e.postMessage)}(i)){e=n.buildMessage(e);try{i.postMessage(e,s)}catch(e){}}}return window.addEventListener("message",c,!1),o}var SM=self!==top,AM=function(){var e=document.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},r={};for(var n in t)for(var i=0,s=t[n].length;i<s;i++)if(t[n][i]in e||t[n][i]in document||"on"+t[n][i].toLowerCase()in document){r[n]=t[n][i];break}return r}(),wM={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},IM=[],RM={};function PM(){var e=Array.prototype.slice.apply(arguments),t=e.shift();RM[t].forEach(function(t){"function"==typeof t&&t.apply(t,e)})}function kM(e){return function(t,r){-1!==IM.indexOf(t)&&e.call(this,t,r)}}function DM(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var r=e.getElementsByTagName("video");r[0]&&(t=r[0])}return t}Object.keys(wM).forEach(function(e){IM.push(wM[e]),RM[wM[e]]=[]});var OM=null,LM=function(){},CM=[];function MM(e){var t=DM(e);if(t&&t.webkitEnterFullscreen){try{t.readyState<t.HAVE_CURRENT_DATA?t.addEventListener("loadeddata",function r(){t.removeEventListener("loadeddata",r,!1);try{t.webkitEnterFullscreen()}catch(t){return UM("cannot_enter_fullscreen",e)}},!1):t.webkitEnterFullscreen(),OM=t}catch(t){return UM("not_supported",e)}return!0}return UM(void 0===AM.request?"not_supported":"not_enabled",e)}var NM=function(e){var t=CM[CM.length-1];t&&(e!==t.element&&e!==OM||!t.hasEntered)&&("VIDEO"===e.tagName&&(OM=e),1===CM.length&&FM.onenter(FM.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0,PM(wM.ENTER,FM.element))},xM=function(){OM=null;var e=CM.pop();e&&(e.exit.call(e.element),PM(wM.EXIT,e.element),FM.element||(CM.forEach(function(e){e.exit.call(e.element),PM(wM.EXIT,e.element)}),CM=[],FM.onexit()))},UM=function(e,t){if(CM.length>0){var r=CM.pop();t=t||r.element,r.error.call(t,e),FM.onerror(t,e),PM(wM.ERROR,t,e)}},FM={request:function(e,t,r,n){if(e=e||document.body,CM.push({element:e,enter:t||LM,exit:r||LM,error:n||LM}),void 0===AM.request)return MM(e);if(SM&&!1===document[AM.enabled])return MM(e);try{e[AM.request]()}catch(t){UM("not_enabled",e)}},exit:function(){!document[AM.exit]&&FM.element?FM.element[AM.exit]():document[AM.exit]()},toggle:function(e,t,r,n){FM.element?FM.exit():FM.request(e,t,r,n)},videoEnabled:function(e){if(FM.enabled)return!0;var t=DM(e=e||document.body);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},on:kM(function(e,t){RM[e].push(t)}),off:kM(function(e,t){var r=RM[e].indexOf(t);r>-1&&RM[e].splice(r,1)}),onenter:LM,onexit:LM,onchange:LM,onerror:LM};try{Object.defineProperties(FM,{element:{enumerable:!0,get:function(){return OM&&OM.webkitDisplayingFullscreen?OM:document[AM.element]||null}},enabled:{enumerable:!0,get:function(){return document[AM.enabled]||!1}}})}catch(e){FM.element=null,FM.enabled=!1}function VM(){return window.parent!=window}AM.change&&document.addEventListener(AM.change,function(e){if(FM.onchange(FM.element),PM(wM.CHANGE,FM.element),FM.element){var t=CM[CM.length-2];t&&t.element===FM.element?xM():NM(FM.element)}else xM()},!1),document.addEventListener("webkitbeginfullscreen",function(e){var t=!0;if(CM.length>0)for(var r=0,n=CM.length;r<n;r++)if(DM(CM[r].element)===e.srcElement){t=!1;break}t&&CM.push({element:e.srcElement,enter:LM,exit:LM,error:LM}),FM.onchange(e.srcElement),PM(wM.CHANGE,FM.srcElement),NM(e.srcElement)},!0),document.addEventListener("webkitendfullscreen",function(e){FM.onchange(e.srcElement),PM(wM.CHANGE,e.srcElement),xM(e.srcElement)},!0),AM.error&&document.addEventListener(AM.error,function(e){UM("not_allowed")},!1);var jM=Object.prototype.hasOwnProperty,BM=aR(function(e,t){if(Cw(t)||Fw(t))uw(t,Vw(t),e);else for(var r in t)jM.call(t,r)&&cw(e,r,t[r])}),HM=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var r=function(){function e(){}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"version",baseName:"version",type:"string"}],e}();t.Tracker=r});let XM;const WM=new Uint8Array(16);function qM(){if(!XM&&(XM="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!XM))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return XM(WM)}var GM=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function KM(e){return"string"==typeof e&&GM.test(e)}const YM=[];for(let e=0;e<256;++e)YM.push((e+256).toString(16).slice(1));function zM(e,t=0){return YM[e[t+0]]+YM[e[t+1]]+YM[e[t+2]]+YM[e[t+3]]+"-"+YM[e[t+4]]+YM[e[t+5]]+"-"+YM[e[t+6]]+YM[e[t+7]]+"-"+YM[e[t+8]]+YM[e[t+9]]+"-"+YM[e[t+10]]+YM[e[t+11]]+YM[e[t+12]]+YM[e[t+13]]+YM[e[t+14]]+YM[e[t+15]]}let $M,JM,QM=0,ZM=0;function eN(e){if(!KM(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}function tN(e,t,r){function n(e,n,i,s){var a;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=eN(n)),16!==(null===(a=n)||void 0===a?void 0:a.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(n),o.set(e,n.length),o=r(o),o[6]=15&o[6]|t,o[8]=63&o[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=o[e];return i}return zM(o)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function rN(e){return 14+(e+64>>>9<<4)+1}function nN(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function iN(e,t,r,n,i,s){return nN(function(e,t){return e<<t|e>>>32-t}(nN(nN(t,e),nN(n,s)),i),r)}function sN(e,t,r,n,i,s,a){return iN(t&r|~t&n,e,t,i,s,a)}function aN(e,t,r,n,i,s,a){return iN(t&n|r&~n,e,t,i,s,a)}function oN(e,t,r,n,i,s,a){return iN(t^r^n,e,t,i,s,a)}function cN(e,t,r,n,i,s,a){return iN(r^(t|~n),e,t,i,s,a)}const uN=tN("v3",48,function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length,n="0123456789abcdef";for(let i=0;i<r;i+=8){const r=e[i>>5]>>>i%32&255,s=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[rN(t)-1]=t;let r=1732584193,n=-271733879,i=-1732584194,s=271733878;for(let t=0;t<e.length;t+=16){const a=r,o=n,c=i,u=s;r=sN(r,n,i,s,e[t],7,-680876936),s=sN(s,r,n,i,e[t+1],12,-389564586),i=sN(i,s,r,n,e[t+2],17,606105819),n=sN(n,i,s,r,e[t+3],22,-1044525330),r=sN(r,n,i,s,e[t+4],7,-176418897),s=sN(s,r,n,i,e[t+5],12,1200080426),i=sN(i,s,r,n,e[t+6],17,-1473231341),n=sN(n,i,s,r,e[t+7],22,-45705983),r=sN(r,n,i,s,e[t+8],7,1770035416),s=sN(s,r,n,i,e[t+9],12,-1958414417),i=sN(i,s,r,n,e[t+10],17,-42063),n=sN(n,i,s,r,e[t+11],22,-1990404162),r=sN(r,n,i,s,e[t+12],7,1804603682),s=sN(s,r,n,i,e[t+13],12,-40341101),i=sN(i,s,r,n,e[t+14],17,-1502002290),n=sN(n,i,s,r,e[t+15],22,1236535329),r=aN(r,n,i,s,e[t+1],5,-165796510),s=aN(s,r,n,i,e[t+6],9,-1069501632),i=aN(i,s,r,n,e[t+11],14,643717713),n=aN(n,i,s,r,e[t],20,-373897302),r=aN(r,n,i,s,e[t+5],5,-701558691),s=aN(s,r,n,i,e[t+10],9,38016083),i=aN(i,s,r,n,e[t+15],14,-660478335),n=aN(n,i,s,r,e[t+4],20,-405537848),r=aN(r,n,i,s,e[t+9],5,568446438),s=aN(s,r,n,i,e[t+14],9,-1019803690),i=aN(i,s,r,n,e[t+3],14,-187363961),n=aN(n,i,s,r,e[t+8],20,1163531501),r=aN(r,n,i,s,e[t+13],5,-1444681467),s=aN(s,r,n,i,e[t+2],9,-51403784),i=aN(i,s,r,n,e[t+7],14,1735328473),n=aN(n,i,s,r,e[t+12],20,-1926607734),r=oN(r,n,i,s,e[t+5],4,-378558),s=oN(s,r,n,i,e[t+8],11,-2022574463),i=oN(i,s,r,n,e[t+11],16,1839030562),n=oN(n,i,s,r,e[t+14],23,-35309556),r=oN(r,n,i,s,e[t+1],4,-1530992060),s=oN(s,r,n,i,e[t+4],11,1272893353),i=oN(i,s,r,n,e[t+7],16,-155497632),n=oN(n,i,s,r,e[t+10],23,-1094730640),r=oN(r,n,i,s,e[t+13],4,681279174),s=oN(s,r,n,i,e[t],11,-358537222),i=oN(i,s,r,n,e[t+3],16,-722521979),n=oN(n,i,s,r,e[t+6],23,76029189),r=oN(r,n,i,s,e[t+9],4,-640364487),s=oN(s,r,n,i,e[t+12],11,-421815835),i=oN(i,s,r,n,e[t+15],16,530742520),n=oN(n,i,s,r,e[t+2],23,-995338651),r=cN(r,n,i,s,e[t],6,-198630844),s=cN(s,r,n,i,e[t+7],10,1126891415),i=cN(i,s,r,n,e[t+14],15,-1416354905),n=cN(n,i,s,r,e[t+5],21,-57434055),r=cN(r,n,i,s,e[t+12],6,1700485571),s=cN(s,r,n,i,e[t+3],10,-1894986606),i=cN(i,s,r,n,e[t+10],15,-1051523),n=cN(n,i,s,r,e[t+1],21,-2054922799),r=cN(r,n,i,s,e[t+8],6,1873313359),s=cN(s,r,n,i,e[t+15],10,-30611744),i=cN(i,s,r,n,e[t+6],15,-1560198380),n=cN(n,i,s,r,e[t+13],21,1309151649),r=cN(r,n,i,s,e[t+4],6,-145523070),s=cN(s,r,n,i,e[t+11],10,-1120210379),i=cN(i,s,r,n,e[t+2],15,718787259),n=cN(n,i,s,r,e[t+9],21,-343485551),r=nN(r,a),n=nN(n,o),i=nN(i,c),s=nN(s,u)}return[r,n,i,s]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(rN(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))});var lN={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function hN(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function dN(e,t){return e<<t|e>>>32-t}const fN=tN("v5",80,function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const n=e.length/4+2,i=Math.ceil(n/16),s=new Array(i);for(let t=0;t<i;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];s[t]=r}s[i-1][14]=8*(e.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=s[e][t];for(let e=16;e<80;++e)n[e]=dN(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let i=r[0],a=r[1],o=r[2],c=r[3],u=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),s=dN(i,5)+hN(r,a,o,c)+u+t[r]+n[e]>>>0;u=c,c=o,o=dN(a,30)>>>0,a=i,i=s}r[0]=r[0]+i>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+o>>>0,r[3]=r[3]+c>>>0,r[4]=r[4]+u>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]});var pN=Object.freeze({__proto__:null,v1:function(e,t,r){let n=t&&r||0;const i=t||new Array(16);let s=(e=e||{}).node||$M,a=void 0!==e.clockseq?e.clockseq:JM;if(null==s||null==a){const t=e.random||(e.rng||qM)();null==s&&(s=$M=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==a&&(a=JM=16383&(t[6]<<8|t[7]))}let o=void 0!==e.msecs?e.msecs:Date.now(),c=void 0!==e.nsecs?e.nsecs:ZM+1;const u=o-QM+(c-ZM)/1e4;if(u<0&&void 0===e.clockseq&&(a=a+1&16383),(u<0||o>QM)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");QM=o,ZM=c,JM=a,o+=122192928e5;const l=(1e4*(268435455&o)+c)%4294967296;i[n++]=l>>>24&255,i[n++]=l>>>16&255,i[n++]=l>>>8&255,i[n++]=255&l;const h=o/4294967296*1e4&268435455;i[n++]=h>>>8&255,i[n++]=255&h,i[n++]=h>>>24&15|16,i[n++]=h>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(let e=0;e<6;++e)i[n+e]=s[e];return t||zM(i)},v3:uN,v4:function(e,t,r){if(lN.randomUUID&&!t&&!e)return lN.randomUUID();const n=(e=e||{}).random||(e.rng||qM)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return zM(n)},v5:fN,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!KM(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)},validate:KM,stringify:function(e,t=0){const r=zM(e,t);if(!KM(r))throw TypeError("Stringified UUID is invalid");return r},parse:eN}),_N=function(e){return e&&e.default||e}(pN),vN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Envelope=void 0;var r=function(){function e(e,t){this.event=e,this.eid=(0,_N.v4)(),this.ts_ms=Date.now(),this.created_at=Date.now(),this._tracker=new HM.Tracker,this._globalBPO=t}return Object.defineProperty(e.prototype,"tracker",{get:function(){return this._tracker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"global",{get:function(){return this._globalBPO},enumerable:!1,configurable:!0}),e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"eid",baseName:"eid",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"created_at",baseName:"created_at",type:"number"},{name:"event",baseName:"event",type:"Event"},{name:"global",baseName:"global",type:"Event"},{name:"tracker",baseName:"tracker",type:"Tracker"}],e}();t.Envelope=r}),mN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var r=function(){function e(e,t,r){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=r}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.Event=r}),gN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventContext=void 0;var r=function(){function e(e,t,r){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=r}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.EventContext=r}),yN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalContext=void 0;t.GlobalContext=function(e,t,r){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=r}}),EN=t(function(t,r){var n=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectSerializer=void 0,i(vN,r),i(mN,r),i(gN,r),i(HM,r),i(yN,r);var s=mN,a=gN,o=HM,c=["string","boolean","double","integer","long","float","number","any"],u={},l={Envelope:vN.Envelope,Event:s.Event,Tracker:o.Tracker,EventContext:a.EventContext},h=function(){function e(){}return e.findCorrectType=function(e,t){if(null==e)return t;if(-1!==c.indexOf(t.toLowerCase()))return t;if("Date"===t)return t;if(u[t])return t;if(!l[t])return t;var r=l[t].discriminator;if(null==r)return t;if(e[r]){var n=e[r];return l[n]?n:t}return t},e.serialize=function(t,r){if(null==t)return t;if(-1!==c.indexOf(r.toLowerCase()))return t;if(0===r.lastIndexOf("Array<",0)){var n=r.replace("Array<","");n=n.substring(0,n.length-1);var i=[];for(var s in t){var a=t[s];i.push(e.serialize(a,n))}return i}if("Date"===r)return t.toISOString();if(u[r])return t;if(!l[r])return t;r=this.findCorrectType(t,r);var o=l[r].getAttributeTypeMap(),h={};for(var s in o){var d=o[s];h[d.baseName]=e.serialize(t[d.name],d.type)}return h},e.deserialize=function(t,r){if(r=e.findCorrectType(t,r),null==t)return t;if(-1!==c.indexOf(r.toLowerCase()))return t;if(0===r.lastIndexOf("Array<",0)){var n=r.replace("Array<","");n=n.substring(0,n.length-1);var i=[];for(var s in t){var a=t[s];i.push(e.deserialize(a,n))}return i}if("Date"===r)return new Date(t);if(u[r])return t;if(!l[r])return t;var o=new l[r],h=l[r].getAttributeTypeMap();for(var s in h){var d=h[s];o[d.name]=e.deserialize(t[d.baseName],d.type)}return o},e}();r.ObjectSerializer=h}),TN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatRequestEvent=t.parseJwt=t.getCookie=void 0,t.getCookie=function(e){if("undefined"==typeof document)return null;var t=document.cookie.match(new RegExp("(;\\s)?".concat(e,"=")));if(!t||0==t.length||void 0===t.index)return null;var r=document.cookie.indexOf(";",t.index+1),n=t.index+t[0].length,i=-1===r?document.cookie.substr(n):document.cookie.substring(n,r);return decodeURIComponent(i)},t.parseJwt=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)},t.formatRequestEvent=function(e){var t=e.split(".");if(t.length<=2)return e;var r=t.pop();return"".concat(t.join("_"),".").concat(r)}}),bN=t(function(t,r){var n,i=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(a,o)}c((n=n.apply(e,t||[])).next())})},s=e&&e.__generator||function(e,t){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},a=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a};Object.defineProperty(r,"__esModule",{value:!0}),r.BigPictureClient=r.Configuration=r.Service=void 0,function(e){e.FRESNEL_PROD="https://fresnel-events.vimeocdn.com",e.FRESNEL_PROD_CN="https://fresnel-events.videoji.cn",e.FRESNEL_DEV="https://fresnel-event-staging.vimeows.com",e.EVENTS_PROD="https://lensflare.vimeo.com"}(n=r.Service||(r.Service={}));var c=function(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=""),this.service=e,this.globalBPO=t,this.contexts=r,this.endpoint=n};r.Configuration=c;var u=function(){function e(){}return Object.defineProperty(e,"isInitalized",{get:function(){return Boolean(e.conf.globalBPO)},enumerable:!1,configurable:!0}),e.configure=function(t){e.conf=t,e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE.map(function(t){var r=t.event,n=t.contexts;n?e.sendEventWithContexts(r,n):e.sendEvent(r)}),e.WAIT_QUEUE=[])},e.updateObject=function(t,r){return i(this,void 0,void 0,function(){var n,i,c,u,l,h,d;return s(this,function(s){try{for(n=a(Object.entries(t)),i=n.next();!i.done;i=n.next())if(c=o(i.value,2),u=c[0],l=c[1],u in r){if(l instanceof Object)return r[u]instanceof Object?(e.updateObject(l,r[u]),[2]):(r[u]=l,[2]);r[u]=l}}catch(e){h={error:e}}finally{try{i&&!i.done&&(d=n.return)&&d.call(n)}finally{if(h)throw h.error}}return[2]})})},e.updateContext=function(t){return i(this,void 0,void 0,function(){return s(this,function(r){return"global"==t.context&&e.conf.globalBPO&&e.updateObject(t.fields,e.conf.globalBPO.fields),[2]})})},e.sendEvent=function(t,r){return i(this,void 0,void 0,function(){var n,i,a,o,c,u;return s(this,function(s){switch(s.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");return e.isInitalized?(n=JSON.stringify(EN.ObjectSerializer.serialize([new vN.Envelope(t,this.conf.globalBPO)],"Array<Envelope>")),i=(0,TN.formatRequestEvent)(t.name),a=""!==this.conf.endpoint?this.conf.endpoint:this.conf.service,o="".concat(a,"/add/").concat(encodeURIComponent(i)),navigator.sendBeacon&&!r?[3,2]:(c={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:n},r&&(c.headers.Authorization=r),[4,fetch(o,c)])):(e.WAIT_QUEUE.push({event:t}),e.waitAndFlushQueue(),[2]);case 1:return s.sent(),[3,3];case 2:u=new Blob([n]),navigator.sendBeacon(o,u),s.label=3;case 3:return[2]}})})},e.sendEventWithContexts=function(t,r,n){return i(this,void 0,void 0,function(){var i,c,u,l,h,d,f,p,_,v,m,g,y,E,T,b;return s(this,function(s){switch(s.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");if(!e.isInitalized)return e.WAIT_QUEUE.push({event:t,contexts:r}),e.waitAndFlushQueue(),[2];i=new vN.Envelope(t,this.conf.globalBPO),(c=EN.ObjectSerializer.serialize([i],"Array<Envelope>"))[0].contexts={};try{for(u=a(Object.entries(r)),l=u.next();!l.done;l=u.next())h=o(l.value,2),d=h[0],f=h[1],p=EN.ObjectSerializer.serialize(f,"EventContext"),c[0].contexts[d]=p}catch(e){T={error:e}}finally{try{l&&!l.done&&(b=u.return)&&b.call(u)}finally{if(T)throw T.error}}return _=JSON.stringify(c),v=(0,TN.formatRequestEvent)(t.name),m=""!==this.conf.endpoint?this.conf.endpoint:this.conf.service,g="".concat(m,"/add/").concat(encodeURIComponent(v)),navigator.sendBeacon&&!n?[3,2]:(y={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:_},n&&(y.headers.Authorization=n),[4,fetch(g,y)]);case 1:return s.sent(),[3,3];case 2:E=new Blob([_]),navigator.sendBeacon(g,E),s.label=3;case 3:return[2]}})})},e.waitAndFlushQueue=function(){e.flushQueueTimeoutHandler||(e.flushQueueTimeoutHandler=setTimeout(function(){e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE=[])},e.FLUSH_QUEUE_TIMEOUT))},e.FLUSH_QUEUE_TIMEOUT=1e4,e.conf=new c(n.FRESNEL_PROD),e.WAIT_QUEUE=[],e}();r.BigPictureClient=u}),SN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),AN=t(function(t,r){var n=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(bN,r),i(EN,r),i(SN,r)});const wN=function(e){return(t,...r)=>(r.forEach(r=>{for(const n in r){const i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,Object.assign(i,e))}}),t)}({enumerable:!0,configurable:!0,writeable:!1}),IN={AD_BUFFERING:"ad-buffering",AD_CAN_PLAY:"ad-can-play",AD_COMPLETE:"ad-complete",AD_CLICK:"ad-click",AD_SKIPPED:"ad-skipped",ALL_ADS_COMPLETED:"all-ads-completed",AD_ERROR:"ad-error",AD_STARTED:"ad-started",ADS_MANAGER_LOADED:"ads-manager-loaded",CONTENT_PAUSE_REQUESTED:"content-pause-requested",CONTENT_RESUME_REQUESTED:"content-resume-requested"};function RN(e,t){const r=new nw;let n,i,s,a,o,c,u=!1,l=1,h=!1;function d(){return Gb.iOS?t.videoPlayer.videoElement:t.videoPlayer}function f(){a=new c.AdsRequest,t.adUrl&&(a.adTagUrl=t.adUrl),a.linearAdSlotWidth=t.width.linear,a.linearAdSlotHeight=t.height.linear,a.nonLinearAdSlotWidth=t.width.nonlinear,a.nonLinearAdSlotHeight=t.height.nonlinear,a.setAdWillAutoPlay(t.autoplay),a.setAdWillPlayMuted(t.muted),i.requestAds(a)}function p(e){const t=new c.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.uiElements=[],t.enablePreloading=!0,s=e.getAdsManager(d(),t);const n=h&&o?0:1;s.setVolume(n),r.fire(IN.ADS_MANAGER_LOADED),s.addEventListener(c.AdErrorEvent.Type.AD_ERROR,P),s.addEventListener(c.AdEvent.Type.CONTENT_PAUSE_REQUESTED,y),s.addEventListener(c.AdEvent.Type.CONTENT_RESUME_REQUESTED,E),s.addEventListener(c.AdEvent.Type.AD_BUFFERING,T),s.addEventListener(c.AdEvent.Type.AD_CAN_PLAY,b),s.addEventListener(c.AdEvent.Type.STARTED,S),s.addEventListener(c.AdEvent.Type.COMPLETE,A),s.addEventListener(c.AdEvent.Type.CLICK,w),s.addEventListener(c.AdEvent.Type.SKIPPED,I),s.addEventListener(c.AdEvent.Type.ALL_ADS_COMPLETED,R)}function _(){t.videoPlayer.pause(),h=!0,o=!1,f()}function v(){t.videoPlayer.volume=0,t.videoPlayer.muted=!0;const e=t.videoPlayer.play();void 0!==e&&e.then(m).catch(g)}function m(){t.videoPlayer.pause(),h=!0,o=!0,f()}function g(){t.videoPlayer.volume=1,t.videoPlayer.muted=!1,h=!1,o=!1,f()}function y(e){r.fire(IN.CONTENT_PAUSE_REQUESTED,e)}function E(e){r.fire(IN.CONTENT_RESUME_REQUESTED,e)}function T(e){r.fire(IN.AD_BUFFERING,e)}function b(e){r.fire(IN.AD_CAN_PLAY,e)}function S(e){r.fire(IN.AD_STARTED,e)}function A(e){r.fire(IN.AD_COMPLETE,e)}function w(e){s.pause(),r.fire(IN.AD_CLICK,e)}function I(e){r.fire(IN.AD_SKIPPED,e)}function R(e){r.fire(IN.ALL_ADS_COMPLETED,e)}function P(e){r.fire(IN.AD_ERROR,e.getError()),s&&s.destroy()}const k={isAutoPlayAllowed:()=>h,start:(e,t)=>(u||(n.initialize(),u=!0),s.init(e,t,c.ViewMode.NORMAL),s.start()),stop:()=>s.stop(),pause:()=>s.pause(),play:()=>s.resume(),skip:()=>s.skip(),resize:(e,t,r)=>r?s.resize(e,t,c.ViewMode.FULLSCREEN):s.resize(e,t,c.ViewMode.NORMAL),destroy(){r.off(),s.destroy(),i.destroy(),n.destroy()},get volume(){return Tb(s.getVolume())},set volume(e){l=Eb(e),s.setVolume(l)},get muted(){return 0===s.getVolume()},set muted(e){e?s.setVolume(0):s.setVolume(l)},get remainingTime(){return s.getRemainingTime()},setContentComplete(){i&&i.contentComplete()},on(e,t){return r.on(e,t),this},off(e,t){return r.off(e,t),this}};return function(e,t,r){if(document.getElementById(e))r&&r();else{const t=document.createElement("script");t.id=e,t.src="https://imasdk.googleapis.com/js/sdkloader/ima3.js",t.onload=()=>{r&&r()},document.getElementsByTagName("body")[0].appendChild(t)}}("vp-ima-sdk",0,function(){c=google.ima,n=new c.AdDisplayContainer(e,d()),i=new c.AdsLoader(n),i.addEventListener(c.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,p,!1),i.addEventListener(c.AdErrorEvent.Type.AD_ERROR,P,!1),function(){const e=t.videoPlayer.play();void 0!==e&&e.then(_).catch(v)}()}),wN(this,k)}function PN(e,t,r,n){if(!qS(e))return e;for(var i=-1,s=(t=SA(t,e)).length,a=s-1,o=e;null!=o&&++i<s;){var c=AA(t[i]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=a){var l=o[c];void 0===(u=n?n(l,c,o):void 0)&&(u=qS(l)?l:Ew(t[i+1])?[]:{})}cw(o,c,u),o=o[c]}return e}function kN(e,t){return null!=e&&t in Object(e)}function DN(e,t){return function(e,t,r){for(var n=-1,i=t.length,s={};++n<i;){var a=t[n],o=wA(e,a);r(0,a)&&PN(s,SA(a,e),o)}return s}(e,t,function(t,r){return function(e,t){return null!=e&&function(e,t,r){for(var n=-1,i=(t=SA(t,e)).length,s=!1;++n<i;){var a=AA(t[n]);if(!(s=null!=e&&r(e,a)))break;e=e[a]}return s||++n!=i?s:!!(i=null==e?0:e.length)&&Tw(i)&&Ew(a,i)&&(kS(e)||pw(e))}(e,t,kN)}(e,r)})}var ON=CS?CS.isConcatSpreadable:void 0;function LN(e){return kS(e)||pw(e)||!!(ON&&e&&e[ON])}function CN(e,t,r,n,i){var s=-1,a=e.length;for(r||(r=LN),i||(i=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?CN(o,t-1,r,n,i):Qw(i,o):n||(i[i.length]=o)}return i}function MN(e){return null!=e&&e.length?CN(e,1):[]}var NN,xN,UN,FN,VN,jN,BN,HN,XN,WN,qN,GN=function(e){return KI(XI(e,void 0,MN),e+"")}(function(e,t){return null==e?{}:DN(e,t)}),KN=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},YN=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var r=new PerformanceObserver(function(e){return e.getEntries().map(t)});return r.observe({type:e,buffered:!0}),r}}catch(e){}},zN=function(e,t){var r=function r(n){"pagehide"!==n.type&&"hidden"!==document.visibilityState||(e(n),t&&(removeEventListener("visibilitychange",r,!0),removeEventListener("pagehide",r,!0)))};addEventListener("visibilitychange",r,!0),addEventListener("pagehide",r,!0)},$N=function(e){addEventListener("pageshow",function(t){t.persisted&&e(t)},!0)},JN=function(e,t,r){var n;return function(i){t.value>=0&&(i||r)&&(t.delta=t.value-(n||0),(t.delta||void 0===n)&&(n=t.value,e(t)))}},QN=-1,ZN=function(){return"hidden"===document.visibilityState?0:1/0},ex=function(){zN(function(e){var t=e.timeStamp;QN=t},!0)},tx=function(){return QN<0&&(QN=ZN(),ex(),$N(function(){setTimeout(function(){QN=ZN(),ex()},0)})),{get firstHiddenTime(){return QN}}},rx=function(e,t){var r,n=tx(),i=KN("FCP"),s=function(e){"first-contentful-paint"===e.name&&(o&&o.disconnect(),e.startTime<n.firstHiddenTime&&(i.value=e.startTime,i.entries.push(e),r(!0)))},a=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],o=a?null:YN("paint",s);(a||o)&&(r=JN(e,i,t),a&&s(a),$N(function(n){i=KN("FCP"),r=JN(e,i,t),requestAnimationFrame(function(){requestAnimationFrame(function(){i.value=performance.now()-n.timeStamp,r(!0)})})}))},nx=!1,ix=-1,sx=function(e,t){nx||(rx(function(e){ix=e.value}),nx=!0);var r,n=function(t){ix>-1&&e(t)},i=KN("CLS",0),s=0,a=[],o=function(e){if(!e.hadRecentInput){var t=a[0],n=a[a.length-1];s&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(s+=e.value,a.push(e)):(s=e.value,a=[e]),s>i.value&&(i.value=s,i.entries=a,r())}},c=YN("layout-shift",o);c&&(r=JN(n,i,t),zN(function(){c.takeRecords().map(o),r(!0)}),$N(function(){s=0,ix=-1,i=KN("CLS",0),r=JN(n,i,t)}))},ax={passive:!0,capture:!0},ox=new Date,cx=function(e,t){NN||(NN=t,xN=e,UN=new Date,hx(removeEventListener),ux())},ux=function(){if(xN>=0&&xN<UN-ox){var e={entryType:"first-input",name:NN.type,target:NN.target,cancelable:NN.cancelable,startTime:NN.timeStamp,processingStart:NN.timeStamp+xN};FN.forEach(function(t){t(e)}),FN=[]}},lx=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var r=function(){cx(e,t),i()},n=function(){i()},i=function(){removeEventListener("pointerup",r,ax),removeEventListener("pointercancel",n,ax)};addEventListener("pointerup",r,ax),addEventListener("pointercancel",n,ax)}(t,e):cx(t,e)}},hx=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach(function(t){return e(t,lx,ax)})},dx=function(e,t){var r,n=tx(),i=KN("FID"),s=function(e){e.startTime<n.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),r(!0))},a=YN("first-input",s);r=JN(e,i,t),a&&zN(function(){a.takeRecords().map(s),a.disconnect()},!0),a&&$N(function(){var n;i=KN("FID"),r=JN(e,i,t),FN=[],xN=-1,NN=null,hx(addEventListener),n=s,FN.push(n),ux()})},fx={},px=function(e,t){var r,n=tx(),i=KN("LCP"),s=function(e){var t=e.startTime;t<n.firstHiddenTime&&(i.value=t,i.entries.push(e),r())},a=YN("largest-contentful-paint",s);if(a){r=JN(e,i,t);var o=function(){fx[i.id]||(a.takeRecords().map(s),a.disconnect(),fx[i.id]=!0,r(!0))};["keydown","click"].forEach(function(e){addEventListener(e,o,{once:!0,capture:!0})}),zN(o,!0),$N(function(n){i=KN("LCP"),r=JN(e,i,t),requestAnimationFrame(function(){requestAnimationFrame(function(){i.value=performance.now()-n.timeStamp,fx[i.id]=!0,r(!0)})})})}},_x={},vx=[],mx=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function gx(e,t){for(var r in t)e[r]=t[r];return e}function yx(e){var t=e.parentNode;t&&t.removeChild(e)}function Ex(e,t,r){var n,i,s,a={};for(s in t)"key"==s?n=t[s]:"ref"==s?i=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?VN.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return Tx(e,a,n,i,null)}function Tx(e,t,r,n,i){var s={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++BN:i};return null==i&&null!=jN.vnode&&jN.vnode(s),s}function bx(e){return e.children}function Sx(e,t){this.props=e,this.context=t}function Ax(e,t){if(null==t)return e.__?Ax(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?Ax(e):null}function wx(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return wx(e)}}function Ix(e){(!e.__d&&(e.__d=!0)&&HN.push(e)&&!Rx.__r++||WN!==jN.debounceRendering)&&((WN=jN.debounceRendering)||XN)(Rx)}function Rx(){for(var e;Rx.__r=HN.length;)e=HN.sort(function(e,t){return e.__v.__b-t.__v.__b}),HN=[],e.some(function(e){var t,r,n,i,s,a;e.__d&&(s=(i=(t=e).__v).__e,(a=t.__P)&&(r=[],(n=gx({},i)).__v=i.__v+1,xx(a,i,n,t.__n,void 0!==a.ownerSVGElement,null!=i.__h?[s]:null,r,null==s?Ax(i):s,i.__h),Ux(r,i),i.__e!=s&&wx(i)))})}function Px(e,t,r,n,i,s,a,o,c,u){var l,h,d,f,p,_,v,m=n&&n.__k||vx,g=m.length;for(r.__k=[],l=0;l<t.length;l++)if(null!=(f=r.__k[l]=null==(f=t[l])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?Tx(null,f,null,null,f):Array.isArray(f)?Tx(bx,{children:f},null,null,null):f.__b>0?Tx(f.type,f.props,f.key,null,f.__v):f)){if(f.__=r,f.__b=r.__b+1,null===(d=m[l])||d&&f.key==d.key&&f.type===d.type)m[l]=void 0;else for(h=0;h<g;h++){if((d=m[h])&&f.key==d.key&&f.type===d.type){m[h]=void 0;break}d=null}xx(e,f,d=d||_x,i,s,a,o,c,u),p=f.__e,(h=f.ref)&&d.ref!=h&&(v||(v=[]),d.ref&&v.push(d.ref,null,f),v.push(h,f.__c||p,f)),null!=p?(null==_&&(_=p),"function"==typeof f.type&&f.__k===d.__k?f.__d=c=kx(f,c,e):c=Ox(e,f,d,m,p,c),"function"==typeof r.type&&(r.__d=c)):c&&d.__e==c&&c.parentNode!=e&&(c=Ax(d))}for(r.__e=_,l=g;l--;)null!=m[l]&&("function"==typeof r.type&&null!=m[l].__e&&m[l].__e==r.__d&&(r.__d=Ax(n,l+1)),jx(m[l],m[l]));if(v)for(l=0;l<v.length;l++)Vx(v[l],v[++l],v[++l])}function kx(e,t,r){for(var n,i=e.__k,s=0;i&&s<i.length;s++)(n=i[s])&&(n.__=e,t="function"==typeof n.type?kx(n,t,r):Ox(r,n,n,i,n.__e,t));return t}function Dx(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some(function(e){Dx(e,t)}):t.push(e)),t}function Ox(e,t,r,n,i,s){var a,o,c;if(void 0!==t.__d)a=t.__d,t.__d=void 0;else if(null==r||i!=s||null==i.parentNode)e:if(null==s||s.parentNode!==e)e.appendChild(i),a=null;else{for(o=s,c=0;(o=o.nextSibling)&&c<n.length;c+=2)if(o==i)break e;e.insertBefore(i,s),a=s}return void 0!==a?a:i.nextSibling}function Lx(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]=null==r?"":"number"!=typeof r||mx.test(t)?r:r+"px"}function Cx(e,t,r,n,i){var s;e:if("style"===t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||Lx(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||Lx(e.style,t,r[t])}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=r,r?n||e.addEventListener(t,s?Nx:Mx,s):e.removeEventListener(t,s?Nx:Mx,s);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null!=r&&(!1!==r||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,r):e.removeAttribute(t))}}function Mx(e){this.l[e.type+!1](jN.event?jN.event(e):e)}function Nx(e){this.l[e.type+!0](jN.event?jN.event(e):e)}function xx(e,t,r,n,i,s,a,o,c){var u,l,h,d,f,p,_,v,m,g,y,E=t.type;if(void 0!==t.constructor)return null;null!=r.__h&&(c=r.__h,o=t.__e=r.__e,t.__h=null,s=[o]),(u=jN.__b)&&u(t);try{e:if("function"==typeof E){if(v=t.props,m=(u=E.contextType)&&n[u.__c],g=u?m?m.props.value:u.__:n,r.__c?_=(l=t.__c=r.__c).__=l.__E:("prototype"in E&&E.prototype.render?t.__c=l=new E(v,g):(t.__c=l=new Sx(v,g),l.constructor=E,l.render=Bx),m&&m.sub(l),l.props=v,l.state||(l.state={}),l.context=g,l.__n=n,h=l.__d=!0,l.__h=[]),null==l.__s&&(l.__s=l.state),null!=E.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=gx({},l.__s)),gx(l.__s,E.getDerivedStateFromProps(v,l.__s))),d=l.props,f=l.state,h)null==E.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(null==E.getDerivedStateFromProps&&v!==d&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(v,g),!l.__e&&null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(v,l.__s,g)||t.__v===r.__v){l.props=v,l.state=l.__s,t.__v!==r.__v&&(l.__d=!1),l.__v=t,t.__e=r.__e,t.__k=r.__k,t.__k.forEach(function(e){e&&(e.__=t)}),l.__h.length&&a.push(l);break e}null!=l.componentWillUpdate&&l.componentWillUpdate(v,l.__s,g),null!=l.componentDidUpdate&&l.__h.push(function(){l.componentDidUpdate(d,f,p)})}l.context=g,l.props=v,l.state=l.__s,(u=jN.__r)&&u(t),l.__d=!1,l.__v=t,l.__P=e,u=l.render(l.props,l.state,l.context),l.state=l.__s,null!=l.getChildContext&&(n=gx(gx({},n),l.getChildContext())),h||null==l.getSnapshotBeforeUpdate||(p=l.getSnapshotBeforeUpdate(d,f)),y=null!=u&&u.type===bx&&null==u.key?u.props.children:u,Px(e,Array.isArray(y)?y:[y],t,r,n,i,s,a,o,c),l.base=t.__e,t.__h=null,l.__h.length&&a.push(l),_&&(l.__E=l.__=null),l.__e=!1}else null==s&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=Fx(r.__e,t,r,n,i,s,a,c);(u=jN.diffed)&&u(t)}catch(e){t.__v=null,(c||null!=s)&&(t.__e=o,t.__h=!!c,s[s.indexOf(o)]=null),jN.__e(e,t,r)}}function Ux(e,t){jN.__c&&jN.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){jN.__e(e,t.__v)}})}function Fx(e,t,r,n,i,s,a,o){var c,u,l,h=r.props,d=t.props,f=t.type,p=0;if("svg"===f&&(i=!0),null!=s)for(;p<s.length;p++)if((c=s[p])&&"setAttribute"in c==!!f&&(f?c.localName===f:3===c.nodeType)){e=c,s[p]=null;break}if(null==e){if(null===f)return document.createTextNode(d);e=i?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,d.is&&d),s=null,o=!1}if(null===f)h===d||o&&e.data===d||(e.data=d);else{if(s=s&&VN.call(e.childNodes),u=(h=r.props||_x).dangerouslySetInnerHTML,l=d.dangerouslySetInnerHTML,!o){if(null!=s)for(h={},p=0;p<e.attributes.length;p++)h[e.attributes[p].name]=e.attributes[p].value;(l||u)&&(l&&(u&&l.__html==u.__html||l.__html===e.innerHTML)||(e.innerHTML=l&&l.__html||""))}if(function(e,t,r,n,i){var s;for(s in r)"children"===s||"key"===s||s in t||Cx(e,s,null,r[s],n);for(s in t)i&&"function"!=typeof t[s]||"children"===s||"key"===s||"value"===s||"checked"===s||r[s]===t[s]||Cx(e,s,t[s],r[s],n)}(e,d,h,i,o),l)t.__k=[];else if(p=t.props.children,Px(e,Array.isArray(p)?p:[p],t,r,n,i&&"foreignObject"!==f,s,a,s?s[0]:r.__k&&Ax(r,0),o),null!=s)for(p=s.length;p--;)null!=s[p]&&yx(s[p]);o||("value"in d&&void 0!==(p=d.value)&&(p!==e.value||"progress"===f&&!p||"option"===f&&p!==h.value)&&Cx(e,"value",p,h.value,!1),"checked"in d&&void 0!==(p=d.checked)&&p!==e.checked&&Cx(e,"checked",p,h.checked,!1))}return e}function Vx(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){jN.__e(e,r)}}function jx(e,t,r){var n,i;if(jN.unmount&&jN.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||Vx(n,null,t)),null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){jN.__e(e,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&jx(n[i],t,"function"!=typeof e.type);r||null==e.__e||yx(e.__e),e.__e=e.__d=void 0}function Bx(e,t,r){return this.constructor(e,r)}function Hx(e,t,r){var n,i,s;jN.__&&jN.__(e,t),i=(n="function"==typeof r)?null:r&&r.__k||t.__k,s=[],xx(t,e=(!n&&r||t).__k=Ex(bx,null,[e]),i||_x,_x,void 0!==t.ownerSVGElement,!n&&r?[r]:i?null:t.firstChild?VN.call(t.childNodes):null,s,!n&&r?r:i?i.__e:t.firstChild,n),Ux(s,e)}function Xx(e,t){Hx(e,t,Xx)}function Wx(e,t,r){var n,i,s,a=gx({},e.props);for(s in t)"key"==s?n=t[s]:"ref"==s?i=t[s]:a[s]=t[s];return arguments.length>2&&(a.children=arguments.length>3?VN.call(arguments,2):r),Tx(e.type,a,n||e.key,i||e.ref,null)}function qx(e,t){var r={__c:t="__cC"+qN++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var r,n;return this.getChildContext||(r=[],(n={})[t]=this,this.getChildContext=function(){return n},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&r.some(Ix)},this.sub=function(e){r.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){r.splice(r.indexOf(e),1),t&&t.call(e)}}),e.children}};return r.Provider.__=r.Consumer.contextType=r}VN=vx.slice,jN={__e:function(e,t){for(var r,n,i;t=t.__;)if((r=t.__c)&&!r.__)try{if((n=r.constructor)&&null!=n.getDerivedStateFromError&&(r.setState(n.getDerivedStateFromError(e)),i=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e),i=r.__d),i)return r.__E=r}catch(t){e=t}throw e}},BN=0,Sx.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=gx({},this.state),"function"==typeof e&&(e=e(gx({},r),this.props)),e&&gx(r,e),null!=e&&this.__v&&(t&&this.__h.push(t),Ix(this))},Sx.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Ix(this))},Sx.prototype.render=bx,HN=[],XN="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Rx.__r=0,qN=0;var Gx,Kx,Yx,zx=0,$x=[],Jx=jN.__b,Qx=jN.__r,Zx=jN.diffed,eU=jN.__c,tU=jN.unmount;function rU(e,t){jN.__h&&jN.__h(Kx,e,zx||t),zx=0;var r=Kx.__H||(Kx.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function nU(e){return zx=1,iU(gU,e)}function iU(e,t,r){var n=rU(Gx++,2);return n.t=e,n.__c||(n.__=[r?r(t):gU(void 0,t),function(e){var t=n.t(n.__[0],e);n.__[0]!==t&&(n.__=[t,n.__[1]],n.__c.setState({}))}],n.__c=Kx),n.__}function sU(e,t){var r=rU(Gx++,3);!jN.__s&&mU(r.__H,t)&&(r.__=e,r.__H=t,Kx.__H.__h.push(r))}function aU(e,t){var r=rU(Gx++,4);!jN.__s&&mU(r.__H,t)&&(r.__=e,r.__H=t,Kx.__h.push(r))}function oU(e){return zx=5,cU(function(){return{current:e}},[])}function cU(e,t){var r=rU(Gx++,7);return mU(r.__H,t)&&(r.__=e(),r.__H=t,r.__h=e),r.__}function uU(e,t){return zx=8,cU(function(){return e},t)}function lU(e){var t=Kx.context[e.__c],r=rU(Gx++,9);return r.c=e,t?(null==r.__&&(r.__=!0,t.sub(Kx)),t.props.value):e.__}function hU(e,t){jN.useDebugValue&&jN.useDebugValue(t?t(e):e)}function dU(e){var t=rU(Gx++,10),r=nU();return t.__=e,Kx.componentDidCatch||(Kx.componentDidCatch=function(e){t.__&&t.__(e),r[1](e)}),[r[0],function(){r[1](void 0)}]}function fU(){for(var e;e=$x.shift();)if(e.__P)try{e.__H.__h.forEach(_U),e.__H.__h.forEach(vU),e.__H.__h=[]}catch(t){e.__H.__h=[],jN.__e(t,e.__v)}}jN.__b=function(e){Kx=null,Jx&&Jx(e)},jN.__r=function(e){Qx&&Qx(e),Gx=0;var t=(Kx=e.__c).__H;t&&(t.__h.forEach(_U),t.__h.forEach(vU),t.__h=[])},jN.diffed=function(e){Zx&&Zx(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==$x.push(t)&&Yx===jN.requestAnimationFrame||((Yx=jN.requestAnimationFrame)||function(e){var t,r=function(){clearTimeout(n),pU&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);pU&&(t=requestAnimationFrame(r))})(fU)),Kx=null},jN.__c=function(e,t){t.some(function(e){try{e.__h.forEach(_U),e.__h=e.__h.filter(function(e){return!e.__||vU(e)})}catch(r){t.some(function(e){e.__h&&(e.__h=[])}),t=[],jN.__e(r,e.__v)}}),eU&&eU(e,t)},jN.unmount=function(e){tU&&tU(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(e){try{_U(e)}catch(e){t=e}}),t&&jN.__e(t,r.__v))};var pU="function"==typeof requestAnimationFrame;function _U(e){var t=Kx,r=e.__c;"function"==typeof r&&(e.__c=void 0,r()),Kx=t}function vU(e){var t=Kx;e.__c=e.__(),Kx=t}function mU(e,t){return!e||e.length!==t.length||t.some(function(t,r){return t!==e[r]})}function gU(e,t){return"function"==typeof t?t(e):t}function yU(){return yU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yU.apply(this,arguments)}function EU(e,t){return EU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},EU(e,t)}var TU,bU,SU,AU=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,EU(t,r);var i=n.prototype;return i.componentDidMount=function(){this.props.nodeRef.current=this.base},i.componentWillUnmount=function(){this.props.nodeRef.current=void 0},i.render=function(){return Ex(bx,{},this.props.children)},n}(Sx);!function(e){e.APPEAR="appear",e.APPEAR_ACTIVE="appearActive",e.APPEAR_DONE="appearDone",e.ENTER="enter",e.ENTER_ACTIVE="enterActive",e.ENTER_DONE="enterDone",e.EXIT="exit",e.EXIT_ACTIVE="exitActive",e.EXIT_DONE="exitDone"}(bU||(bU={})),function(e){e.ENTER="onEnter",e.ENTERING="onEntering",e.ENTERED="onEntered",e.EXIT="onExit",e.EXITING="onExiting",e.EXITED="onExited"}(SU||(SU={}));var wU=((TU={})[bU.APPEAR]=[SU.ENTER,bU.APPEAR_ACTIVE],TU[bU.APPEAR_ACTIVE]=[SU.ENTERING,bU.APPEAR_DONE,!0],TU[bU.APPEAR_DONE]=[SU.ENTERED],TU[bU.ENTER]=[SU.ENTER,bU.ENTER_ACTIVE],TU[bU.ENTER_ACTIVE]=[SU.ENTERING,bU.ENTER_DONE,!0],TU[bU.ENTER_DONE]=[SU.ENTERED],TU[bU.EXIT]=[SU.EXIT,bU.EXIT_ACTIVE],TU[bU.EXIT_ACTIVE]=[SU.EXITING,bU.EXIT_DONE,!0],TU[bU.EXIT_DONE]=[SU.EXITED],TU);function IU(e){var t=e.children,r=e.in,n=void 0!==r&&r,i=e.appear,s=void 0!==i&&i,a=e.enter,o=void 0===a||a,c=e.exit,u=void 0===c||c,l=e.duration,h=void 0===l?500:l,d=e.alwaysMounted,f=void 0!==d&&d,p=e.addEndListener,_=oU(),v=oU(),m=!1,g=nU(function(){return m=!0,n?s?bU.APPEAR:bU.APPEAR_DONE:bU.EXIT_DONE}),y=g[0],E=g[1];sU(function(){var t=window,r=t.setTimeout,n=t.clearTimeout,i=wU[y],s=i[1],a=i[2],o=e[i[0]];return null==o||o(_.current),s&&(a?p?p(_.current,function(){return E(s)}):v.current=r(E,h,s):E(s)),function(){n(v.current)}},[y,h]),aU(function(){m||E(n?o?bU.ENTER:bU.ENTER_DONE:u?bU.EXIT:bU.EXIT_DONE)},[n]);var T=cU(function(){var e={};return Object.keys(wU).forEach(function(t){e[t]=y===t}),e},[y]);return f||(u?y!==bU.EXIT_DONE:n)?Ex(AU,{nodeRef:_,children:t(T,y)}):null}var RU,PU=["children","styles"];function kU(e){var t=e.children,r=e.styles,n=function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)t.indexOf(r=s[n])>=0||(i[r]=e[r]);return i}(e,PU);return Ex(IU,n,function(e,n){var i=t.props.style,s=cU(function(){return yU({},function(e,t){var r=t[e];switch(e){case bU.APPEAR_ACTIVE:return yU({},t[bU.APPEAR],r);case bU.ENTER_ACTIVE:return yU({},t[bU.ENTER],r);case bU.EXIT_ACTIVE:return yU({},t[bU.EXIT],r);default:return r}}(n,r),i)},[i,r,n]);return Wx(t,{style:s})})}function DU(e,t){for(var r in t)e[r]=t[r];return e}function OU(e,t){for(var r in e)if("__source"!==r&&!(r in t))return!0;for(var n in t)if("__source"!==n&&e[n]!==t[n])return!0;return!1}function LU(e){this.props=e}(RU={})[bU.APPEAR]="-appear",RU[bU.APPEAR_ACTIVE]="-appear-active",RU[bU.APPEAR_DONE]="-appear-done",RU[bU.ENTER]="-enter",RU[bU.ENTER_ACTIVE]="-enter-active",RU[bU.ENTER_DONE]="-enter-done",RU[bU.EXIT]="-exit",RU[bU.EXIT_ACTIVE]="-exit-active",RU[bU.EXIT_DONE]="-exit-done",(LU.prototype=new Sx).isPureReactComponent=!0,LU.prototype.shouldComponentUpdate=function(e,t){return OU(this.props,e)||OU(this.state,t)};var CU=jN.__b;jN.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),CU&&CU(e)};var MU="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function NU(e){function t(t,r){var n=DU({},t);return delete n.ref,e(n,(r=t.ref||r)&&("object"!=typeof r||"current"in r)?r:null)}return t.$$typeof=MU,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var xU=function(e,t){return null==e?null:Dx(Dx(e).map(t))},UU={map:xU,forEach:xU,count:function(e){return e?Dx(e).length:0},only:function(e){var t=Dx(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:Dx},FU=jN.__e;jN.__e=function(e,t,r){if(e.then)for(var n,i=t;i=i.__;)if((n=i.__c)&&n.__c)return null==t.__e&&(t.__e=r.__e,t.__k=r.__k),n.__c(e,t);FU(e,t,r)};var VU=jN.unmount;function jU(){this.__u=0,this.t=null,this.__b=null}function BU(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function HU(){this.u=null,this.o=null}jN.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),VU&&VU(e)},(jU.prototype=new Sx).__c=function(e,t){var r=t.__c,n=this;null==n.t&&(n.t=[]),n.t.push(r);var i=BU(n.__v),s=!1,a=function(){s||(s=!0,r.__R=null,i?i(o):o())};r.__R=a;var o=function(){if(! --n.__u){if(n.state.__e){var e=n.state.__e;n.__v.__k[0]=function e(t,r,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(t){return e(t,r,n)}),t.__c&&t.__c.__P===r&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}(e,e.__c.__P,e.__c.__O)}var t;for(n.setState({__e:n.__b=null});t=n.t.pop();)t.forceUpdate()}},c=!0===t.__h;n.__u++||c||n.setState({__e:n.__b=n.__v.__k[0]}),e.then(a,a)},jU.prototype.componentWillUnmount=function(){this.t=[]},jU.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=function e(t,r,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),t.__c.__H=null),null!=(t=DU({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=r),t.__c=null),t.__k=t.__k&&t.__k.map(function(t){return e(t,r,n)})),t}(this.__b,r,n.__O=n.__P)}this.__b=null}var i=t.__e&&Ex(bx,null,e.fallback);return i&&(i.__h=null),[Ex(bx,null,t.__e?null:e.children),i]};var XU=function(e,t,r){if(++r[1]===r[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(r=e.u;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.u=r=r[2]}};function WU(e){return this.getChildContext=function(){return e.context},e.children}function qU(e){var t=this,r=e.i;t.componentWillUnmount=function(){Hx(null,t.l),t.l=null,t.i=null},t.i&&t.i!==r&&t.componentWillUnmount(),e.__v?(t.l||(t.i=r,t.l={nodeType:1,parentNode:r,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,r){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),Hx(Ex(WU,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function GU(e,t){return Ex(qU,{__v:e,i:t})}(HU.prototype=new Sx).__e=function(e){var t=this,r=BU(t.__v),n=t.o.get(e);return n[0]++,function(i){var s=function(){t.props.revealOrder?(n.push(i),XU(t,e,n)):i()};r?r(s):s()}},HU.prototype.render=function(e){this.u=null,this.o=new Map;var t=Dx(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var r=t.length;r--;)this.o.set(t[r],this.u=[1,0,this.u]);return e.children},HU.prototype.componentDidUpdate=HU.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,r){XU(e,r,t)})};var KU="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,YU=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,zU="undefined"!=typeof document,$U=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};Sx.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Sx.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var JU=jN.event;function QU(){}function ZU(){return this.cancelBubble}function eF(){return this.defaultPrevented}jN.event=function(e){return JU&&(e=JU(e)),e.persist=QU,e.isPropagationStopped=ZU,e.isDefaultPrevented=eF,e.nativeEvent=e};var tF,rF={configurable:!0,get:function(){return this.class}},nF=jN.vnode;jN.vnode=function(e){var t=e.type,r=e.props,n=r;if("string"==typeof t){var i=-1===t.indexOf("-");for(var s in n={},r){var a=r[s];zU&&"children"===s&&"noscript"===t||"value"===s&&"defaultValue"in r&&null==a||("defaultValue"===s&&"value"in r&&null==r.value?s="value":"download"===s&&!0===a?a="":/ondoubleclick/i.test(s)?s="ondblclick":/^onchange(textarea|input)/i.test(s+t)&&!$U(r.type)?s="oninput":/^onfocus$/i.test(s)?s="onfocusin":/^onblur$/i.test(s)?s="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(s)?s=s.toLowerCase():i&&YU.test(s)?s=s.replace(/[A-Z0-9]/,"-$&").toLowerCase():null===a&&(a=void 0),n[s]=a)}"select"==t&&n.multiple&&Array.isArray(n.value)&&(n.value=Dx(r.children).forEach(function(e){e.props.selected=-1!=n.value.indexOf(e.props.value)})),"select"==t&&null!=n.defaultValue&&(n.value=Dx(r.children).forEach(function(e){e.props.selected=n.multiple?-1!=n.defaultValue.indexOf(e.props.value):n.defaultValue==e.props.value})),e.props=n,r.class!=r.className&&(rF.enumerable="className"in r,null!=r.className&&(n.class=r.className),Object.defineProperty(n,"className",rF))}e.$$typeof=KU,nF&&nF(e)};var iF=jN.__r;jN.__r=function(e){iF&&iF(e),tF=e.__c};var sF={ReactCurrentDispatcher:{current:{readContext:function(e){return tF.__n[e.__c].props.value}}}};function aF(e){return!!e&&e.$$typeof===KU}var oF={useState:nU,useReducer:iU,useEffect:sU,useLayoutEffect:aU,useRef:oU,useImperativeHandle:function(e,t,r){zx=6,aU(function(){"function"==typeof e?e(t()):e&&(e.current=t())},null==r?r:r.concat(e))},useMemo:cU,useCallback:uU,useContext:lU,useDebugValue:hU,version:"17.0.2",Children:UU,render:function(e,t,r){return null==t.__k&&(t.textContent=""),Hx(e,t),"function"==typeof r&&r(),e?e.__c:null},hydrate:function(e,t,r){return Xx(e,t),"function"==typeof r&&r(),e?e.__c:null},unmountComponentAtNode:function(e){return!!e.__k&&(Hx(null,e),!0)},createPortal:GU,createElement:Ex,createContext:qx,createFactory:function(e){return Ex.bind(null,e)},cloneElement:function(e){return aF(e)?Wx.apply(null,arguments):e},createRef:function(){return{current:null}},Fragment:bx,isValidElement:aF,findDOMNode:function(e){return e&&(e.base||1===e.nodeType&&e)||null},Component:Sx,PureComponent:LU,memo:function(e,t){function r(e){var r=this.props.ref,n=r==e.ref;return!n&&r&&(r.call?r(null):r.current=null),t?!t(this.props,e)||!n:OU(this.props,e)}function n(t){return this.shouldComponentUpdate=r,Ex(e,t)}return n.displayName="Memo("+(e.displayName||e.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n},forwardRef:NU,flushSync:function(e,t){return e(t)},unstable_batchedUpdates:function(e,t){return e(t)},StrictMode:bx,Suspense:jU,SuspenseList:HU,lazy:function(e){var t,r,n;function i(i){if(t||(t=e()).then(function(e){r=e.default||e},function(e){n=e}),n)throw n;if(!r)throw t;return Ex(r,i)}return i.displayName="Lazy",i.__f=!0,i},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:sF};const cF="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?sU:aU;function uF(e){const t="function"==typeof e?function(e){let t;const r=new Set,n=(e,n)=>{const i="function"==typeof e?e(t):e;if(i!==t){const e=t;t=n?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,s={setState:n,getState:i,subscribe:(e,n,s)=>n||s?((e,n=i,s=Object.is)=>{let a=n(t);function o(){const r=n(t);if(!s(a,r)){const t=a;e(a=r,t)}}return r.add(o),()=>r.delete(o)})(e,n,s):(r.add(e),()=>r.delete(e)),destroy:()=>r.clear()};return t=e(n,i,s),s}(e):e,r=(e=t.getState,r=Object.is)=>{const[,n]=iU(e=>e+1,0),i=t.getState(),s=oU(i),a=oU(e),o=oU(r),c=oU(!1),u=oU();let l;void 0===u.current&&(u.current=e(i));let h=!1;(s.current!==i||a.current!==e||o.current!==r||c.current)&&(l=e(i),h=!r(u.current,l)),cF(()=>{h&&(u.current=l),s.current=i,a.current=e,o.current=r,c.current=!1});const d=oU(i);cF(()=>{const e=()=>{try{const e=t.getState(),r=a.current(e);o.current(u.current,r)||(s.current=e,u.current=r,n())}catch(e){c.current=!0,n()}},r=t.subscribe(e);return t.getState()!==d.current&&e(),r},[]);const f=h?l:u.current;return hU(f),f};return Object.assign(r,t),r[Symbol.iterator]=function(){const e=[r,t];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},r}function lF(){const e=qx(void 0);return{Provider:({initialStore:t,createStore:r,children:n})=>{const i=oU();return i.current||(t&&(r||(r=()=>t)),i.current=r()),Ex(e.Provider,{value:i.current},n)},useStore:(t,r=Object.is)=>{const n=lU(e);if(!n)throw new Error("Seems like you have not used zustand provider as an ancestor.");return n(t,r)},useStoreApi:()=>{const t=lU(e);if(!t)throw new Error("Seems like you have not used zustand provider as an ancestor.");return cU(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])}}}const hF=e=>(t,r,n)=>{const i=n.subscribe;return n.subscribe=(e,t,r)=>{let s=e;if(t){const i=(null==r?void 0:r.equalityFn)||Object.is;let a=e(n.getState());s=r=>{const n=e(r);if(!i(a,n)){const e=a;t(a=n,e)}},(null==r?void 0:r.fireImmediately)&&t(a,a)}return i(s)},e(t,r,n)};var dF=0;function fF(e,t,r,n,i){var s,a,o={};for(a in t)"ref"==a?s=t[a]:o[a]=t[a];var c={type:e,props:o,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--dF,__source:n,__self:i};if("function"==typeof e&&(s=e.defaultProps))for(a in s)void 0===o[a]&&(o[a]=s[a]);return jN.vnode&&jN.vnode(c),c}function pF(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new pA;++t<r;)this.add(e[t])}function _F(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function vF(e,t){return e.has(t)}function mF(e,t,r,n,i,s){var a=1&r,o=e.length,c=t.length;if(o!=c&&!(a&&c>o))return!1;var u=s.get(e),l=s.get(t);if(u&&l)return u==t&&l==e;var h=-1,d=!0,f=2&r?new pF:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var p=e[h],_=t[h];if(n)var v=a?n(_,p,h,t,e,s):n(p,_,h,e,t,s);if(void 0!==v){if(v)continue;d=!1;break}if(f){if(!_F(t,function(e,t){if(!vF(f,t)&&(p===e||i(p,e,r,n,s)))return f.push(t)})){d=!1;break}}else if(p!==_&&!i(p,_,r,n,s)){d=!1;break}}return s.delete(e),s.delete(t),d}function gF(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function yF(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}pF.prototype.add=pF.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},pF.prototype.has=function(e){return this.__data__.has(e)};var EF=CS?CS.prototype:void 0,TF=EF?EF.valueOf:void 0,bF=Object.prototype.hasOwnProperty,SF="[object Arguments]",AF="[object Array]",wF="[object Object]",IF=Object.prototype.hasOwnProperty;function RF(e,t,r,n,i){return e===t||(null==e||null==t||!BS(e)&&!BS(t)?e!=e&&t!=t:function(e,t,r,n,i,s){var a=kS(e),o=kS(t),c=a?AF:yI(e),u=o?AF:yI(t),l=(c=c==SF?wF:c)==wF,h=(u=u==SF?wF:u)==wF,d=c==u;if(d&&gw(e)){if(!gw(t))return!1;a=!0,l=!1}if(d&&!l)return s||(s=new iw),a||kw(e)?mF(e,t,r,n,i,s):function(e,t,r,n,i,s,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new TI(e),new TI(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return cA(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=gF;case"[object Set]":var c=1&n;if(o||(o=yF),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;n|=2,a.set(e,t);var l=mF(o(e),o(t),n,i,s,a);return a.delete(e),l;case"[object Symbol]":if(TF)return TF.call(e)==TF.call(t)}return!1}(e,t,c,r,n,i,s);if(!(1&r)){var f=l&&IF.call(e,"__wrapped__"),p=h&&IF.call(t,"__wrapped__");if(f||p){var _=f?e.value():e,v=p?t.value():t;return s||(s=new iw),i(_,v,r,n,s)}}return!!d&&(s||(s=new iw),function(e,t,r,n,i,s){var a=1&r,o=rI(e),c=o.length;if(c!=rI(t).length&&!a)return!1;for(var u=c;u--;){var l=o[u];if(!(a?l in t:bF.call(t,l)))return!1}var h=s.get(e),d=s.get(t);if(h&&d)return h==t&&d==e;var f=!0;s.set(e,t),s.set(t,e);for(var p=a;++u<c;){var _=e[l=o[u]],v=t[l];if(n)var m=a?n(v,_,l,t,e,s):n(_,v,l,e,t,s);if(!(void 0===m?_===v||i(_,v,r,n,s):m)){f=!1;break}p||(p="constructor"==l)}if(f&&!p){var g=e.constructor,y=t.constructor;g==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y||(f=!1)}return s.delete(e),s.delete(t),f}(e,t,r,n,i,s))}(e,t,r,n,RF,i))}function PF(e,t){return RF(e,t)}var kF=[],DF=[];function OF(e,t){if(e&&"undefined"!=typeof document){var r,n=!0===t.prepend?"prepend":"append",i=!0===t.singleTag,s="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var a=kF.indexOf(s);-1===a&&(a=kF.push(s)-1,DF[a]={}),r=DF[a]&&DF[a][n]?DF[a][n]:DF[a][n]=o()}else r=o();65279===e.charCodeAt(0)&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function o(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var r=Object.keys(t.attributes),i=0;i<r.length;i++)e.setAttribute(r[i],t.attributes[r[i]]);var a="prepend"===n?"afterbegin":"beforeend";return s.insertAdjacentElement(a,e),e}}var LF=t(function(e,t){
/*! For license information please see hls-parser.min.js.LICENSE.txt */
self,e.exports=function(){return e={851:(e,t,r)=>{var n=r(771),i=n.getOptions,s=n.setOptions,a=r(463),o=r(367),c=r(890);e.exports={parse:a,stringify:o,types:c,getOptions:i,setOptions:s}},463:(e,t,r)=>{function n(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=r(771),c=r(890),u=c.Rendition,l=c.Variant,h=c.SessionData,d=c.Key,f=c.MediaInitializationSection,p=c.DateRange,_=c.SpliceInfo,v=c.MasterPlaylist,m=c.MediaPlaylist,g=c.Segment,y=c.PartialSegment,E=c.RenditionReport;function T(e){return o.trim(e,'"')}function b(e){var t=o.splitAt(e,",");return{duration:o.toNumber(t[0]),title:decodeURIComponent(escape(t[1]))}}function S(e){var t=o.splitAt(e,"@");return{length:o.toNumber(t[0]),offset:t[1]?o.toNumber(t[1]):-1}}function A(e,t){t.IV&&e.compatibleVersion<2&&(e.compatibleVersion=2),(t.KEYFORMAT||t.KEYFORMATVERSIONS)&&e.compatibleVersion<5&&(e.compatibleVersion=5)}function w(e){var t=o.splitByCommaWithPreservingQuotes(e),r={};return t.forEach(function(e){var t,n,s=i(o.splitAt(e,"="),2),a=s[0],c=s[1],u=T(c);switch(a){case"URI":r[a]=u;break;case"START-DATE":case"END-DATE":r[a]=new Date(u);break;case"IV":r[a]=(t=u,16!==(n=o.hexToByteSequence(t)).length&&o.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),n);break;case"BYTERANGE":r[a]=S(u);break;case"RESOLUTION":r[a]=function(e){var t=o.splitAt(e,"x");return{width:o.toNumber(t[0]),height:o.toNumber(t[1])}}(u);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":r[a]="YES"===u;break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":r[a]=o.toNumber(u);break;default:a.startsWith("SCTE35-")?r[a]=o.hexToByteSequence(u):a.startsWith("X-")?r[a]=function(e){return e.startsWith('"')?T(e):e.startsWith("0x")||e.startsWith("0X")?o.hexToByteSequence(e):o.toNumber(e)}(c):r[a]=u}}),r}function I(){o.INVALIDPLAYLIST("The file contains both media and master playlist tags.")}function R(e,t,r){var i,s=(i=t.attributes,new u({type:i.TYPE,uri:i.URI,groupId:i["GROUP-ID"],language:i.LANGUAGE,assocLanguage:i["ASSOC-LANGUAGE"],name:i.NAME,isDefault:i.DEFAULT,autoselect:i.AUTOSELECT,forced:i.FORCED,instreamId:i["INSTREAM-ID"],characteristics:i.CHARACTERISTICS,channels:i.CHANNELS})),a=e[o.camelify(r)],c=function(e,t){var r,i=!1,s=n(e);try{for(s.s();!(r=s.n()).done;){var a=r.value;if(a.name===t.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";a.isDefault&&(i=!0)}}catch(e){s.e(e)}finally{s.f()}return i&&t.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(a,s);c&&o.INVALIDPLAYLIST(c),a.push(s),s.isDefault&&(e.currentRenditions[o.camelify(r)]=a.length-1)}function P(e,t,r,i,s){var a,c=new l({uri:r,bandwidth:t.BANDWIDTH,averageBandwidth:t["AVERAGE-BANDWIDTH"],codecs:t.CODECS,resolution:t.RESOLUTION,frameRate:t["FRAME-RATE"],hdcpLevel:t["HDCP-LEVEL"]}),u=n(e);try{for(u.s();!(a=u.n()).done;){var h=a.value;if("EXT-X-MEDIA"===h.name){var d=h.attributes,f=d.TYPE;if(f&&d["GROUP-ID"]||o.INVALIDPLAYLIST("EXT-X-MEDIA TYPE attribute is REQUIRED."),t[f]===d["GROUP-ID"]&&(R(c,h,f),"CLOSED-CAPTIONS"===f)){var p,_=n(c.closedCaptions);try{for(_.s();!(p=_.n()).done;){var v=p.value.instreamId;if(v&&v.startsWith("SERVICE")&&s.compatibleVersion<7){s.compatibleVersion=7;break}}}catch(e){_.e(e)}finally{_.f()}}}}}catch(e){u.e(e)}finally{u.f()}return function(e,t,r){["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(n){"CLOSED-CAPTIONS"===n&&"NONE"===e[n]?(r.isClosedCaptionsNone=!0,t.closedCaptions=[]):e[n]&&!t[o.camelify(n)].find(function(t){return t.groupId===e[n]})&&o.INVALIDPLAYLIST("".concat(n," attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ").concat(n,"."))})}(t,c,s),c.isIFrameOnly=i,c}function k(e,t){if(e.method!==t.method)return!1;if(e.uri!==t.uri)return!1;if(e.iv){if(!t.iv)return!1;if(e.iv.length!==t.iv.length)return!1;for(var r=0;r<e.iv.length;r++)if(e.iv[r]!==t.iv[r])return!1}else if(t.iv)return!1;return e.format===t.format&&e.formatVersion===t.formatVersion}function D(e,t,r,n,i,s,a){for(var c=new g({uri:t,mediaSequenceNumber:i,discontinuitySequence:s}),u=!1,l=!1,h=function(t){var r=e[t],n=r.name,i=r.value,s=r.attributes;if("EXTINF"===n)!Number.isInteger(i.duration)&&a.compatibleVersion<3&&(a.compatibleVersion=3),Math.round(i.duration)>a.targetDuration&&o.INVALIDPLAYLIST("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration"),c.duration=i.duration,c.title=i.title;else if("EXT-X-BYTERANGE"===n)a.compatibleVersion<4&&(a.compatibleVersion=4),c.byterange=i;else if("EXT-X-DISCONTINUITY"===n)c.parts.length>0&&o.INVALIDPLAYLIST("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment."),c.discontinuity=!0;else if("EXT-X-KEY"===n)c.parts.length>0&&o.INVALIDPLAYLIST("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment."),A(a,s),c.key=new d({method:s.METHOD,uri:s.URI,iv:s.IV,format:s.KEYFORMAT,formatVersion:s.KEYFORMATVERSIONS});else if("EXT-X-MAP"===n)c.parts.length>0&&o.INVALIDPLAYLIST("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment."),a.compatibleVersion<5&&(a.compatibleVersion=5),a.hasMap=!0,c.map=new f({uri:s.URI,byterange:s.BYTERANGE});else if("EXT-X-PROGRAM-DATE-TIME"===n)c.programDateTime=i;else if("EXT-X-DATERANGE"===n){var h={};Object.keys(s).forEach(function(e){(e.startsWith("SCTE35-")||e.startsWith("X-"))&&(h[e]=s[e])}),c.dateRange=new p({id:s.ID,classId:s.CLASS,start:s["START-DATE"],end:s["END-DATE"],duration:s.DURATION,plannedDuration:s["PLANNED-DURATION"],endOnNext:s["END-ON-NEXT"],attributes:h})}else if("EXT-X-CUE-OUT"===n)c.markers.push(new _({type:"OUT",duration:i}));else if("EXT-X-CUE-IN"===n)c.markers.push(new _({type:"IN"}));else if("EXT-X-CUE-OUT-CONT"===n||"EXT-X-CUE"===n||"EXT-OATCLS-SCTE35"===n||"EXT-X-ASSET"===n||"EXT-X-SCTE35"===n)c.markers.push(new _({type:"RAW",tagName:n,value:i}));else if("EXT-X-PRELOAD-HINT"!==n||s.TYPE)if("EXT-X-PRELOAD-HINT"===n&&"PART"===s.TYPE&&l)o.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.");else if("EXT-X-PART"!==n&&"EXT-X-PRELOAD-HINT"!==n||s.URI){if("EXT-X-PRELOAD-HINT"===n&&"MAP"===s.TYPE)u&&o.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist."),u=!0,a.hasMap=!0,c.map=new f({hint:!0,uri:s.URI,byterange:{length:s["BYTERANGE-LENGTH"],offset:s["BYTERANGE-START"]||0}});else if("EXT-X-PART"===n||"EXT-X-PRELOAD-HINT"===n&&"PART"===s.TYPE){"EXT-X-PART"!==n||s.DURATION||o.INVALIDPLAYLIST("EXT-X-PART: DURATION attribute is mandatory"),"EXT-X-PRELOAD-HINT"===n&&(l=!0);var v=new y({hint:"EXT-X-PRELOAD-HINT"===n,uri:s.URI,byterange:"EXT-X-PART"===n?s.BYTERANGE:{length:s["BYTERANGE-LENGTH"],offset:s["BYTERANGE-START"]||0},duration:s.DURATION,independent:s.INDEPENDENT,gap:s.GAP});c.parts.push(v)}}else o.INVALIDPLAYLIST("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory");else o.INVALIDPLAYLIST("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory")},v=r;v<=n;v++)h(v);return c}function O(e,t,r,n,i){var s=t.discontinuity,a=t.key,c=t.map,u=t.byterange,l=t.uri;if(s&&(t.discontinuitySequence=r+1),a||(t.key=n),c||(t.map=i),u&&-1===u.offset){var h=e.segments;if(h.length>0){var d=h[h.length-1];d.byterange&&d.uri===l?u.offset=d.byterange.offset+d.byterange.length:o.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource")}else o.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file")}return e.segments.push(t),[t.discontinuitySequence,t.key,t.map]}function L(e,t){var r=i(function(e){var t=e.indexOf(":");return-1===t?[e.slice(1).trim(),null]:[e.slice(1,t).trim(),e.slice(t+1).trim()]}(e),2),n=r[0],s=r[1],a=function(e){switch(e){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(n);if(function(e,t){if("Segment"===e||"MediaPlaylist"===e)return void 0===t.isMasterPlaylist?void(t.isMasterPlaylist=!1):void(t.isMasterPlaylist&&I());if("MasterPlaylist"===e){if(void 0===t.isMasterPlaylist)return void(t.isMasterPlaylist=!0);!1===t.isMasterPlaylist&&I()}}(a,t),"Unknown"===a)return null;"MediaPlaylist"===a&&"EXT-X-RENDITION-REPORT"!==n&&(t.hash[n]&&o.INVALIDPLAYLIST("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist"),t.hash[n]=!0);var c=i(function(e,t){switch(e){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-CUE-OUT":return[o.toNumber(t),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,w(t)];case"EXTINF":return[b(t),null];case"EXT-X-BYTERANGE":return[S(t),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(t),null];default:return[t,null]}}(n,s),2);return{name:n,category:a,value:c[0],attributes:c[1]}}function C(e,t){var r;return t.isMasterPlaylist?r=function(e,t){var r,s=new v,a=n(e.entries());try{for(a.s();!(r=a.n()).done;){var c=i(r.value,2),u=c[0],l=c[1],f=l.name,p=l.value,_=l.attributes;if("EXT-X-VERSION"===f)s.version=p;else if("EXT-X-STREAM-INF"===f){var m=e[u+1];("string"!=typeof m||m.startsWith("#EXT"))&&o.INVALIDPLAYLIST("EXT-X-STREAM-INF must be followed by a URI line");var g=P(e,_,m,!1,t);g&&s.variants.push(g)}else if("EXT-X-I-FRAME-STREAM-INF"===f){var y=P(e,_,_.URI,!0,t);y&&s.variants.push(y)}else"EXT-X-SESSION-DATA"===f?function(){var e=new h({id:_["DATA-ID"],value:_.VALUE,uri:_.URI,language:_.LANGUAGE});s.sessionDataList.find(function(t){return t.id===e.id&&t.language===e.language})&&o.INVALIDPLAYLIST("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute."),s.sessionDataList.push(e)}():"EXT-X-SESSION-KEY"===f?function(){"NONE"===_.METHOD&&o.INVALIDPLAYLIST("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE");var e=new d({method:_.METHOD,uri:_.URI,iv:_.IV,format:_.KEYFORMAT,formatVersion:_.KEYFORMATVERSIONS});s.sessionKeyList.find(function(t){return k(t,e)})&&o.INVALIDPLAYLIST("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values."),A(t,_),s.sessionKeyList.push(e)}():"EXT-X-INDEPENDENT-SEGMENTS"===f?(s.independentSegments&&o.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),s.independentSegments=!0):"EXT-X-START"===f&&(s.start&&o.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof _["TIME-OFFSET"]&&o.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),s.start={offset:_["TIME-OFFSET"],precise:_.PRECISE||!1})}}catch(e){a.e(e)}finally{a.f()}if(t.isClosedCaptionsNone){var E,T=n(s.variants);try{for(T.s();!(E=T.n()).done;)E.value.closedCaptions.length>0&&o.INVALIDPLAYLIST("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE")}catch(e){T.e(e)}finally{T.f()}}return s}(e,t):!(r=function(e,t){var r,s=new m,a=-1,c=0,u=!1,l=0,h=null,d=null,f=!1,p=n(e.entries());try{for(p.s();!(r=p.n()).done;){var _=i(r.value,2),v=_[0],g=_[1],y=g.name,T=g.value,b=g.attributes;if("Segment"!==g.category){if("EXT-X-VERSION"===y)void 0===s.version?s.version=T:o.INVALIDPLAYLIST("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.");else if("EXT-X-TARGETDURATION"===y)s.targetDuration=t.targetDuration=T;else if("EXT-X-MEDIA-SEQUENCE"===y)s.segments.length>0&&o.INVALIDPLAYLIST("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),s.mediaSequenceBase=c=T;else if("EXT-X-DISCONTINUITY-SEQUENCE"===y)s.segments.length>0&&o.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),u&&o.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag."),s.discontinuitySequenceBase=l=T;else if("EXT-X-ENDLIST"===y)s.endlist=!0;else if("EXT-X-PLAYLIST-TYPE"===y)s.playlistType=T;else if("EXT-X-I-FRAMES-ONLY"===y)t.compatibleVersion<4&&(t.compatibleVersion=4),s.isIFrame=!0;else if("EXT-X-INDEPENDENT-SEGMENTS"===y)s.independentSegments&&o.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),s.independentSegments=!0;else if("EXT-X-START"===y)s.start&&o.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof b["TIME-OFFSET"]&&o.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),s.start={offset:b["TIME-OFFSET"],precise:b.PRECISE||!1};else if("EXT-X-SERVER-CONTROL"===y)b["CAN-BLOCK-RELOAD"]||o.INVALIDPLAYLIST("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS"),s.lowLatencyCompatibility={canBlockReload:b["CAN-BLOCK-RELOAD"],canSkipUntil:b["CAN-SKIP-UNTIL"],holdBack:b["HOLD-BACK"],partHoldBack:b["PART-HOLD-BACK"]};else if("EXT-X-PART-INF"===y)b["PART-TARGET"]||o.INVALIDPLAYLIST("EXT-X-PART-INF: PART-TARGET attribute is mandatory"),s.partTargetDuration=b["PART-TARGET"];else if("EXT-X-RENDITION-REPORT"===y)b.URI||o.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI attribute is mandatory"),0===b.URI.search(/^[a-z]+:/)&&o.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri"),s.renditionReports.push(new E({uri:b.URI,lastMSN:b["LAST-MSN"],lastPart:b["LAST-PART"]}));else if("EXT-X-SKIP"===y)b["SKIPPED-SEGMENTS"]||o.INVALIDPLAYLIST("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory"),t.compatibleVersion<9&&(t.compatibleVersion=9),s.skip=b["SKIPPED-SEGMENTS"],c+=s.skip;else if("string"==typeof g){-1===a&&o.INVALIDPLAYLIST("A URI line is not preceded by any segment tags"),s.targetDuration||o.INVALIDPLAYLIST("The EXT-X-TARGETDURATION tag is REQUIRED");var S=D(e,g,a,v-1,c++,l,t);if(S){var A=i(O(s,S,l,h,d),3);l=A[0],h=A[1],d=A[2],!f&&S.parts.length>0&&(f=!0)}a=-1}}else-1===a&&(a=v),"EXT-X-DISCONTINUITY"===y&&(u=!0)}}catch(e){p.e(e)}finally{p.f()}if(-1!==a){var w=D(e,"",a,e.length-1,c++,l,t);if(w){var I=w.parts;I.length>0&&!s.endlist&&!I[I.length-1].hint&&o.INVALIDPLAYLIST("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute"),O(s,w,h,d),!f&&w.parts.length>0&&(f=!0)}}return function(e){for(var t=new Map,r=new Map,i=!1,s=!1,a=e.length-1;a>=0;a--){var c=e[a],u=c.programDateTime,l=c.dateRange;if(u&&(s=!0),l&&l.start){i=!0,l.endOnNext&&(l.end||l.duration)&&o.INVALIDPLAYLIST("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.");var h=l.start.getTime(),d=l.duration||0;l.end&&l.duration&&h+1e3*d!==l.end.getTime()&&o.INVALIDPLAYLIST("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION"),l.endOnNext&&(l.end=t.get(l.classId)),t.set(l.classId,l.start);var f=l.end?l.end.getTime():l.start.getTime()+1e3*(l.duration||0),p=r.get(l.classId);if(p){var _,v=n(p);try{for(v.s();!(_=v.n()).done;){var m=_.value;(m.start<=h&&m.end>h||m.start>=h&&m.start<f)&&o.INVALIDPLAYLIST("DATERANGE tags with the same CLASS should not overlap")}}catch(e){v.e(e)}finally{v.f()}p.push({start:h,end:f})}else r.set(l.classId,[{start:h,end:f}])}}i&&!s&&o.INVALIDPLAYLIST("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.")}(s.segments),s.lowLatencyCompatibility&&function(e,t){var r=e.lowLatencyCompatibility,s=e.targetDuration,a=e.partTargetDuration,c=e.segments,u=e.renditionReports,l=r.canSkipUntil,h=r.holdBack,d=r.partHoldBack;if(l<6*s&&o.INVALIDPLAYLIST("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION."),h<3*s&&o.INVALIDPLAYLIST("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION."),t){void 0===a&&o.INVALIDPLAYLIST("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags"),void 0===d&&o.INVALIDPLAYLIST("EXT-X-PART: PART-HOLD-BACK attribute is mandatory"),d<a&&o.INVALIDPLAYLIST("PART-HOLD-BACK must be at least PART-TARGET");var f,p=n(c.entries());try{for(p.s();!(f=p.n()).done;){var _=i(f.value,2),v=_[0],m=_[1].parts;m.length>0&&v<c.length-3&&o.INVALIDPLAYLIST("Remove EXT-X-PART tags from the Playlist after they are greater than three target durations from the end of the Playlist.");var g,y=n(m.entries());try{for(y.s();!(g=y.n()).done;){var E=i(g.value,2),T=E[0],b=E[1].duration;void 0!==b&&(b>a&&o.INVALIDPLAYLIST("PART-TARGET is the maximum duration of any Partial Segment"),T<m.length-1&&b<.85*a&&o.INVALIDPLAYLIST("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET"))}}catch(e){y.e(e)}finally{y.f()}}}catch(e){p.e(e)}finally{p.f()}}var S,A=n(u);try{for(A.s();!(S=A.n()).done;){var w=S.value,I=c[c.length-1];w.lastMSN||(w.lastMSN=I.mediaSequenceNumber),!w.lastPart&&I.parts.length>0&&(w.lastPart=I.parts.length-1)}}catch(e){A.e(e)}finally{A.f()}}(s,f),s}(e,t)).isIFrame&&t.hasMap&&t.compatibleVersion<6&&(t.compatibleVersion=6),t.compatibleVersion>1&&(!r.version||r.version<t.compatibleVersion)&&o.INVALIDPLAYLIST("EXT-X-VERSION needs to be ".concat(t.compatibleVersion," or higher.")),r}e.exports=function(e){var t={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},r=C(function(e,t){var r=[];return e.split("\n").forEach(function(e){var n=e.trim();if(n)if(n.startsWith("#")){if(n.startsWith("#EXT")){var i=L(n,t);return void(i&&r.push(i))}}else r.push(n)}),0!==r.length&&"EXTM3U"===r[0].name||o.INVALIDPLAYLIST("The EXTM3U tag MUST be the first line."),r}(e,t),t);return r.source=e,r}},367:(e,t,r)=>{function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw s}}}}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return h(e,arguments,p(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)})(e)}function h(e,t,r){return(h=d()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&f(i,r.prototype),i}).apply(null,arguments)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=r(771),v=["#EXTINF","#EXT-X-BYTERANGE","#EXT-X-DISCONTINUITY","#EXT-X-STREAM-INF","#EXT-X-CUE-OUT","#EXT-X-CUE-IN","#EXT-X-KEY","#EXT-X-MAP"],m=["#EXT-X-MEDIA"],g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,r,n,i=(t=s,r=d(),function(){var e,n=p(t);if(r){var i=p(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return u(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this)).baseUri=e,t}return(n=[{key:"push",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=function(){var t=o[a];if(!t.startsWith("#"))return c(p(s.prototype),"push",e).call(e,t),"continue";if(v.some(function(e){return t.startsWith(e)}))return c(p(s.prototype),"push",e).call(e,t),"continue";if(e.includes(t)){if(m.some(function(e){return t.startsWith(e)}))return"continue";_.INVALIDPLAYLIST("Redundant item (".concat(t,")"))}c(p(s.prototype),"push",e).call(e,t)},a=0,o=r;a<o.length;a++)i()}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(s.prototype,n),s}(l(Array));function y(e,t){var r=1e3;t&&(r=Math.pow(10,t));var n=Math.round(e*r)/r;return t?n.toFixed(t):n}function E(e){var t=['DATA-ID="'.concat(e.id,'"')];return e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.value?t.push('VALUE="'.concat(e.value,'"')):e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-SESSION-DATA:".concat(t.join(","))}function T(e,t){var r=t?"#EXT-X-SESSION-KEY":"#EXT-X-KEY",n=["METHOD=".concat(e.method)];return e.uri&&n.push('URI="'.concat(e.uri,'"')),e.iv&&(16!==e.iv.length&&_.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),n.push("IV=".concat(_.byteSequenceToHex(e.iv)))),e.format&&n.push('KEYFORMAT="'.concat(e.format,'"')),e.formatVersion&&n.push('KEYFORMATVERSIONS="'.concat(e.formatVersion,'"')),"".concat(r,":").concat(n.join(","))}function b(e,t){var r=t.isIFrameOnly?"#EXT-X-I-FRAME-STREAM-INF":"#EXT-X-STREAM-INF",n=["BANDWIDTH=".concat(t.bandwidth)];if(t.averageBandwidth&&n.push("AVERAGE-BANDWIDTH=".concat(t.averageBandwidth)),t.isIFrameOnly&&n.push('URI="'.concat(t.uri,'"')),t.codecs&&n.push('CODECS="'.concat(t.codecs,'"')),t.resolution&&n.push("RESOLUTION=".concat(t.resolution.width,"x").concat(t.resolution.height)),t.frameRate&&n.push("FRAME-RATE=".concat(y(t.frameRate,3))),t.hdcpLevel&&n.push("HDCP-LEVEL=".concat(t.hdcpLevel)),t.audio.length>0){n.push('AUDIO="'.concat(t.audio[0].groupId,'"'));var i,a=s(t.audio);try{for(a.s();!(i=a.n()).done;){var o=i.value;e.push(S(o))}}catch(e){a.e(e)}finally{a.f()}}if(t.video.length>0){n.push('VIDEO="'.concat(t.video[0].groupId,'"'));var c,u=s(t.video);try{for(u.s();!(c=u.n()).done;){var l=c.value;e.push(S(l))}}catch(e){u.e(e)}finally{u.f()}}if(t.subtitles.length>0){n.push('SUBTITLES="'.concat(t.subtitles[0].groupId,'"'));var h,d=s(t.subtitles);try{for(d.s();!(h=d.n()).done;){var f=h.value;e.push(S(f))}}catch(e){d.e(e)}finally{d.f()}}if(_.getOptions().allowClosedCaptionsNone&&0===t.closedCaptions.length)n.push("CLOSED-CAPTIONS=NONE");else if(t.closedCaptions.length>0){n.push('CLOSED-CAPTIONS="'.concat(t.closedCaptions[0].groupId,'"'));var p,v=s(t.closedCaptions);try{for(v.s();!(p=v.n()).done;){var m=p.value;e.push(S(m))}}catch(e){v.e(e)}finally{v.f()}}e.push("".concat(r,":").concat(n.join(","))),t.isIFrameOnly||e.push("".concat(t.uri))}function S(e){var t=["TYPE=".concat(e.type),'GROUP-ID="'.concat(e.groupId,'"'),'NAME="'.concat(e.name,'"')];return void 0!==e.isDefault&&t.push("DEFAULT=".concat(e.isDefault?"YES":"NO")),void 0!==e.autoselect&&t.push("AUTOSELECT=".concat(e.autoselect?"YES":"NO")),void 0!==e.forced&&t.push("FORCED=".concat(e.forced?"YES":"NO")),e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.assocLanguage&&t.push('ASSOC-LANGUAGE="'.concat(e.assocLanguage,'"')),e.instreamId&&t.push('INSTREAM-ID="'.concat(e.instreamId,'"')),e.characteristics&&t.push('CHARACTERISTICS="'.concat(e.characteristics,'"')),e.channels&&t.push('CHANNELS="'.concat(e.channels,'"')),e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-MEDIA:".concat(t.join(","))}function A(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=!1;if(t.byterange&&e.push("#EXT-X-BYTERANGE:".concat(w(t.byterange))),t.discontinuity&&e.push("#EXT-X-DISCONTINUITY"),t.key){var a=T(t.key);a!==r&&(e.push(a),r=a)}if(t.map){var o=function(e){var t=['URI="'.concat(e.uri,'"')];return e.byterange&&t.push('BYTERANGE="'.concat(w(e.byterange),'"')),"#EXT-X-MAP:".concat(t.join(","))}(t.map);o!==n&&(e.push(o),n=o)}if(t.programDateTime&&e.push("#EXT-X-PROGRAM-DATE-TIME:".concat(_.formatDate(t.programDateTime))),t.dateRange&&e.push(function(e){var t=['ID="'.concat(e.id,'"')];return e.start&&t.push('START-DATE="'.concat(_.formatDate(e.start),'"')),e.end&&t.push('END-DATE="'.concat(e.end,'"')),e.duration&&t.push("DURATION=".concat(e.duration)),e.plannedDuration&&t.push("PLANNED-DURATION=".concat(e.plannedDuration)),e.classId&&t.push('CLASS="'.concat(e.classId,'"')),e.endOnNext&&t.push("END-ON-NEXT=YES"),Object.keys(e.attributes).forEach(function(r){r.startsWith("X-")?"number"==typeof e.attributes[r]?t.push("".concat(r,"=").concat(e.attributes[r])):t.push("".concat(r,'="').concat(e.attributes[r],'"')):r.startsWith("SCTE35-")&&t.push("".concat(r,"=").concat(_.byteSequenceToHex(e.attributes[r])))}),"#EXT-X-DATERANGE:".concat(t.join(","))}(t.dateRange)),t.markers.length>0&&I(e,t.markers),t.parts.length>0&&(s=R(e,t.parts)),s)return[r,n];var c=i<3?Math.round(t.duration):y(t.duration,function(e){var t=e.toString(10),r=t.indexOf(".");return-1===r?0:t.length-r-1}(t.duration));return e.push("#EXTINF:".concat(c,",").concat(unescape(encodeURIComponent(t.title||"")))),Array.prototype.push.call(e,"".concat(t.uri)),[r,n]}function w(e){var t=e.offset,r=e.length;return"".concat(r,"@").concat(t)}function I(e,t){var r,n=s(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;if("OUT"===i.type)e.push("#EXT-X-CUE-OUT:".concat(i.duration));else if("IN"===i.type)e.push("#EXT-X-CUE-IN");else if("RAW"===i.type){var a=i.value?":".concat(i.value):"";e.push("#".concat(i.tagName).concat(a))}}}catch(e){n.e(e)}finally{n.f()}}function R(e,t){var r,n=!1,i=s(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.hint){var o=[];if(o.push("TYPE=PART"),o.push('URI="'.concat(a.uri,'"')),a.byterange){var c=a.byterange,u=c.offset,l=c.length;o.push("BYTERANGE-START=".concat(u)),l&&o.push("BYTERANGE-LENGTH=".concat(l))}e.push("#EXT-X-PRELOAD-HINT:".concat(o.join(","))),n=!0}else{var h=[];h.push("DURATION=".concat(a.duration)),h.push('URI="'.concat(a.uri,'"')),a.byterange&&h.push("BYTERANGE=".concat(w(a.byterange))),a.independent&&h.push("INDEPENDENT=YES"),a.gap&&h.push("GAP=YES"),e.push("#EXT-X-PART:".concat(h.join(",")))}}}catch(e){i.e(e)}finally{i.f()}return n}e.exports=function(e){_.PARAMCHECK(e),_.ASSERT("Not a playlist","playlist"===e.type);var t=new g(e.uri);return t.push("#EXTM3U"),e.version&&t.push("#EXT-X-VERSION:".concat(e.version)),e.independentSegments&&t.push("#EXT-X-INDEPENDENT-SEGMENTS"),e.start&&t.push("#EXT-X-START:TIME-OFFSET=".concat(y(e.start.offset)).concat(e.start.precise?",PRECISE=YES":"")),e.isMasterPlaylist?function(e,t){var r,n=s(t.sessionDataList);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.push(E(i))}}catch(e){n.e(e)}finally{n.f()}var a,o=s(t.sessionKeyList);try{for(o.s();!(a=o.n()).done;){var c=a.value;e.push(T(c,!0))}}catch(e){o.e(e)}finally{o.f()}var u,l=s(t.variants);try{for(l.s();!(u=l.n()).done;)b(e,u.value)}catch(e){l.e(e)}finally{l.f()}}(t,e):function(e,t){var r="",n="";if(t.targetDuration&&e.push("#EXT-X-TARGETDURATION:".concat(t.targetDuration)),t.lowLatencyCompatibility){var a=t.lowLatencyCompatibility,o=a.canBlockReload,c=a.canSkipUntil,u=a.holdBack,l=a.partHoldBack,h=[];h.push("CAN-BLOCK-RELOAD=".concat(o?"YES":"NO")),void 0!==c&&h.push("CAN-SKIP-UNTIL=".concat(c)),void 0!==u&&h.push("HOLD-BACK=".concat(u)),void 0!==l&&h.push("PART-HOLD-BACK=".concat(l)),e.push("#EXT-X-SERVER-CONTROL:".concat(h.join(",")))}t.partTargetDuration&&e.push("#EXT-X-PART-INF:PART-TARGET=".concat(t.partTargetDuration)),t.mediaSequenceBase&&e.push("#EXT-X-MEDIA-SEQUENCE:".concat(t.mediaSequenceBase)),t.discontinuitySequenceBase&&e.push("#EXT-X-DISCONTINUITY-SEQUENCE:".concat(t.discontinuitySequenceBase)),t.playlistType&&e.push("#EXT-X-PLAYLIST-TYPE:".concat(t.playlistType)),t.isIFrame&&e.push("#EXT-X-I-FRAMES-ONLY"),t.skip>0&&e.push("#EXT-X-SKIP:SKIPPED-SEGMENTS=".concat(t.skip));var d,f=s(t.segments);try{for(f.s();!(d=f.n()).done;){var p=i(A(e,d.value,r,n,t.version),2);r=p[0],n=p[1]}}catch(e){f.e(e)}finally{f.f()}t.endlist&&e.push("#EXT-X-ENDLIST");var _,v=s(t.renditionReports);try{for(v.s();!(_=v.n()).done;){var m=_.value,g=[];g.push('URI="'.concat(m.uri,'"')),g.push("LAST-MSN=".concat(m.lastMSN)),void 0!==m.lastPart&&g.push("LAST-PART=".concat(m.lastPart)),e.push("#EXT-X-RENDITION-REPORT:".concat(g.join(",")))}}catch(e){v.e(e)}finally{v.f()}}(t,e),t.join("\n")}},890:(e,t,r)=>{function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return o(this,r)}}function o(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=r(771),h=function e(t){u(this,e),l.PARAMCHECK(t),this.type=t},d=function(e){i(r,e);var t=a(r);function r(e){var n,i=e.isMasterPlaylist,s=e.uri,a=e.version,o=e.independentSegments,c=void 0!==o&&o,h=e.start,d=e.source;return u(this,r),n=t.call(this,"playlist"),l.PARAMCHECK(i),n.isMasterPlaylist=i,n.uri=s,n.version=a,n.independentSegments=c,n.start=h,n.source=d,n}return r}(h),f=function(e){i(r,e);var t=a(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,r),n.isMasterPlaylist=!0,e=t.call(this,n);var i=n.variants,s=void 0===i?[]:i,a=n.currentVariant,o=n.sessionDataList,c=void 0===o?[]:o,l=n.sessionKeyList,h=void 0===l?[]:l;return e.variants=s,e.currentVariant=a,e.sessionDataList=c,e.sessionKeyList=h,e}return r}(d),p=function(e){i(r,e);var t=a(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,r),n.isMasterPlaylist=!1,e=t.call(this,n);var i=n.targetDuration,s=n.mediaSequenceBase,a=void 0===s?0:s,o=n.discontinuitySequenceBase,c=void 0===o?0:o,l=n.endlist,h=void 0!==l&&l,d=n.playlistType,f=n.isIFrame,p=n.segments,_=void 0===p?[]:p,v=n.lowLatencyCompatibility,m=n.partTargetDuration,g=n.renditionReports,y=void 0===g?[]:g,E=n.skip,T=void 0===E?0:E,b=n.hash;return e.targetDuration=i,e.mediaSequenceBase=a,e.discontinuitySequenceBase=c,e.endlist=h,e.playlistType=d,e.isIFrame=f,e.segments=_,e.lowLatencyCompatibility=v,e.partTargetDuration=m,e.renditionReports=y,e.skip=T,e.hash=b,e}return r}(d),_=function(e){i(r,e);var t=a(r);function r(e){var n,i=e.uri,s=e.mimeType,a=e.data,o=e.duration,c=e.title,l=e.byterange,h=e.discontinuity,d=e.mediaSequenceNumber,f=void 0===d?0:d,p=e.discontinuitySequence,_=void 0===p?0:p,v=e.key,m=e.map,g=e.programDateTime,y=e.dateRange,E=e.markers,T=void 0===E?[]:E,b=e.parts,S=void 0===b?[]:b;return u(this,r),(n=t.call(this,"segment")).uri=i,n.mimeType=s,n.data=a,n.duration=o,n.title=c,n.byterange=l,n.discontinuity=h,n.mediaSequenceNumber=f,n.discontinuitySequence=_,n.key=v,n.map=m,n.programDateTime=g,n.dateRange=y,n.markers=T,n.parts=S,n}return r}(h),v=function(e){i(r,e);var t=a(r);function r(e){var n,i=e.hint,s=void 0!==i&&i,a=e.uri,o=e.duration,c=e.independent,h=e.byterange,d=e.gap;return u(this,r),n=t.call(this,"part"),l.PARAMCHECK(a),n.hint=s,n.uri=a,n.duration=o,n.independent=c,n.duration=o,n.byterange=h,n.gap=d,n}return r}(h);e.exports={Rendition:function e(t){var r=t.type,n=t.uri,i=t.groupId,s=t.language,a=t.assocLanguage,o=t.name,c=t.isDefault,h=t.autoselect,d=t.forced,f=t.instreamId,p=t.characteristics,_=t.channels;u(this,e),l.PARAMCHECK(r,i,o),l.CONDITIONALASSERT(["SUBTITLES"===r,n],["CLOSED-CAPTIONS"===r,f],["CLOSED-CAPTIONS"===r,!n],[d,"SUBTITLES"===r]),this.type=r,this.uri=n,this.groupId=i,this.language=s,this.assocLanguage=a,this.name=o,this.isDefault=c,this.autoselect=h,this.forced=d,this.instreamId=f,this.characteristics=p,this.channels=_},Variant:function e(t){var r=t.uri,n=t.isIFrameOnly,i=void 0!==n&&n,s=t.bandwidth,a=t.averageBandwidth,o=t.codecs,c=t.resolution,h=t.frameRate,d=t.hdcpLevel,f=t.audio,p=void 0===f?[]:f,_=t.video,v=void 0===_?[]:_,m=t.subtitles,g=void 0===m?[]:m,y=t.closedCaptions,E=void 0===y?[]:y,T=t.currentRenditions,b=void 0===T?{audio:0,video:0,subtitles:0,closedCaptions:0}:T;u(this,e),l.PARAMCHECK(r,s),this.uri=r,this.isIFrameOnly=i,this.bandwidth=s,this.averageBandwidth=a,this.codecs=o,this.resolution=c,this.frameRate=h,this.hdcpLevel=d,this.audio=p,this.video=v,this.subtitles=g,this.closedCaptions=E,this.currentRenditions=b},SessionData:function e(t){var r=t.id,n=t.value,i=t.uri,s=t.language;u(this,e),l.PARAMCHECK(r,n||i),l.ASSERT("SessionData cannot have both value and uri, shoud be either.",!(n&&i)),this.id=r,this.value=n,this.uri=i,this.language=s},Key:function e(t){var r=t.method,n=t.uri,i=t.iv,s=t.format,a=t.formatVersion;u(this,e),l.PARAMCHECK(r),l.CONDITIONALPARAMCHECK(["NONE"!==r,n]),l.CONDITIONALASSERT(["NONE"===r,!(n||i||s||a)]),this.method=r,this.uri=n,this.iv=i,this.format=s,this.formatVersion=a},MediaInitializationSection:function e(t){var r=t.hint,n=void 0!==r&&r,i=t.uri,s=t.mimeType,a=t.byterange;u(this,e),l.PARAMCHECK(i),this.hint=n,this.uri=i,this.mimeType=s,this.byterange=a},DateRange:function e(t){var r=t.id,n=t.classId,i=t.start,s=t.end,a=t.duration,o=t.plannedDuration,c=t.endOnNext,h=t.attributes,d=void 0===h?{}:h;u(this,e),l.PARAMCHECK(r),l.CONDITIONALPARAMCHECK([!0===c,n]),l.CONDITIONALASSERT([s,i],[s,i<=s],[a,a>=0],[o,o>=0]),this.id=r,this.classId=n,this.start=i,this.end=s,this.duration=a,this.plannedDuration=o,this.endOnNext=c,this.attributes=d},SpliceInfo:function e(t){var r=t.type,n=t.duration,i=t.tagName,s=t.value;u(this,e),l.PARAMCHECK(r),l.CONDITIONALPARAMCHECK(["OUT"===r,n]),l.CONDITIONALPARAMCHECK(["RAW"===r,i]),this.type=r,this.duration=n,this.tagName=i,this.value=s},Playlist:d,MasterPlaylist:f,MediaPlaylist:p,Segment:_,PartialSegment:v,RenditionReport:function e(t){var r=t.uri,n=t.lastMSN,i=t.lastPart;u(this,e),l.PARAMCHECK(r),this.uri=r,this.lastMSN=n,this.lastPart=i}}},771:e=>{function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw a}}}}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s={};function a(e){if(s.strictMode)throw e;s.silent}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if("number"==typeof e)return e;var r=10===t?Number.parseFloat(e,t):Number.parseInt(e,t);return Number.isNaN(r)?0:r}e.exports={THROW:a,ASSERT:function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var o,c=r(i.entries());try{for(c.s();!(o=c.n()).done;){var u=t(o.value,2),l=u[0];u[1]||a(new Error("".concat(e," : Failed at [").concat(l,"]")))}}catch(e){c.e(e)}finally{c.f()}},CONDITIONALASSERT:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s,o=r(n.entries());try{for(o.s();!(s=o.n()).done;){var c=t(s.value,2),u=c[0],l=t(c[1],2),h=l[0],d=l[1];h&&(d||a(new Error("Conditional Assert : Failed at [".concat(u,"]"))))}}catch(e){o.e(e)}finally{o.f()}},PARAMCHECK:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s,o=r(n.entries());try{for(o.s();!(s=o.n()).done;){var c=t(s.value,2),u=c[0];void 0===c[1]&&a(new Error("Param Check : Failed at [".concat(u,"]")))}}catch(e){o.e(e)}finally{o.f()}},CONDITIONALPARAMCHECK:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s,o=r(n.entries());try{for(o.s();!(s=o.n()).done;){var c=t(s.value,2),u=c[0],l=t(c[1],2),h=l[0],d=l[1];h&&void 0===d&&a(new Error("Conditional Param Check : Failed at [".concat(u,"]")))}}catch(e){o.e(e)}finally{o.f()}},INVALIDPLAYLIST:function(e){a(new Error("Invalid Playlist : ".concat(e)))},toNumber:o,hexToByteSequence:function(e){(e.startsWith("0x")||e.startsWith("0X"))&&(e=e.slice(2));for(var t=[],r=0;r<e.length;r+=2)t.push(o(e.slice(r,r+2),16));return Buffer.from(t)},byteSequenceToHex:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;r<=t&&a(new Error("end must be larger than start : start=".concat(t,", end=").concat(r)));for(var n=[],i=t;i<r;i++)n.push("0".concat((255&e[i]).toString(16).toUpperCase()).slice(-2));return"0x".concat(n.join(""))},tryCatch:function(e,t){try{return e()}catch(e){return t(e)}},splitAt:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=-1,i=0,s=0;i<e.length;i++)if(e[i]===t){if(s++===r)return[e.slice(0,i),e.slice(i+1)];n=i}return-1!==n?[e.slice(0,n),e.slice(n+1)]:[e]},trim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e?(e=e.trim()," "===t||(e.startsWith(t)&&(e=e.slice(1)),e.endsWith(t)&&(e=e.slice(0,-1))),e):e},splitByCommaWithPreservingQuotes:function(e){for(var t=[],r=!0,n=0,i=[],s=0;s<e.length;s++){var a=e[s];r&&","===a?(t.push(e.slice(n,s).trim()),n=s+1):'"'!==a&&"'"!==a||(r?(i.push(a),r=!1):a===i[i.length-1]?(i.pop(),r=!0):i.push(a))}return t.push(e.slice(n).trim()),t},camelify:function(e){var t,n=[],i=!1,s=r(e);try{for(s.s();!(t=s.n()).done;){var a=t.value;"-"!==a&&"_"!==a?i?(n.push(a.toUpperCase()),i=!1):n.push(a.toLowerCase()):i=!0}}catch(e){s.e(e)}finally{s.f()}return n.join("")},formatDate:function(e){var t=e.getUTCFullYear(),r=("0"+(e.getUTCMonth()+1)).slice(-2),n=("0"+e.getUTCDate()).slice(-2),i=("0"+e.getUTCHours()).slice(-2),s=("0"+e.getUTCMinutes()).slice(-2),a=("0"+e.getUTCSeconds()).slice(-2),o=("00"+e.getUTCMilliseconds()).slice(-3);return"".concat(t,"-").concat(r,"-").concat(n,"T").concat(i,":").concat(s,":").concat(a,".").concat(o,"Z")},hasOwnProp:function(e,t){return Object.hasOwnProperty.call(e,t)},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s=Object.assign(s,e)},getOptions:function(){return Object.assign({},s)}}}},t={},function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(851);var e,t}()});function CF(){return CF=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CF.apply(this,arguments)}var MF,NF=["bottom","height","left","right","top","width"],xF=new Map,UF=function e(){var t=[];xF.forEach(function(e,r){var n=r.getBoundingClientRect();(function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),NF.some(function(r){return e[r]!==t[r]})})(n,e.rect)&&(e.rect=n,t.push(e))}),t.forEach(function(e){e.callbacks.forEach(function(t){return t(e.rect)})}),MF=window.requestAnimationFrame(e)},FF="undefined"!=typeof window?oF.useLayoutEffect:oF.useEffect;function VF(e,t){void 0===t&&(t={width:0,height:0});var r=oF.useState(e.current),n=r[0],i=r[1],s=oF.useReducer(jF,t),a=s[0],o=s[1],c=oF.useRef(!1);return FF(function(){e.current!==n&&i(e.current)}),FF(function(){if(n&&!c.current){c.current=!0;var e=n.getBoundingClientRect();o({rect:e})}},[n]),oF.useEffect(function(){if(n){var e=function(e,t){return{observe:function(){var r=0===xF.size;xF.has(e)?xF.get(e).callbacks.push(t):xF.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),r&&UF()},unobserve:function(){var r=xF.get(e);if(r){var n=r.callbacks.indexOf(t);n>=0&&r.callbacks.splice(n,1),r.callbacks.length||xF.delete(e),xF.size||cancelAnimationFrame(MF)}}}}(n,function(e){o({rect:e})});return e.observe(),function(){e.unobserve()}}},[n]),a}function jF(e,t){var r=t.rect;return e.height!==r.height||e.width!==r.width?r:e}var BF=function(){return 50},HF=function(e){return e},XF=function(e,t){return e[t?"offsetWidth":"offsetHeight"]},WF=function(e){for(var t=Math.max(e.start-e.overscan,0),r=Math.min(e.end+e.overscan,e.size-1),n=[],i=t;i<=r;i++)n.push(i);return n};function qF(e){var t,r=e.size,n=void 0===r?0:r,i=e.estimateSize,s=void 0===i?BF:i,a=e.overscan,o=void 0===a?1:a,c=e.paddingStart,u=void 0===c?0:c,l=e.paddingEnd,h=void 0===l?0:l,d=e.parentRef,f=e.horizontal,p=e.scrollToFn,_=e.useObserver,v=e.initialRect,m=e.onScrollElement,g=e.scrollOffsetFn,y=e.keyExtractor,E=void 0===y?HF:y,T=e.measureSize,b=void 0===T?XF:T,S=e.rangeExtractor,A=void 0===S?WF:S,w=f?"width":"height",I=f?"scrollLeft":"scrollTop",R=oF.useRef({scrollOffset:0,measurements:[]}),P=oF.useState(0),k=P[0],D=P[1];R.current.scrollOffset=k;var O=(_||VF)(d,v)[w];R.current.outerSize=O;var L=oF.useCallback(function(e){d.current&&(d.current[I]=e)},[d,I]),C=p||L;p=oF.useCallback(function(e){C(e,L)},[L,C]);var M=oF.useState({}),N=M[0],x=M[1],U=oF.useCallback(function(){return x({})},[]),F=oF.useRef([]),V=oF.useMemo(function(){var e=F.current.length>0?Math.min.apply(Math,F.current):0;F.current=[];for(var t=R.current.measurements.slice(0,e),r=e;r<n;r++){var i=E(r),a=N[i],o=t[r-1]?t[r-1].end:u,c="number"==typeof a?a:s(r),l=o+c;t[r]={index:r,start:o,size:c,end:l,key:i}}return t},[s,N,u,n,E]),j=((null==(t=V[n-1])?void 0:t.end)||u)+h;R.current.measurements=V,R.current.totalSize=j;var B=m?m.current:d.current,H=oF.useRef(g);H.current=g,FF(function(){if(B){var e=function(e){var t=H.current?H.current(e):B[I];D(t)};return e(),B.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){B.removeEventListener("scroll",e)}}D(0)},[B,I]);var X=function(e){for(var t=e.measurements,r=e.outerSize,n=e.scrollOffset,i=t.length-1,s=GF(0,i,function(e){return t[e].start},n),a=s;a<i&&t[a].end<n+r;)a++;return{start:s,end:a}}(R.current),W=X.start,q=X.end,G=oF.useMemo(function(){return A({start:W,end:q,overscan:o,size:V.length})},[W,q,o,V.length,A]),K=oF.useRef(b);K.current=b;var Y=oF.useMemo(function(){for(var e=[],t=function(t,r){var n=G[t],i=CF(CF({},V[n]),{},{measureRef:function(e){if(e){var t=K.current(e,f);if(t!==i.size){var r=R.current.scrollOffset;i.start<r&&L(r+(t-i.size)),F.current.push(n),x(function(e){var r;return CF(CF({},e),{},((r={})[i.key]=t,r))})}}}});e.push(i)},r=0,n=G.length;r<n;r++)t(r);return e},[G,L,f,V]),z=oF.useRef(!1);FF(function(){z.current&&x({}),z.current=!0},[s]);var $=oF.useCallback(function(e,t){var r=(void 0===t?{}:t).align,n=void 0===r?"start":r,i=R.current,s=i.scrollOffset,a=i.outerSize;"auto"===n&&(n=e<=s?"start":e>=s+a?"end":"start"),"start"===n?p(e):"end"===n?p(e-a):"center"===n&&p(e-a/2)},[p]),J=oF.useCallback(function(e,t){var r=void 0===t?{}:t,i=r.align,s=void 0===i?"auto":i,a=function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(r,["align"]),o=R.current,c=o.measurements,u=o.scrollOffset,l=o.outerSize,h=c[Math.max(0,Math.min(e,n-1))];if(h){if("auto"===s)if(h.end>=u+l)s="end";else{if(!(h.start<=u))return;s="start"}var d="center"===s?h.start+h.size/2:"end"===s?h.end:h.start;$(d,CF({align:s},a))}},[$,n]),Q=oF.useCallback(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];J.apply(void 0,t),requestAnimationFrame(function(){J.apply(void 0,t)})},[J]);return{virtualItems:Y,totalSize:j,scrollToOffset:$,scrollToIndex:Q,measure:U}}var GF=function(e,t,r,n){for(;e<=t;){var i=(e+t)/2|0,s=r(i);if(s<n)e=i+1;else{if(!(s>n))return i;t=i-1}}return e>0?e-1:0};export{pM as $,ob as A,oL as B,VC as C,FR as D,nw as E,lL as F,aM as G,uL as H,nL as I,iL as J,hL as K,PL as L,BC as M,fL as N,pL as O,sL as P,aL as Q,dL as R,DR as S,pR as T,mR as U,lR as V,ab as W,HC as X,_A as Y,GS as Z,ew as _,pb as a,KA as a$,_M as a0,bM as a1,VM as a2,DC as a3,FM as a4,RC as a5,rR as a6,nS as a7,Jb as a8,zC as a9,lF as aA,dU as aB,fF as aC,uF as aD,aU as aE,PF as aF,yb as aG,hF as aH,kU as aI,NU as aJ,Ex as aK,bx as aL,lU as aM,qx as aN,Dx as aO,Wx as aP,cU as aQ,GU as aR,OF as aS,Qb as aT,Hx as aU,JA as aV,QA as aW,$A as aX,FL as aY,lC as aZ,WA as a_,iS as aa,eS as ab,_b as ac,BM as ad,oO as ae,jC as af,tC as ag,TD as ah,ED as ai,AN as aj,oS as ak,RN as al,IN as am,GN as an,tS as ao,SS as ap,gD as aq,yD as ar,dx as as,sx as at,px as au,ub as av,sU as aw,nU as ax,oU as ay,uU as az,bb as b,qA as b0,hb as b1,xC as b2,Kb as b3,wb as b4,gb as b5,IO as b6,wO as b7,TM as b8,PS as b9,LF as ba,eb as bb,tb as bc,mb as bd,lS as be,ZT as bf,uS as bg,vb as bh,bD as bi,qF as bj,VI as c,db as d,NL as e,QT as f,IA as g,rS as h,UC as i,$C as j,GC as k,KO as l,pC as m,fM as n,fO as o,fb as p,BR as q,yS as r,Gb as s,aS as t,HR as u,jR as v,cL as w,fS as x,dR as y,vR as z};
